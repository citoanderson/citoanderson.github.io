(window.webpackJsonp=window.webpackJsonp||[]).push([["channelSectionPage~curatedHomepage~gamePage~post-tools~profilePage~renderCommentsIframe~renderCommen~bf9c3c43"],{"/RfE":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.DEFAULT_RETURNED=void 0;t.DEFAULT_RETURNED=20;class o{constructor(e={}){this.page=e.page,this.startIndex=e.startIndex,this.startTime=e.startTime,this.refId=e.refId,this.maxReturned=e.maxReturned}static fromQueryString(e={},t=20,s=0){const n=new o;return n.page=Number(e.page)||void 0,n.startIndex=Number(e.startIndex)||void 0,n.startTime=Number(e.startTime)||void 0,n.refId=Number(e.refId)||void 0,n.maxReturned=Number(e.maxReturned)||t+s,n}static fromJSON(e){return new o(e)}toJSON(){return{page:this.page?this.page:void 0,startIndex:this.startIndex?this.startIndex:void 0,startTime:this.startTime?this.startTime:void 0,refId:this.refId?this.refId:void 0,maxReturned:this.maxReturned?this.maxReturned:void 0}}pageNumber(){if(this.startTime)return;const e=this.startIndex||0,t=this.maxReturned||20;return e%t==0?e/t+1:void 0}}t.default=o},"2EOA":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.newspicksRequestMagicToken=t.newspicksLogout=t.newspicksLoginUsernamePassword=t.newspicksLoginMagicToken=t.newspicksLoginAuth0Token=t.newspicksGetToken=t.newspicksDisconnect=t.newspicksAccountWithToken=void 0;var o=u(s("f8ne")),n=u(s("Oyao")),i=u(s("NBZd")),r=u(s("DI1U")),a=u(s("tsyB"));function u(e){return e&&e.__esModule?e:{default:e}}const l=o.default.api.profileUrl,c=o.default.api.profileSessionUrl,d={credentials:"include"};t.newspicksGetToken=e=>(0,a.default)(`${l}token/create`,{},{...e,...d});t.newspicksLogout=()=>Promise.all([(0,a.default)(`${l}session/logout`,{},d),(0,a.default)(`${c}session/logout`,{},d),Promise.resolve(n.default.remove("KinjaToken"))]);t.newspicksLoginUsernamePassword=e=>(0,a.default)(`${l}session/login`,e,d);t.newspicksLoginMagicToken=e=>(0,a.default)(`${l}session/loginMagicToken`,e,d);t.newspicksRequestMagicToken=e=>(0,a.default)(`${l}session/requestMagicToken`,{email:e},{});t.newspicksLoginAuth0Token=e=>(0,a.default)(`${l}session/loginAuth0`,{auth0Token:e},d);t.newspicksAccountWithToken=()=>(0,r.default)(`${l}accountwithtoken`);t.newspicksDisconnect=()=>i.default.get(i.default.newspicksFresh).then((e=>(0,a.default)(`${l}session/disconnect`,{},{token:e})))},"3FRo":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logout=t.getToken=t.burnerLogin=t.burnerCheck=t.accountWithToken=void 0;var o=u(s("f8ne")),n=u(s("PY4C")),i=u(s("NWgQ")),r=u(s("DI1U")),a=u(s("tsyB"));function u(e){return e&&e.__esModule?e:{default:e}}const l=o.default.isBrowser?o.default.api.profileSessionUrl:o.default.api.profileUrl,c={credentials:"include"};t.getToken=e=>(0,a.default)(`${l}token/create`,{},{...e,...c});t.logout=()=>(0,a.default)(`${l}session/logout`,{},c);t.burnerLogin=e=>(0,a.default)(`${l}session/burnerLogin`,e,c);t.burnerCheck=e=>(0,r.default)(`${l}session/views/burnerCheck?${i.default.stringify({screenName:e})}`);t.accountWithToken=()=>(0,n.default)(`${l}accountwithtoken`,{jsonpCallback:"jsonp"}).then((e=>e.json())).then((e=>e?e.data:null))},"9sXr":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.LOGGEDIN_COOKIE=void 0;var o,n=(o=s("Oyao"))&&o.__esModule?o:{default:o};const i="kinjaLoggedIn";t.LOGGEDIN_COOKIE=i;var r=new class{set(e){e?n.default.set(i,!0):n.default.remove(i)}isLoggedIn(){return"true"===n.default.get(i)}};t.default=r},OxGi:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=g(s("Oyao")),n=g(s("2pqj")),i=s("lI4E"),r=g(s("OiCc")),a=s("3FRo"),u=s("PNhx"),l=s("2EOA"),c=s("O1lG"),d=s("tJmD"),h=g(s("9sXr"));function g(e){return e&&e.__esModule?e:{default:e}}function p(e,t,s){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var o=s.call(e,t||"default");if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const f=new class{constructor(){p(this,"timeout",null),p(this,"state",{state:"init",user:null,blogs:null,notificationCount:0,loginFlow:{userNameTaken:!1,loading:!1,error:null,incompleteRegistration:!1,modalOpen:!1}}),p(this,"_subscribers",[]),p(this,"pollCookie",(()=>{const e=o.default.get("KinjaOAuth");if(e)try{const t=JSON.parse(e);switch(o.default.remove("KinjaOAuth",{path:"/"}),t.event){case"loggedin":case"connected":return this.login();case"error":return this.update({loginFlow:{...this.state.loginFlow,error:"Something went wrong, please try again!"}});default:return void(this.timeout=setTimeout(this.pollCookie,100))}}catch(e){return console.error(e),this.update({loginFlow:{...this.state.loginFlow,error:"Something went wrong, please try again!"}})}else this.timeout=setTimeout(this.pollCookie,100)}))}subscribe(e,t=!1){return this._subscribers.push(e),t&&e(this.state,null),()=>{this._subscribers=this._subscribers.filter((t=>t!==e))}}update(e){const t={...this.state},s=location.host.indexOf("localhost")>-1,n=location.protocol.indexOf("s")>-1;this.state={...this.state,...e},e.user&&e.user.token&&o.default.set("KinjaToken",e.user.token,{path:"/",expires:new Date((new Date).getTime()+33e5),secure:!s||n}),this._subscribers.forEach((e=>e(this.state,t)))}updateLoginFlow(e){this.update({loginFlow:{...this.state.loginFlow,...e}})}login(){(0,a.accountWithToken)().then((e=>this._loginStateUpdate(e))).catch((e=>console.error(e)))}newspicksLogin(){(0,l.newspicksAccountWithToken)().then((e=>this._loginStateUpdate(e))).catch((e=>console.error(e)))}_loginStateUpdate(e){if(!e)throw new Error("Malformed data received in accountwithtoken call");w(e)}logout(){(0,a.logout)().then((()=>this._logoutStateUpdate()))}newspicksLogout(){(0,l.newspicksLogout)().then((()=>this._logoutStateUpdate()))}_logoutStateUpdate(){this.update({state:"unauthd",blogs:null,user:null,loginFlow:{...this.state.loginFlow,modalOpen:!1}}),h.default.set(!1)}loginOAuth(){this.pollCookie()}loginBurner(e){return this._tryLoginWithFlow((()=>(0,a.burnerLogin)(e)),{unauthorizedMessage:"Username and/or password didn't match."})}newspicksLoginUsernamePassword(e){return this._tryLoginWithFlow((()=>(0,l.newspicksLoginUsernamePassword)(e)),{unauthorizedMessage:"Username and/or password didn't match.",useNewspicksAuth:!0})}newspicksLoginMagicToken(e){return this._tryLoginWithFlow((()=>(0,l.newspicksLoginMagicToken)(e)),{unauthorizedMessage:"log in token was not valid",useNewspicksAuth:!0})}newspicksLoginAuth0(e){return this._tryLoginWithFlow((()=>(0,l.newspicksLoginAuth0Token)(e.token)),{unauthorizedMessage:"Unable to login with your social account",useNewspicksAuth:!0})}createNewspicksUser(e){return this._tryLoginWithFlow((()=>(0,u.createNewspicksUser)(e)),{useNewspicksAuth:!0})}_tryLoginWithFlow(e,{useNewspicksAuth:t=!1,unauthorizedMessage:s}){return this.updateLoginFlow({loading:!0}),e().then((()=>{t?this.newspicksLogin():this.login(),this.updateLoginFlow({loading:!1})})).catch((e=>{const t="UNAUTHORIZED"===e.code&&s?s:e.message;throw this.updateLoginFlow({loading:!1,error:t}),e}))}startLoginFlow(){this.updateLoginFlow({modalOpen:!0})}setScreenName(e){this.updateLoginFlow({loading:!0}),(0,c.setScreenName)(e).then((()=>this.login())).catch((e=>{"SCREENNAME_ALREADY_EXISTS"===e.code?this.updateLoginFlow({userNameTaken:!0,loading:!1}):this.updateLoginFlow({error:e.message,loading:!1})}))}endLoginFlow(){this.updateLoginFlow({modalOpen:!1}),this.state.user||this.login()}resetError(){this.updateLoginFlow({userNameTaken:!1,error:null})}onAuth(e){"authd"===this.state.state&&this.state.user&&e(this.state.user);const t=this.subscribe(((s,o)=>{o&&!o.user&&s.user&&e(s.user,t)}))}onPageLoadUserState(e){"authd"!==this.state.state&&"unauthd"!==this.state.state||e(this.state);const t=this.subscribe(((s,o)=>{o&&o.state!==s.state&&(e(s),t())}))}isNewspicksAuthd(){return"authd"===this.state.state&&this.state.user&&this.state.user.isNewspicksUser}isInternalKinjaUser(){return"authd"===this.state.state&&this.state.user&&this.state.user.isInternalKinjaUser}};function w(e){const{accountState:t}=e;if(t&&t.id){const t=r.default.fromAccountStateJSON(e),s=e.accountState.membership.reduce(((e,t)=>{const{blogId:s,blog:o}=t;if(o){const t=(0,i.createBlogId)(s);e.hasOwnProperty(t)||(e[t]=n.default.fromJSON(o))}return e}),{});t.isIncompleteRegistration?f.updateLoginFlow({incompleteRegistration:!0}):(f.update({state:"authd",user:t,blogs:s,loginFlow:{...f.state.loginFlow,modalOpen:!1}}),h.default.set(!0))}else f.update({state:"unauthd"}),h.default.set(!1)}"undefined"!=typeof window&&(0,d.getFasttokenResponseRaw)().then(w).catch((e=>(console.error(e),{user:null,blogs:null})));var m=f;t.default=m,e.exports=t.default},tnQC:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,n=(o=s("/RfE"))&&o.__esModule?o:{default:o};class i{constructor(e){this.curr=e.curr,this.next=e.next,this.prev=e.prev,this.total=e.total}static fromJSON(e){return new i({total:Number(e.total||0),curr:e.curr?n.default.fromJSON(e.curr):null,next:e.next?n.default.fromJSON(e.next):null,prev:e.prev?n.default.fromJSON(e.prev):null})}toJSON(){return{total:this.total,curr:this.curr?this.curr.toJSON():null,next:this.next?this.next.toJSON():null,prev:this.prev?this.prev.toJSON():null}}hasMore(){return null!==this.next}}t.default=i,e.exports=t.default}}]);