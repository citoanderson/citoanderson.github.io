var t,mcan=document.createElement("canvas"),mctx=(mcan.width=100,mcan.height=100,mcan.getContext("2d"));mctx.save();let params=window.adParams||{};var T={VER:"9.18",trkHost:"//"+params.trkHost,DynImgCdnHost:"//"+params.dynImgHost,cdnHost:"//"+params.cdnHost,pxlDims:params.dims,crossOrigin:"true"===(null==(t=params.custom)?void 0:t.exported)?null:"anonymous",view_n:!1,inView:!1,clkCount:0,engageCount:0,initParams:function(){var t;window.adParams&&(T.trkHost="//"+adParams.trkHost,T.DynImgCdnHost="//"+adParams.dynImgHost,T.cdnHost="//"+adParams.cdnHost,T.pxlDims=adParams.dims,T.crossOrigin="true"===(null==(t=adParams.custom)?void 0:t.exported)?null:"anonymous")},initViewability:function(t){T.clinchViewability={};try{T.clinchViewability=new ClinchViewability}catch(t){}try{T.clinchViewability.init(t,1e3)}catch(t){}if(T.clinchViewability._undetermined)T.view_n=!0;else try{T.clinchViewability.listen("viewable.impression",function(t){void 0!==T&&T.reportViewability&&T.reportViewability()})}catch(t){}},reportImp:function(){if(!T.isDisableTrackingPixels()){(new Image).src=T.trkHost+"/imp?"+T.pxlDims+(T.view_n?"&view_n=true":"")+"&a="+Date.now();for(var t=0;t<adParams.impPixels.length;t++){var e=adParams.impPixels[t].replace("http:","").replace("https:","");(new Image).src=T.expandCacheBusterMacroInUrl(e)}}},reportViewability:function(){T.pxlDims&&((new Image).src=T.trkHost+"/view_y?"+T.pxlDims+"&a="+Date.now())},reportClick:function(t,e,i,s,a,r){if(e=e||"",i=i||"",a=a||T.getClkPos(r),T.isVpaid())({x:r,y:n}=T.getClkPos()),vpaidAd.callEvent_("AdClickThru",t,33,!0,e,r,n),T.clkCount++;else if(!(T.isDisableTrackingPixels()||9<T.clkCount)){var r=T.getClickedItem(e),n=T.getClickedItemParameter(r),o=((new Image).src=T.trkHost+"/clk?"+T.pxlDims+"&ctaid="+e+(i?"&utags="+encodeURIComponent(i):"")+"&x="+a.x+"&y="+a.y+"&cnt="+T.clkCount+"&lp="+encodeURIComponent(t)+n+"&a="+Date.now(),[]);if(Array.isArray(adParams.clkPixels))for(var h=0;h<adParams.clkPixels.length;h++)o.push(adParams.clkPixels[h]);if(Array.isArray(s))for(h=0;h<s.length;h++)o.push(s[h]);for(h=0;h<o.length;h++)(new Image).src=T.expandMacrosInClickTrackerUrl(T.expandCacheBusterMacroInUrl(o[h]).replace(/{{click_type}}/g,e).replace(/{{click_tags}}/g,i),e);T.clkCount++}},reportEngage:function(t,e,i,s){if(T.isVpaid())vpaidAd.callEvent_("AdInteraction",t);else if(!T.isDisableTrackingPixels()){(new Image).src=T.trkHost+"/engage?"+T.pxlDims+"&type="+t+(e?"&utags="+encodeURIComponent(e):"")+"&x="+s.x+"&y="+s.y+"&cnt="+T.engageCount+"&a="+Date.now();var a=[];if(Array.isArray(i))for(var r=0;r<i.length;r++)a.push(i[r]);for(r=0;r<a.length;r++)(new Image).src=T.expandCacheBusterMacroInUrl(a[r]).replace(/{{engage_type}}/g,t).replace(/{{engage_tags}}/g,e);T.engageCount++}},reportBlock:function(){T.isDisableTrackingPixels()||T.isBlockEventSent||(T.isBlockEventSent=!0,(new Image).src=T.trkHost+"/blk?"+T.pxlDims+"&a="+Date.now())},errorsSent:{},reportExceptionError:function(t,e){T.reportError("exception_in_"+t,e)},reportError:function(t,e){if(!T.isDisableTrackingPixels())if(void 0!==T.errorsSent[t])T.errorsSent[t]++;else{T.errorsSent[t]=1;if(e)for(var i in e)"function"!=typeof e[i]&&e[i]}},sendEvent:function(t){adParams.isProd},click:function(t,e,i){try{T.cancelBubbling(i),"undefined"!=typeof cp_&&cp_.fire("click",{url:t,type:e,event:i}),!0!==i.stopClickProcess&&(t=(t="default"===t?"":t)||adParams.clickUrl||adParams.fbClickUrl)&&(t=T.genClkChain(t,e),T.reportClick(t,e,null,null,null,i),T.isVpaid()||(T.isMraid()?T.sendMsgToHost("open,"+t):window.open(t,t.startsWith("tel")?"_top":"_blank")))}catch(i){T.reportExceptionError("click",i)}},expandCacheBusterMacroInUrl:function(t){return t=0<=t.indexOf("{{cache_buster}}")?t.replace(/{{cache_buster}}/g,Date.now()):t},expandMacrosInClickTrackerUrl:function(e,t){try{var i=T.getClickedItem(t);return e=(e=(e=(e=(e=e.replace(/{{clicked_product_id}}/g,i.id)).replace(/{{clicked_product_category}}/g,i.catName||"")).replace(/{{clicked_product_custom1}}/g,i.custom.custom1||"")).replace(/{{clicked_product_custom2}}/g,i.custom.custom2||"")).replace(/{{clicked_product_custom3}}/g,i.custom.custom3||"")}catch(t){return e}},getClickedItem:function(t){return-1<(t=t.toLowerCase()).indexOf("item_")?(t=parseInt(t.replace("item_",""))-1,items[t]):{id:"",catName:"",custom:{}}},getClickedItemParameter:function(t){var params="";return t.id&&(params="&clkItemId="+encodeURIComponent(t.id),t.catName&&(params+="&clkItemCat="+encodeURIComponent(t.catName)),t.custom.custom1&&(params+="&clkItemCustom1="+encodeURIComponent(t.custom.custom1)),t.custom.custom2&&(params+="&clkItemCustom2="+encodeURIComponent(t.custom.custom2)),t.custom.custom3)&&(params+="&clkItemCustom3="+encodeURIComponent(t.custom.custom3)),params},getClkPos:function(t){var{left:e,top:i,width:s,height:a}=comp.renderer.domElement.getBoundingClientRect();try{var r=0,n=0;return((t=t||window.event).clientX||t.clientY)&&(r=Math.round((t.clientX-e)/s*100),n=Math.round((t.clientY-i)/a*100)),{x:r,y:n}}catch(t){return{x:0,y:0}}},genClkChain:function(t,e){var i,s=t;adParams.utmParams&&!t.startsWith("tel")&&(t=adParams.utmParams,t=-1==s.indexOf("?")?"?"+t:"&"+t,s.includes("#")&&!s.includes("/#/")?(i=s.indexOf("#"),s=s.slice(0,i)+t+s.slice(i)):s+=t),s=T.expandMacrosInClickTrackerUrl(s,e);for(var a=adParams.clkTrackers.length-1;0<=a;a--){var r=adParams.clkTrackers[a];if(0<=r.toUpperCase().indexOf("AD.DOUBLECLICK.NET/DDM/TRACKCLK"))s=r+(r.endsWith("?")?"":"?")+s;else{var n=parseInt(adParams.custom.clkenclvl);0==a&&!isNaN(n)||(n=1);for(var o=0;o<n;o++)s=encodeURIComponent(s);s=r+s}}return s},sendMsgToHost:function(t){window.parent&&window.parent.postMessage(t,"*")},getParamByName:function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");t=new RegExp("[\\?&]"+t+"=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},isBrowserSupported:function(){return!!(document.createElement("canvas").getContext&&Array.prototype.indexOf&&CSSStyleDeclaration.prototype.getPropertyValue&&Element.prototype.addEventListener)},isIos:function(){return/iPhone|iPod|iPad/i.test(navigator.userAgent)},isIE:function(){return/Trident/i.test(navigator.userAgent)},isIpad:function(){return/iPad/i.test(navigator.userAgent)},isAndroid:function(){return/Android/i.test(navigator.userAgent)},isTablet:function(){return this.isIpad()||this.isAndroid()&&!/Mobile/i.test(navigator.userAgent)},isDesktop:function(){return!this.isMobile()&&!this.isTablet()},isMobile:function(){return/Android|webOS|iPhone|iPod|Blackberry|Windows Phone/i.test(navigator.userAgent)},isMraid:function(){return"true"==T.getParamByName("mraid")||"inapp"==T.getParamByName("env")},isVpaid:function(){return"true"===adParams.custom.isVpaid},isDisableTrackingPixels:function(){return!T.pxlDims||T.isVpaid()},isShowClickAreas:function(){return"true"===T.getParamByName("showclickareas")},isEmpty:function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0},hashCode:function(t){var e,i=0;if(0!==t.length)for(e=0;e<t.length;e++)i=(i<<5)-i+t.charCodeAt(e),i|=0;return i},hash64:function(t){for(var e="",i="",s=0;s<t.length;s++)s%2==0?e+=t[s]:i+=t[s];var a=this.hashCode(e),r=this.hashCode(i);return a.toString()+r.toString()},getDynImgUrl:function(t,e,i,s,a){return void 0!==window.devicePixelRatio&&1.3<window.devicePixelRatio&&(e*=2,i*=2),"true"===adParams.custom.exported?t:T.DynImgCdnHost+"/img2/"+adParams.clientEncId+"/"+e+"/"+i+"/"+s+"/"+a+"/?u="+encodeURIComponent(t)},isExtImg:function(t){return-1==t.indexOf(this.cdnHost)},hexToRgb:function(t,e){t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return t?"rgba("+parseInt(t[1],16)+","+parseInt(t[2],16)+","+parseInt(t[3],16)+","+e+")":"rgba(0,0,0,0)"},cancelBubbling:function(t){(t=t||window.event).stopPropagation?t.stopPropagation():t.cancelBubble=!0},htmlEncode:function(t){return t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\s/g,"&nbsp;")},insertAndExecute:function(t,e){var i;t.innerHTML=e;for(i of Array.prototype.slice.call(t.getElementsByTagName("script"))){var s=document.createElement("script");s.async=!1,i.type&&(s.type=i.type),""!=i.src?s.src=i.src:s.innerHTML=i.innerHTML,document.getElementsByTagName("head")[0].appendChild(s)}},receiveMsg:function(t){var e,i,s,a=t.data;if("blockAd"===a)T.hideAd(),T.reportBlock(),T.sendMsgToReciever(t.source,"adBlocked");else if("showAd"===a)T.showAd(),T.sendMsgToReciever(t.source,"adShown");else if("initSubLoad"===a&&"undefined"!=typeof cp_&&cp_.initSubLoad(),!adParams.isProd||-1!=t.origin.indexOf("//cdn.clinch.co"))if("getDynamicData"===a.type){if(biz){for(var r in biz.custom)biz[r]=biz.custom[r];delete biz.custom}var n={items:items||[],biz:biz||null,style:style,cidEnc:adParams.clientEncId,dynImgCdnHost:adParams.dynImgHost,adFormat:adParams.adFormatStr};T.sendMsgToReciever(t.source,"dynamicData",n)}else"click"===a.type?(t=a.params.type||"",n=a.params.tags||"",i=a.params.clickPixels||a.params.pixels||[],s=null,adParams.InAdclk&&(e=adParams.InAdclk.trkPerLabel[t||"main"])&&e.lp&&(s=e.lp),e=a.params.url||s||adParams.clickUrl||adParams.fbClickUrl,s={x:a.params.x||0,y:a.params.y||0},e=T.genClkChain(e,t),T.reportClick(e,t,n,i,s),T.isVpaid()||(T.isMraid()?T.sendMsgToHost("open,"+e):window.open(e,e.startsWith("tel")?"_top":"_blank"))):"engage"===a.type&&(t=a.params.type||"",n=a.params.tags||"",i=a.params.clickPixels||a.params.pixels||[],s={x:a.params.x||0,y:a.params.y||0},T.reportEngage(t,n,i,s))},sendMsgToReciever:function(t,e,params){t.postMessage({type:e,params:params},"*")},log:function(t){adParams.isDebug||adParams.custom.isPreview},hideAd:function(){document.body.style.visibility="hidden"},showAd:function(){document.body.style.visibility="visible"},measureCan:mcan,measureCtx:mctx,measureText:function(t,e,i,s,a,r,n){var o=T.measureCtx,a=(o.font=T.getCtxFont(a,s,i,e),o.measureText(t).width);return 0!=r&&(s=t.length-1,!0===n&&(s+=1),a+=i*r/1e3*s),a},getCtxFont:function(t,e,i,s){var style="";return 1!==t&&!0!==t&&"italic"!==t||(style+="italic "),(style+=e+" ")+i+"px '"+s+"'"},loadFonts(t){var e=cp_.containerDiv.ownerDocument;if(e.fonts&&e.fonts.load){var i,s=e.createElement("style"),a=adParams.language,r=Array.from(e.fonts).map(t=>t.family);e.head.appendChild(s);for(i of t){var n,o=T.getCtxFont(i.italic,i.weight,10,i.family);i.url&&!r.includes(i.family)&&(n=`@font-face {font-family: "${i.family}";src: url('${i.url.replace(/\.[^.]+$/,`_${a}.woff2`)}') format('woff2'), url('${i.url.replace(/\.[^.]+$/,`_${a}.woff`)}') format('woff');font-weight: ${i.weight};font-style: ${i.italic?"italic":"normal"};}`,s.sheet.insertRule(n),e.fonts.load(o))}}},deepEqual:function(e,i,s){if("object"==typeof e&&null!==e||e instanceof Float32Array)try{return Object.keys(e).every(t=>this.deepEqual(e[t],i[t],s))}catch(t){return!1}return(e=void 0===e?null:e)===(i=void 0===i?null:i)}};window.FB=T;class PlayerBase{constructor(){this._listeners={},this.avgFps=0,this.fps=0,this.frameCount=0,this.movPerc=0,this.lastMovPerc=0,this.timer=0,this.timelineUpdate=null,this.prevTime=0,this.isReadyForPlay=!1,this.isStarted=!1,this.IsPaused=!1,this.isMuted=!1,this.volume=1,this.currentFrameDrawCount=0,this.percentLoaded=0,this.IsStopRequested=!1,this.isMovieEnded=!1,this.isFirstRun=!0,this.playbackrate=1,this.reqAnim=null,this.comp=null,this.percentageReportInterval=null,this.assetLoadingStartTime=null,this.indexLoaded=0,this.getMovRespose={};let t="hidden",e="visibilitychange";var i=["moz","ms","webkit"].find(t=>void 0!==document[t+"Hidden"]),i=(i&&(t=i+"Hidden",e=""+i+e),new URLSearchParams(document.location.search));adParams.drawDebugBoxes="true"===i.get("drawDebugBoxes"),document.addEventListener(e,()=>this.handleVisibilityChange(t),!1)}addListener(t,e){void 0===this._listeners[t]&&(this._listeners[t]=[]),this._listeners[t].push(e)}fire(i,t){if((i={type:i,obj:t}).target||(i.target=this),!i.type)throw new Error("Event object missing 'type' property.");if(this._listeners[i.type]instanceof Array){var s=this._listeners[i.type];for(let t=0,e=s.length;t<e;t++)s[t].call(this,i)}}removeListener(t,i){if(this._listeners[t]instanceof Array){var s=this._listeners[t];for(let t=0,e=s.length;t<e;t++)if(s[t]===i){s.splice(t,1);break}}}timeInSeconds(){return this.timer/1e3}getStatus(){let t;return{status:t=this.isReadyForPlay?this.isStarted?this.IsPaused||this.isMovieEnded?this.IsPaused&&!this.isMovieEnded?"paused":"ended":"play":"ready":"init",currentTime:this.timeInSeconds(),volume:volume,mute:this.isMuted}}Mute(t){void 0!==this.comp&&(this.isMuted=t,this.comp.mute(this.isMuted))}isMute(){return this.isMuted}Volume(t){(t=1<t?1:t)<0&&(t=0),void 0!==this.comp&&(!0===this.isMuted&&0<t&&this.Mute(!1),this.comp.vol(t),0===(this.volume=t)&&this.Mute(!0),this.fire("volumeChange",{volume:t}))}report_percentage(){var t=this.comp.getFootageStatus(!1),e=(this.firstFrameLoaded||0!==this.comp.getFootageStatus(!0).pending.length||(this.fire("initial_load_completed"),this.firstFrameLoaded=!0),this.isLoadingTimeout(2e4));0!==t.pending.length&&!e||(clearInterval(this.percentageReportInterval),0<t.failed.length?T.reportError("footage_failed"):0<t.pending.length&&T.reportError("footage_timeout"),t.failed.length+t.pending.length!==0)||this.MovReady()}isLoadingTimeout(t){return(new Date).getTime()-this.assetLoadingStartTime.getTime()>t}MovReady(){try{T.log("MovReady() called"),this.isReadyForPlay=!0,adParams.autoPlay?(this.start(),this.fire("ready_for_play"),this.fire("play")):(this.fire("ready_for_play"),this.IsPaused=!0)}catch(t){T.reportExceptionError("MovReady_func",t)}}start(){try{this.drawCurrentFrameInLoopTimeout&&window.clearTimeout(this.drawCurrentFrameInLoopTimeout),this.comp.drawFrame(this.timer,!0),this.timelineUpdate=setInterval(()=>{try{this.movPerc=this.timer/(1e3*this.comp.dur)*100,100<this.movPerc&&(this.movPerc=100),this.lastMovPerc=this.movPerc,this.IsPaused||this.fire("progress",{time:this.timeInSeconds()})}catch(t){}},50),this.prevTime=Date.now(),this.comp.durationStr_=this.milisecTotime(1e3*this.comp.dur),this.isStarted=!0,this.IsPaused=!1,this.Mute(this.isMuted),this.comp.play(this.timer),this.fire("start"),this.animate()}catch(t){T.reportExceptionError("start_func",t)}}movieEnded(){this.isMovieEnded=!0,this.Pause(),this.fire("end"),this.isFirstRun=!1}windowResized(){let t=0,e=0,i=1,s="";this.comp.renderer.setSize(this.comp.w,this.comp.h);var a,r,n=this.comp.renderer.domElement.style,o=this.containerDiv.offsetWidth,h=this.containerDiv.offsetHeight,l=(-1!==[9055,8855,8999,9059,9060].indexOf(adParams.campaignId)&&"true"!==adParams.custom.isPreview||o===comp.w&&h===comp.h||(r=comp.w/comp.h,a=o/h,s="top left",l=Math.abs(1-o/comp.w/(h/comp.h))<.01,r<=a&&!l||a<r&&l?(i=h/comp.h,a=comp.w*i,t=0,e=Math.round((o-a)/2)):(i=o/comp.w,r=comp.h*i,e=0,t=Math.round((h-r)/2))),"scale("+i+")");n.WebkitTransform=l,n.MozTransform=l,n.oTransform=l,n.transform=l,n.msTransform=l,n.WebkitTransformOrigin=s,n.MozTransformOrigin=s,n.oTransformOrigin=s,n.transformOrigin=s,n.msTransformOrigin=s,n.top=t+"px",n.left=e+"px",!0===this.IsPaused&&this.comp.drawFrame(this.timer,this.IsPaused),this.scale=i,this.fire("resize",i)}animate(){var t,e=Date.now();!0===this.IsStopRequested?(this.IsStopRequested=!1,this.isStarted=!1):(!1===this.IsPaused&&null!=this.comp&&(this.timer+=(e-this.prevTime)*this.playbackrate,this.timer>1e3*this.comp.dur&&(this.timer=1e3*this.comp.dur),this.timer!==1e3*this.comp.dur||this.isMovieEnded||this.movieEnded(),null!=(t=this.comp)&&t.drawFrame(this.timer,this.IsPaused),this.fps=1e3/(e-this.prevTime),this.avgFps=(this.avgFps*this.frameCount+this.fps)/(this.frameCount+1),this.frameCount++),this.prevTime=e,this.reqAnim=requestAnimationFrame(this.animate.bind(this)))}Play(){this.isStarted?this.isMovieEnded?this.replay():(this.IsPaused=!1,this.comp.play(this.timer),this.fire("play")):adParams.autoPlay||this.isStarted||(this.IsPaused=!1,this.start(),this.fire("play"))}Pause(){this.IsPaused=!0,this.isMovieEnded||this.fire("pause",{time:this.timeInSeconds()}),this.isStarted&&this.comp.pause(this.timer,this.isMovieEnded)}GetMovieDuration(){if(null!=this.comp)return this.comp.dur}stop(){null!=this.comp&&this.comp.stop(),this.IsStopRequested=!0}goTo(t){t=Math.min(1e3*this.comp.dur,Math.max(0,t)),this.timer=t,this.comp.goTo(t,this.IsPaused),this.fire("goto",{time:this.timeInSeconds()})}replay(){this.comp.stop(),this.prevTime=Date.now(),this.timer=0,this.isMovieEnded=!1,this.Play(),this.fire("play")}TogglePlaybackRate(){1===this.playbackrate?(this.playbackrate=.1,this.comp.setRate(.1)):(this.playbackrate=1,this.comp.setRate(1))}handleVisibilityChange(t){null!=this.comp&&(document[t]?(T.log("Clinch:hide"),this.fire("hide"),null!=this.reqAnim&&cancelAnimationFrame(this.reqAnim)):(T.log("Clinch:visible"),this.fire("visible"),this.prevTime=Date.now()-30,null!=this.reqAnim?(cancelAnimationFrame(this.reqAnim),this.timer>=1e3*this.comp.dur?(this.timer=1e3*this.comp.dur,T.log("Clinch:drawFrame at:"+this.timer),this.comp.goTo(this.timer,this.IsPaused),this.comp.drawFrame(this.timer,this.IsPaused),this.animate()):!0===this.IsPaused?(T.log("Clinch:drawFrame at:"+this.timer),this.comp.goTo(this.timer,this.IsPaused),this.comp.drawFrame(this.timer,this.IsPaused),this.animate(),this.Pause()):(this.animate(),T.log("Clinch:resume Play at:"+this.timer),this.Play(!1))):this.comp.drawFrame(this.timer,this.IsPaused)))}currentTime(){return this.timer}milisecTotime(t){var t=Math.floor(t/1e3),e=Math.floor(t/60);let i=t-60*e;return e+":"+(i=i<10?"0"+i:i)}drawCurrentFrameInLoop(){this.comp.drawFrame(this.timer,!0),this.currentFrameDrawCount++,this.drawCurrentFrameInLoopTimeout=window.setTimeout(this.drawCurrentFrameInLoop.bind(this),100)}init(t,e,i,s){this.firstFrameLoaded=!1,this.footageTiming=e.loadFootageTiming;try{s?(e.custom.isVpaid="true",this.isVpaid=!0,this.options=s,this.isMuted=e.isMute||!1===s.videoCanAutoplay):this.isMuted=!0,"true"===e.custom.startAdHidden&&T.hideAd(),i.setAttribute("compId",this.comp.id),this.containerDiv=i,this.B.COMP.call(this.comp),void 0===e.custom.subLoadDelay?e.subLoadDelay=0:e.subLoadDelay=parseFloat(e.custom.subLoadDelay),this.containerDiv.appendChild(this.comp.renderer.domElement);var a=e.format.w,r=e.format.h,n=(null===style||void 0===style?void 0:style.Background_framecolor)||(null===style||void 0===style?void 0:style.frame_color)||"#B3B3B3",o=this.comp.renderer.domElement,h=(o.style.position="absolute",o.style.top="0px",o.style.left="0px",o.style.cursor="pointer",o.style.overflow="hidden",o.style.width=a+"px",o.style.height=r+"px",'<div style="position:absolute;z-index:100000;background:'+n+';top:0;left:0;width:100%;height:1px"></div><div style="position:absolute;z-index:100000;background:'+n+';bottom:0;left:0;width:100%;height:1px"></div><div style="position:absolute;z-index:100000;background:'+n+';top:0;left:0;width:1px;height:100%"></div><div style="position:absolute;z-index:100000;background:'+n+';top:0;right:0;width:1px;height:100%"></div>'),l=o,c=h,d=document.createElement("div");c=c.trim(),d.innerHTML=c;for(let t=d.childNodes.length-1;0<=t;t--)l.appendChild(d.childNodes[t]);window.addEventListener("resize",this.windowResized.bind(this)),e.isProd||i.addEventListener("contextmenu",this.TogglePlaybackRate),this.windowResized.bind(this)(),this.containerDiv.addEventListener("click",function(t){return T.click(null,"default",t),!1}),this.timer=1e3*e.startTime,this.drawCurrentFrameInLoop(),this.assetLoadingStartTime=new Date,this.percentageReportInterval=setInterval(this.report_percentage.bind(this),100),this.fire("init")}catch(t){T.reportExceptionError("Init",{adParams:JSON.stringify(e),stage:"",exception:JSON.stringify(t)})}}dispose(){if(this.containerDiv.innerHTML="",this.comp){comp.footage=null;for(let t=0;t<this.comp.l.length;t++)this.comp.l[t].dispose&&this.comp.l[t].dispose()}this.comp=null}}class Vector{constructor(t,e){this.dimensions=t;for(let t=0;t<e.length;t++)this[this.dimensions[t]]=e[t]||0}set(...params){for(let t=0;t<params.length;t++)this[this.dimensions[t]]=params[t];return this}setX(t){return this.x=t,this}copy(e){return this.dimensions.forEach(t=>{this[t]=e[t]}),this}add(e,t){return void 0!==t?this.addVectors(e,t):(this.dimensions.forEach(t=>{this[t]+=e[t]}),this)}addVectors(e,i){return this.dimensions.forEach(t=>{this[t]=e[t]+i[t]}),this}sub(e,t){return void 0!==t?this.subVectors(e,t):(this.dimensions.forEach(t=>{this[t]-=e[t]}),this)}subVectors(e,i){return this.dimensions.forEach(t=>{this[t]=e[t]-i[t]}),this}multiply(e,t){return void 0!==t?this.multiplyVectors(e,t):(this.dimensions.forEach(t=>this[t]*=e[t]),this)}multiplyVectors(e,i){return this.dimensions.forEach(t=>this[t]=e[t]*i[t]),this}multiplyScalar(e){return this.dimensions.forEach(t=>{this[t]*=e}),this}divide(e){return this.dimensions.forEach(t=>this[t]/=e[t]),this}divideScalar(e){return 0!==e?this.dimensions.forEach(t=>{this[t]/=e}):this.dimensions.forEach(t=>{this[t]=0}),this}min(e){return this.dimensions.forEach(t=>{this[t]=Math.min(this[t],e[t])}),this}max(e){return this.dimensions.forEach(t=>{this[t]=Math.max(this[t],e[t])}),this}negate(){return this.multiplyScalar(-1)}dot(i){return this.dimensions.reduce((t,e)=>t+this[e]*i[e],0)}lengthSq(){return this.dimensions.reduce((t,e)=>t+Math.pow(this[e],2),0)}length(){return Math.sqrt(this.lengthSq())}normalize(){return this.divideScalar(this.length())}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){return this.lengthSq(this.clone().sub(t))}lerp(e,i){return this.dimensions.forEach(t=>this[t]=(e[t]-this[t])*i),this}equals(e){return this.dimensions.every(t=>this[t]===e[t])}clone(){return new Vector(this.dimensions,this.dimensions.map(t=>this[t]))}}class Vector4d extends Vector{constructor(t,e,i,s){super(["x","y","z","w"],[t,e,i,s]),this.w=void 0!==s?s:1}applyMatrix4(t){var e=this.x,i=this.y,s=this.z,a=this.w,t=t.elements;return this.x=t[0]*e+t[4]*i+t[8]*s+t[12]*a,this.y=t[1]*e+t[5]*i+t[9]*s+t[13]*a,this.z=t[2]*e+t[6]*i+t[10]*s+t[14]*a,this.w=t[3]*e+t[7]*i+t[11]*s+t[15]*a,this}clone(){return new Vector4d(this.x,this.y,this.z,this.w)}}class Vector2d extends Vector{constructor(...t){super(["x","y"],t)}applyMatrix3(t){var{x:e,y:i}=this,t=t.elements;return this.x=e*t[0]+i*t[3]+t[6],this.y=e*t[1]+i*t[4]+t[7],this}clone(){return new Vector2d(this.x,this.y)}}class Vector3d extends Vector{constructor(...t){super(["x","y","z"],t)}applyMatrix4(t){var e=this.x,i=this.y,s=this.z,t=t.elements;return this.x=t[0]*e+t[4]*i+t[8]*s+t[12],this.y=t[1]*e+t[5]*i+t[9]*s+t[13],this.z=t[2]*e+t[6]*i+t[10]*s+t[14],this}applyQuaternion(t){var e=this.x,i=this.y,s=this.z,a=t.x,r=t.y,n=t.z,t=t.w,o=t*e+r*s-n*i,h=t*i+n*e-a*s,l=t*s+a*i-r*e,e=-a*e-r*i-n*s;return this.x=o*t+e*-a+h*-n-l*-r,this.y=h*t+e*-r+l*-a-o*-n,this.z=l*t+e*-n+o*-r-h*-a,this}cross(t,e){var i,s;return void 0!==e?this.crossVectors(t,e):(e=this.x,i=this.y,s=this.z,this.x=i*t.z-s*t.y,this.y=s*t.x-e*t.z,this.z=e*t.y-i*t.x,this)}crossVectors(t,e){var i=t.x,s=t.y,t=t.z,a=e.x,r=e.y,e=e.z;return this.x=s*e-t*r,this.y=t*a-i*e,this.z=i*r-s*a,this}setFromMatrixPosition(t){return this.x=t.elements[12],this.y=t.elements[13],this.z=t.elements[14],this}setFromMatrixScale(t){var e=this.set(t.elements[0],t.elements[1],t.elements[2]).length(),i=this.set(t.elements[4],t.elements[5],t.elements[6]).length(),t=this.set(t.elements[8],t.elements[9],t.elements[10]).length();return this.x=e,this.y=i,this.z=t,this}clone(){return new Vector3d(this.x,this.y,this.z)}projectOnVector(t){var e=new Vector3d,t=(e.copy(t).normalize(),this.dot(e));return this.copy(e).multiplyScalar(t)}reflect(t){var e=new Vector3d;return e.copy(this).projectOnVector(t).multiplyScalar(2),this.subVectors(e,this)}}class Euler{constructor(t,e,i,s){this._x=t||0,this._y=e||0,this._z=i||0,this._order=s||Euler.DefaultOrder,this._quaternion=void 0}_updateQuaternion(){void 0!==this._quaternion&&this._quaternion.setFromEuler(this,!1)}get x(){return this._x}set x(t){this._x=t,this._updateQuaternion()}get y(){return this._y}set y(t){this._y=t,this._updateQuaternion()}get z(){return this._z}set z(t){this._z=t,this._updateQuaternion()}get order(){return this._order}set order(t){this._order=t,this._updateQuaternion()}set(t,e,i,s){return this._x=t,this._y=e,this._z=i,this._order=s||this._order,this._updateQuaternion(),this}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._updateQuaternion(),this}setFromRotationMatrix(t,e){function i(t){return Math.min(Math.max(t,-1),1)}var t=t.elements,s=t[0],a=t[4],r=t[8],n=t[1],o=t[5],h=t[9],l=t[2],c=t[6],t=t[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(i(r)),Math.abs(r)<.99999?(this._x=Math.atan2(-h,t),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(c,o),this._z=0)):"YXZ"===e?(this._x=Math.asin(-i(h)),Math.abs(h)<.99999?(this._y=Math.atan2(r,t),this._z=Math.atan2(n,o)):(this._y=Math.atan2(-l,s),this._z=0)):"ZXY"===e?(this._x=Math.asin(i(c)),Math.abs(c)<.99999?(this._y=Math.atan2(-l,t),this._z=Math.atan2(-a,o)):(this._y=0,this._z=Math.atan2(n,s))):"ZYX"===e?(this._y=Math.asin(-i(l)),Math.abs(l)<.99999?(this._x=Math.atan2(c,t),this._z=Math.atan2(n,s)):(this._x=0,this._z=Math.atan2(-a,o))):"YZX"===e?(this._z=Math.asin(i(n)),Math.abs(n)<.99999?(this._x=Math.atan2(-h,o),this._y=Math.atan2(-l,s)):(this._x=0,this._y=Math.atan2(r,t))):"XZY"===e&&(this._z=Math.asin(-i(a)),Math.abs(a)<.99999?(this._x=Math.atan2(c,o),this._y=Math.atan2(r,s)):(this._x=Math.atan2(-h,t),this._y=0)),this._order=e,this._updateQuaternion(),this}setFromQuaternion(t,e,i){function s(t){return Math.min(Math.max(t,-1),1)}var a=t.x*t.x,r=t.y*t.y,n=t.z*t.z,o=t.w*t.w;return"XYZ"===(e=e||this._order)?(this._x=Math.atan2(2*(t.x*t.w-t.y*t.z),o-a-r+n),this._y=Math.asin(s(2*(t.x*t.z+t.y*t.w))),this._z=Math.atan2(2*(t.z*t.w-t.x*t.y),o+a-r-n)):"YXZ"===e?(this._x=Math.asin(s(2*(t.x*t.w-t.y*t.z))),this._y=Math.atan2(2*(t.x*t.z+t.y*t.w),o-a-r+n),this._z=Math.atan2(2*(t.x*t.y+t.z*t.w),o-a+r-n)):"ZXY"===e?(this._x=Math.asin(s(2*(t.x*t.w+t.y*t.z))),this._y=Math.atan2(2*(t.y*t.w-t.z*t.x),o-a-r+n),this._z=Math.atan2(2*(t.z*t.w-t.x*t.y),o-a+r-n)):"ZYX"===e?(this._x=Math.atan2(2*(t.x*t.w+t.z*t.y),o-a-r+n),this._y=Math.asin(s(2*(t.y*t.w-t.x*t.z))),this._z=Math.atan2(2*(t.x*t.y+t.z*t.w),o+a-r-n)):"YZX"===e?(this._x=Math.atan2(2*(t.x*t.w-t.z*t.y),o-a+r-n),this._y=Math.atan2(2*(t.y*t.w-t.x*t.z),o+a-r-n),this._z=Math.asin(s(2*(t.x*t.y+t.z*t.w)))):"XZY"===e&&(this._x=Math.atan2(2*(t.x*t.w+t.y*t.z),o-a+r-n),this._y=Math.atan2(2*(t.x*t.z+t.y*t.w),o+a-r-n),this._z=Math.asin(s(2*(t.z*t.w-t.x*t.y)))),this._order=e,!1!==i&&this._updateQuaternion(),this}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}clone(){return new Euler(this._x,this._y,this._z,this._order)}}Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Euler.DefaultOrder="XYZ";class Matrix3d{constructor(t,e,i,s,a,r,n,o,h){try{this.elements=new Float32Array(9)}catch(t){this.elements=new Array(9)}this.set(void 0!==t?t:1,e||0,i||0,s||0,void 0!==a?a:1,r||0,n||0,o||0,void 0!==h?h:1)}set(t,e,i,s,a,r,n,o,h){var l=this.elements;return l[0]=t,l[3]=e,l[6]=i,l[1]=s,l[4]=a,l[7]=r,l[2]=n,l[5]=o,l[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){t=t.elements;return this.set(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8]),this}multiplyScalar(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){var t=this.elements,e=t[0],i=t[1],s=t[2],a=t[3],r=t[4],n=t[5],o=t[6],h=t[7],t=t[8];return e*r*t-e*n*h-i*a*t+i*n*o+s*a*h-s*r*o}getInverse(t,e){var t=t.elements,i=this.elements,t=(i[0]=t[10]*t[5]-t[6]*t[9],i[1]=-t[10]*t[1]+t[2]*t[9],i[2]=t[6]*t[1]-t[2]*t[5],i[3]=-t[10]*t[4]+t[6]*t[8],i[4]=t[10]*t[0]-t[2]*t[8],i[5]=-t[6]*t[0]+t[2]*t[4],i[6]=t[9]*t[4]-t[5]*t[8],i[7]=-t[9]*t[0]+t[1]*t[8],i[8]=t[5]*t[0]-t[1]*t[4],t[0]*i[0]+t[1]*i[3]+t[2]*i[6]);if(0==t){if(e)throw new Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity()}else this.multiplyScalar(1/t);return this}transpose(){var t=this.elements,e=t[1];return t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}clone(){var t=this.elements;return new Matrix3d(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])}rotate(){}translate(){}scale(){}skew(){}}let ClMath={PI2:2*Math.PI,generateUUID:function(){var e,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),s=new Array(36),a=0;return function(){for(var t=0;t<36;t++)8==t||13==t||18==t||23==t?s[t]="-":14==t?s[t]="4":(a<=2&&(a=33554432+16777216*Math.random()|0),e=15&a,a>>=4,s[t]=i[19==t?3&e|8:e]);return s.join("")}}(),clamp:function(t,e,i){return t<e?e:i<t?i:t},clampBottom:function(t,e){return t<e?e:t},mapLinear:function(t,e,i,s,a){return s+(t-e)*(a-s)/(i-e)},smoothstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:i<=t?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},sign:function(t){return t<0?-1:0<t?1:0},degToRad:function(){var e=Math.PI/180;return function(t){return t*e}}(),radToDeg:function(){var e=180/Math.PI;return function(t){return t*e}}()};class Matrix4d{constructor(t,e,i,s,a,r,n,o,h,l,c,d,u,p,m,f){try{this.elements=new Float32Array(16)}catch(t){this.elements=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}var g=this.elements;g[0]=void 0!==t?t:1,g[4]=e||0,g[8]=i||0,g[12]=s||0,g[1]=a||0,g[5]=void 0!==r?r:1,g[9]=n||0,g[13]=o||0,g[2]=h||0,g[6]=l||0,g[10]=void 0!==c?c:1,g[14]=d||0,g[3]=u||0,g[7]=p||0,g[11]=m||0,g[15]=void 0!==f?f:1}get(t,e){return this.elements[4*t+e]}set(t,e,i,s,a,r,n,o,h,l,c,d,u,p,m,f){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=s,g[1]=a,g[5]=r,g[9]=n,g[13]=o,g[2]=h,g[6]=l,g[10]=c,g[14]=d,g[3]=u,g[7]=p,g[11]=m,g[15]=f,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}copy(e){try{this.elements.set(e.elements)}catch(t){this.elements=e.elements.slice(0,e.elements.length-1)}return this}copyPosition(t){var e=this.elements,t=t.elements;return e[12]=t[12],e[13]=t[13],e[14]=t[14],this}extractRotation(t){var e=new Vector3d,i=this.elements,t=t.elements,s=1/e.set(t[0],t[1],t[2]).length(),a=1/e.set(t[4],t[5],t[6]).length(),e=1/e.set(t[8],t[9],t[10]).length();return i[0]=t[0]*s,i[1]=t[1]*s,i[2]=t[2]*s,i[4]=t[4]*a,i[5]=t[5]*a,i[6]=t[6]*a,i[8]=t[8]*e,i[9]=t[9]*e,i[10]=t[10]*e,this}makeRotationFromQuaternion(t){var e=this.elements,i=t.x,s=t.y,a=t.z,t=t.w,r=i+i,n=s+s,o=a+a,h=i*r,l=i*n,i=i*o,c=s*n,s=s*o,a=a*o,r=t*r,n=t*n,t=t*o;return e[0]=1-(c+a),e[4]=l-t,e[8]=i+n,e[1]=l+t,e[5]=1-(h+a),e[9]=s-r,e[2]=i-n,e[6]=s+r,e[10]=1-(h+c),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}lookAt(t,e,i){var s=new Vector3d,a=new Vector3d,r=new Vector3d,n=this.elements;return r.subVectors(t,e).normalize(),0===r.length()&&(r.z=1),s.crossVectors(i,r).normalize(),0===s.length()&&(r.x+=1e-4,s.crossVectors(i,r).normalize()),a.crossVectors(r,s),n[0]=s.x,n[4]=a.x,n[8]=r.x,n[1]=s.y,n[5]=a.y,n[9]=r.y,n[2]=s.z,n[6]=a.z,n[10]=r.z,this}multiply(t,e){return void 0!==e?this.multiplyMatrices(t,e):this.multiplyMatrices(this,t)}multiplyMatrices(t,e){var t=t.elements,e=e.elements,i=this.elements,s=t[0],a=t[4],r=t[8],n=t[12],o=t[1],h=t[5],l=t[9],c=t[13],d=t[2],u=t[6],p=t[10],m=t[14],f=t[3],g=t[7],v=t[11],t=t[15],y=e[0],x=e[4],w=e[8],_=e[12],b=e[1],M=e[5],T=e[9],k=e[13],C=e[2],S=e[6],P=e[10],E=e[14],z=e[3],I=e[7],O=e[11],e=e[15];return i[0]=s*y+a*b+r*C+n*z,i[4]=s*x+a*M+r*S+n*I,i[8]=s*w+a*T+r*P+n*O,i[12]=s*_+a*k+r*E+n*e,i[1]=o*y+h*b+l*C+c*z,i[5]=o*x+h*M+l*S+c*I,i[9]=o*w+h*T+l*P+c*O,i[13]=o*_+h*k+l*E+c*e,i[2]=d*y+u*b+p*C+m*z,i[6]=d*x+u*M+p*S+m*I,i[10]=d*w+u*T+p*P+m*O,i[14]=d*_+u*k+p*E+m*e,i[3]=f*y+g*b+v*C+t*z,i[7]=f*x+g*M+v*S+t*I,i[11]=f*w+g*T+v*P+t*O,i[15]=f*_+g*k+v*E+t*e,this}multiplyScalar(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){var t=this.elements,e=t[0],i=t[4],s=t[8],a=t[12],r=t[1],n=t[5],o=t[9],h=t[13],l=t[2],c=t[6],d=t[10],u=t[14];return t[3]*(+a*o*c-s*h*c-a*n*d+i*h*d+s*n*u-i*o*u)+t[7]*(+e*o*u-e*h*d+a*r*d-s*r*u+s*h*l-a*o*l)+t[11]*(+e*h*c-e*n*u-a*r*c+i*r*u+a*n*l-i*h*l)+t[15]*(-s*n*l-e*o*c+e*n*d+s*r*c-i*r*d+i*o*l)}transpose(){var t=this.elements,e=t[1];return t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this}getInverse(t=this,e){var i=this.elements,t=t.elements,s=t[0],a=t[4],r=t[8],n=t[12],o=t[1],h=t[5],l=t[9],c=t[13],d=t[2],u=t[6],p=t[10],m=t[14],f=t[3],g=t[7],v=t[11],t=t[15],t=(i[0]=l*m*g-c*p*g+c*u*v-h*m*v-l*u*t+h*p*t,i[4]=n*p*g-r*m*g-n*u*v+a*m*v+r*u*t-a*p*t,i[8]=r*c*g-n*l*g+n*h*v-a*c*v-r*h*t+a*l*t,i[12]=n*l*u-r*c*u-n*h*p+a*c*p+r*h*m-a*l*m,i[1]=c*p*f-l*m*f-c*d*v+o*m*v+l*d*t-o*p*t,i[5]=r*m*f-n*p*f+n*d*v-s*m*v-r*d*t+s*p*t,i[9]=n*l*f-r*c*f-n*o*v+s*c*v+r*o*t-s*l*t,i[13]=r*c*d-n*l*d+n*o*p-s*c*p-r*o*m+s*l*m,i[2]=h*m*f-c*u*f+c*d*g-o*m*g-h*d*t+o*u*t,i[6]=n*u*f-a*m*f-n*d*g+s*m*g+a*d*t-s*u*t,i[10]=a*c*f-n*h*f+n*o*g-s*c*g-a*o*t+s*h*t,i[14]=n*h*d-a*c*d-n*o*u+s*c*u+a*o*m-s*h*m,i[3]=l*u*f-h*p*f-l*d*g+o*p*g+h*d*v-o*u*v,i[7]=a*p*f-r*u*f+r*d*g-s*p*g-a*d*v+s*u*v,i[11]=r*h*f-a*l*f-r*o*g+s*l*g+a*o*v-s*h*v,i[15]=a*l*d-r*h*d+r*o*u-s*l*u-a*o*p+s*h*p,s*i[0]+o*i[4]+d*i[8]+f*i[12]);if(0==t){if(e)throw new Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity()}else this.multiplyScalar(1/t);return this}translate(t){var e=this.elements;return e[12]+=t.x,e[13]+=t.y,e[14]+=t.z,this}rotateX(t){}rotateY(t){}rotateZ(t){t=new Matrix4d(Math.cos(t),-Math.sin(t),0,0,Math.sin(t),Math.cos(t),0,0,0,0,1,0,0,0,0,1);return this.multiply(t)}scale(t){var e=this.elements,i=t.x,s=t.y,t=t.z;return e[0]*=i,e[4]*=s,e[8]*=t,e[1]*=i,e[5]*=s,e[9]*=t,e[2]*=i,e[6]*=s,e[10]*=t,e[3]*=i,e[7]*=s,e[11]*=t,this}compose(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this}decompose(t,e,i){var s=new Vector3d,a=new Matrix4d,r=this.elements,n=s.set(r[0],r[1],r[2]).length(),o=s.set(r[4],r[5],r[6]).length(),s=s.set(r[8],r[9],r[10]).length(),t=(t.x=r[12],t.y=r[13],t.z=r[14],a.elements.set(this.elements),1/n),r=1/o,h=1/s;return a.elements[0]*=t,a.elements[1]*=t,a.elements[2]*=t,a.elements[4]*=r,a.elements[5]*=r,a.elements[6]*=r,a.elements[8]*=h,a.elements[9]*=h,a.elements[10]*=h,e.setFromRotationMatrix(a),i.x=n,i.y=o,i.z=s,this}makeFrustum(t,e,i,s,a,r){var n=this.elements,o=2*a/(s-i),h=(e+t)/(e-t),s=(s+i)/(s-i),i=-(r+a)/(r-a),r=-2*r*a/(r-a);return n[0]=2*a/(e-t),n[4]=0,n[8]=h,n[12]=0,n[1]=0,n[5]=o,n[9]=s,n[13]=0,n[2]=0,n[6]=0,n[10]=i,n[14]=r,n[3]=0,n[7]=0,n[11]=-1,n[15]=0,this}makePerspective(t,e,i,s){var t=i*Math.tan(ClMath.degToRad(.5*t)),a=-t;return this.makeFrustum(a*e,t*e,a,t,i,s)}clone(){var t=this.elements;return new Matrix4d(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])}}class Quaternion{constructor(t,e,i,s){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==s?s:1,this._euler=void 0}_updateEuler(){void 0!==this._euler&&this._euler.setFromQuaternion(this,void 0,!1)}get x(){return this._x}set x(t){this._x=t,this._updateEuler()}get y(){return this._y}set y(t){this._y=t,this._updateEuler()}get z(){return this._z}set z(t){this._z=t,this._updateEuler()}get w(){return this._w}set w(t){this._w=t,this._updateEuler()}set(t,e,i,s){return this._x=t,this._y=e,this._z=i,this._w=s,this._updateEuler(),this}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._w=t._w,this._updateEuler(),this}setFromEuler(t,e){var i,s,a,r,n,o;if(t instanceof Euler)return i=Math.cos(t._x/2),s=Math.cos(t._y/2),a=Math.cos(t._z/2),r=Math.sin(t._x/2),n=Math.sin(t._y/2),o=Math.sin(t._z/2),"XYZ"===t.order?(this._x=r*s*a+i*n*o,this._y=i*n*a-r*s*o,this._z=i*s*o+r*n*a,this._w=i*s*a-r*n*o):"YXZ"===t.order?(this._x=r*s*a+i*n*o,this._y=i*n*a-r*s*o,this._z=i*s*o-r*n*a,this._w=i*s*a+r*n*o):"ZXY"===t.order?(this._x=r*s*a-i*n*o,this._y=i*n*a+r*s*o,this._z=i*s*o+r*n*a,this._w=i*s*a-r*n*o):"ZYX"===t.order?(this._x=r*s*a-i*n*o,this._y=i*n*a+r*s*o,this._z=i*s*o-r*n*a,this._w=i*s*a+r*n*o):"YZX"===t.order?(this._x=r*s*a+i*n*o,this._y=i*n*a+r*s*o,this._z=i*s*o-r*n*a,this._w=i*s*a-r*n*o):"XZY"===t.order&&(this._x=r*s*a-i*n*o,this._y=i*n*a-r*s*o,this._z=i*s*o+r*n*a,this._w=i*s*a+r*n*o),!1!==e&&this._updateEuler(),this;throw new Error("ERROR: Quaternion's .setFromEuler() now expects a Euler rotation rather than a Vector3 and order.  Please update your code.")}setFromAxisAngle(t,e){var e=e/2,i=Math.sin(e);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(e),this._updateEuler(),this}setFromRotationMatrix(t){var e,t=t.elements,i=t[0],s=t[4],a=t[8],r=t[1],n=t[5],o=t[9],h=t[2],l=t[6],t=t[10],c=i+n+t;return 0<c?(e=.5/Math.sqrt(c+1),this._w=.25/e,this._x=(l-o)*e,this._y=(a-h)*e,this._z=(r-s)*e):n<i&&t<i?(e=2*Math.sqrt(1+i-n-t),this._w=(l-o)/e,this._x=.25*e,this._y=(s+r)/e,this._z=(a+h)/e):t<n?(e=2*Math.sqrt(1+n-i-t),this._w=(a-h)/e,this._x=(s+r)/e,this._y=.25*e,this._z=(o+l)/e):(e=2*Math.sqrt(1+t-i-n),this._w=(r-s)/e,this._x=(a+h)/e,this._y=(o+l)/e,this._z=.25*e),this._updateEuler(),this}inverse(){return this.conjugate().normalize(),this}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._updateEuler(),this}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this.lengthSq())}normalize(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(t=1/t),this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this}multiply(t,e){return void 0!==e?this.multiplyQuaternions(t,e):this.multiplyQuaternions(this,t)}multiplyQuaternions(t,e){var i=t._x,s=t._y,a=t._z,t=t._w,r=e._x,n=e._y,o=e._z,e=e._w;return this._x=i*e+t*r+s*o-a*n,this._y=s*e+t*n+a*r-i*o,this._z=a*e+t*o+i*n-s*r,this._w=t*e-i*r-s*n-a*o,this._updateEuler(),this}multiplyVector3(t){return t.applyQuaternion(this)}slerp(t,e){var i,s=this._x,a=this._y,r=this._z,n=this._w,o=n*t._w+s*t._x+a*t._y+r*t._z;return o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),1<=o?(this._w=n,this._x=s,this._y=a,this._z=r):(t=Math.acos(o),o=Math.sqrt(1-o*o),Math.abs(o)<.001?(this._w=.5*(n+this._w),this._x=.5*(s+this._x),this._y=.5*(a+this._y),this._z=.5*(r+this._z)):(i=Math.sin((1-e)*t)/o,e=Math.sin(e*t)/o,this._w=n*i+this._w*e,this._x=s*i+this._x*e,this._y=a*i+this._y*e,this._z=r*i+this._z*e,this._updateEuler())),this}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}clone(){return new Quaternion(this._x,this._y,this._z,this._w)}slerp(t,e,i,s){return i.copy(t).slerp(e,s)}}class EventDispatcher{constructor(){}apply(t){t.addEventListener=EventDispatcher.prototype.addEventListener,t.hasEventListener=EventDispatcher.prototype.hasEventListener,t.removeEventListener=EventDispatcher.prototype.removeEventListener,t.dispatchEvent=EventDispatcher.prototype.dispatchEvent}addEventListener(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)}hasEventListener(t,e){var i;return void 0!==this._listeners&&void 0!==(i=this._listeners)[t]&&-1!==i[t].indexOf(e)}removeEventListener(t,e){var i;void 0!==this._listeners&&void 0!==(t=this._listeners[t])&&-1!==(i=t.indexOf(e))&&t.splice(i,1)}dispatchEvent(t){var e=[];if(void 0!==this._listeners){var i=this._listeners[t.type];if(void 0!==i){t.target=this;for(var s=i.length,a=0;a<s;a++)e[a]=i[a];for(a=0;a<s;a++)e[a].call(this,t)}}}}class Object3D extends EventDispatcher{constructor(){super(),this.id=Object3D.Object3DIdCount++,this.uuid=ClMath.generateUUID(),this.name="",this.parent=void 0,this.children=[],this.up=new Vector3d(0,1,0),this.position=new Vector3d,this._rotation=new Euler,this._quaternion=new Quaternion,this.scale=new Vector3d(1,1,1),this._rotation._quaternion=this.quaternion,this._quaternion._euler=this.rotation,this.renderDepth=null,this.rotationAutoUpdate=!0,this.matrix=new Matrix4d,this.matrixWorld=new Matrix4d,this.matrixAutoUpdate=!0,this.matrixWorldNeedsUpdate=!0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.userData={}}get rotation(){return this._rotation}set rotation(t){this._rotation=t,this._rotation._quaternion=this._quaternion,this._quaternion._euler=this._rotation,this._rotation._updateQuaternion()}get quaternion(){return this._quaternion}set quaternion(t){this._quaternion=t,this._quaternion._euler=this._rotation,this._rotation._quaternion=this._quaternion,this._quaternion._updateEuler()}rotateOnAxis(t,e){var i=new Quaternion;return i.setFromAxisAngle(t,e),this.quaternion.multiply(i),this}rotateX(t){var e=new Vector3d(1,0,0);return this.rotateOnAxis(e,t)}rotateY(t){var e=new Vector3d(0,1,0);return this.rotateOnAxis(e,t)}rotateZ(t){var e=new Vector3d(0,0,1);return this.rotateOnAxis(e,t)}translateOnAxis(t,e){var i=new Vector3d;return i.copy(t),i.applyQuaternion(this.quaternion),this.position.add(i.multiplyScalar(e)),this}translate(t,e){return this.translateOnAxis(e,t)}translateX(t){var e=new Vector3d(1,0,0);return this.translateOnAxis(e,t)}translateY(t){var e=new Vector3d(0,1,0);return this.translateOnAxis(e,t)}translateZ(t){var e=new Vector3d(0,0,1);return this.translateOnAxis(e,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){var e=new Matrix4d;return t.applyMatrix4(e.getInverse(this.matrixWorld))}lookAt(t){var e=new Matrix4d;e.lookAt(t,this.position,this.up),this.quaternion.setFromRotationMatrix(e)}add(t){if(t!==this&&t instanceof Object3D){void 0!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t);for(var e=this;void 0!==e.parent;)e=e.parent;(null==e?void 0:e.__addObject)instanceof Function&&e.__addObject(t)}}remove(t){var e=this.children.indexOf(t);if(-1!==e){t.parent=void 0,t.dispatchEvent({type:"removed"}),this.children.splice(e,1);for(var i=this;void 0!==i.parent;)i=i.parent;(null==i?void 0:i.__addObject)instanceof Function&&i.__removeObject(t)}}traverse(t){t(this);for(var e=0,i=this.children.length;e<i;e++)this.children[e].traverse(t)}getObjectById(t,e){for(var i=0,s=this.children.length;i<s;i++){var a=this.children[i];if(a.id===t)return a;if(!0===e&&void 0!==(a=a.getObjectById(t,e)))return a}}getObjectByName(t,e){for(var i=0,s=this.children.length;i<s;i++){var a=this.children[i];if(a.name===t)return a;if(!0===e&&void 0!==(a=a.getObjectByName(t,e)))return a}}getChildByName(t,e){return this.getObjectByName(t,e)}getDescendants(t){void 0===t&&(t=[]),Array.prototype.push.apply(t,this.children);for(var e=0,i=this.children.length;e<i;e++)this.children[e].getDescendants(t);return t}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){!0===this.matrixAutoUpdate&&this.updateMatrix(),!0!==this.matrixWorldNeedsUpdate&&!0!==t||(void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var e=0,i=this.children.length;e<i;e++)this.children[e].updateMatrixWorld(t)}clone(t,e){if(void 0===e&&(e=!0),(t=void 0===t?new Object3D:t).name=this.name,t.up.copy(this.up),t.position.copy(this.position),t.quaternion.copy(this.quaternion),t.scale.copy(this.scale),t.renderDepth=this.renderDepth,t.rotationAutoUpdate=this.rotationAutoUpdate,t.matrix.copy(this.matrix),t.matrixWorld.copy(this.matrixWorld),t.matrixAutoUpdate=this.matrixAutoUpdate,t.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate,t.visible=this.visible,t.castShadow=this.castShadow,t.receiveShadow=this.receiveShadow,t.frustumCulled=this.frustumCulled,t.userData=JSON.parse(JSON.stringify(this.userData)),!0===e)for(var i=0;i<this.children.length;i++){var s=this.children[i];t.add(s.clone())}return t}}Object3D.Object3DIdCount=0;class Camera extends Object3D{constructor(){super(),this.matrixWorldInverse=new Matrix4d,this.projectionMatrix=new Matrix4d,this.projectionMatrixInverse=new Matrix4d}lookAt(t){t=(new Matrix4d).lookAt(this.position,t,this.up);this.quaternion.setFromRotationMatrix(t)}}class PerspectiveCamera extends Camera{constructor(t,e,i,s){super(),this.fov=void 0!==t?t:50,this.aspect=void 0!==e?e:1,this.near=void 0!==i?i:.1,this.far=void 0!==s?s:2e3,this.updateProjectionMatrix()}updateProjectionMatrix(){var t,e,i,s;this.fullWidth?(e=(i=this.fullWidth/this.fullHeight)*(s=-(t=Math.tan(ClMath.degToRad(.5*this.fov))*this.near)),i=Math.abs(i*t-e),s=Math.abs(t-s),this.projectionMatrix.makeFrustum(e+this.x*i/this.fullWidth,e+(this.x+this.width)*i/this.fullWidth,t-(this.y+this.height)*s/this.fullHeight,t-this.y*s/this.fullHeight,this.near,this.far)):this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)}}class Scene extends Object3D{constructor(){super(),this.fog=null,this.overrideMaterial=null,this.overrideMaterial=null,this.autoUpdate=!0,this.matrixAutoUpdate=!1,this.__lights=[],this.__objectsAdded=[],this.__objectsRemoved=[]}__addObject(t){var e;t instanceof Camera||(this.__objectsAdded.push(t),-1!==(e=this.__objectsRemoved.indexOf(t))&&this.__objectsRemoved.splice(e,1));for(var i=0;i<t.children.length;i++)this.__addObject(t.children[i])}__removeObject(t){var e;t instanceof Camera||(this.__objectsRemoved.push(t),-1!==(e=this.__objectsAdded.indexOf(t))&&this.__objectsAdded.splice(e,1));for(var i=0;i<t.children.length;i++)this.__removeObject(t.children[i])}}class CSS3DObject extends Object3D{constructor(t){super(),this.element=t,this.element.style.position="absolute",this.addEventListener("removed",function(t){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)})}}class ImageLoader{constructor(){}load(t,e,i,s){var a=document.createElement("img");return void 0!==e&&a.addEventListener("load",function(t){e(this)},!1),void 0!==i&&a.addEventListener("progress",function(t){i(t)},!1),void 0!==s&&a.addEventListener("error",function(t){s(t)},!1),void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),a.src=t,a}setCrossOrigin(t){this.crossOrigin=t}}class Css3DRenderer{constructor(t){this._preserve3d=void 0===(t=t||{}).preserve3d||t.preserve3d,this._preserve3d=!1,this.sortObjects=void 0===t.sortObjects||t.sortObjects,this._width=t.w||0,this._height=t.h||0,this._fov=0,this.matrix=new Matrix4d,this.matrix_1=new Matrix4d,(this._scope=this).cache={camera:{fov:0,style:""},objects:{}};var t=t.div&&"DIV"===t.div.nodeName?t.div:document.createElement("div"),e=(t.style.overflow="hidden",t.className="domElement innerContainer",this.domElement=t,document.createElement("div"));e.style.cssText="position:absolute;z-index:-1;",e.className="cameraElement",this.cameraElement=e,this.preserve3d=this._preserve3d,t.appendChild(e)}renderObject(t,e){var style,i,s;t instanceof CSS3DObject&&(this.matrix.elements,style=this._scope._preserve3d?this.getObjectCSSMatrix(t.matrixWorld):(this.matrix.copy(e.matrixWorldInverse),this.matrix.multiply(t.matrixWorld),this.getObjectCSSMatrix(this.matrix,t.is3d)),i=t.element,void 0!==(s=this.cache.objects[t.id])&&s===style||(i.style.WebkitTransform=style,i.style.MozTransform=style,i.style.oTransform=style,i.style.transform=style,i.style.msTransform=style,this.cache.objects[t.id]=style),null!=i.parentNode&&i.parentNode.parentNode===this.cameraElement||((s=document.createElement("div")).style.cssText="position:absolute;transform: translateZ(0px)",s.id="layer_"+i.attributes["data-zo"],s.style.zIndex=1e4-5*parseInt(i.attributes["data-zo"]),s.appendChild(i),this.cameraElement.appendChild(s),window.cam=this.cameraElement));for(var a=0,r=t.children.length;a<r;a++)this.renderObject(t.children[a],e)}render(t,e){t.updateMatrixWorld(),void 0===e.parent&&e.updateMatrixWorld(),e.matrixWorldInverse.getInverse(e.matrixWorld),this._preserve3d||this.cache.camera.fov!==e.fov&&(this._fov=Math.tan(ClMath.degToRad(.5*(180-(e.fov||180))))*(this._height/2),this.cache.camera.fov=e.fov),this.renderObject(t,e)}getObjectCSSMatrix(t,e){function i(t,e=0){return void 0!==t&&!isNaN(t)||(t=e),Math.abs(t)<1e-6?0:t}t=t.elements;return"translate3d(-50%,-50%,0)"+(e?" perspective("+this._fov+"px) translate3d(0,0,"+this._fov+"px)":"")+" matrix3d("+i(t[0],1)+","+i(-t[1])+","+i(t[2])+","+i(t[3])+","+i(-t[4])+","+i(t[5],1)+","+i(-t[6])+","+i(-t[7])+","+i(t[8])+","+i(-t[9])+","+i(t[10],1)+","+i(t[11])+","+i(t[12])+","+i(-t[13])+","+i(t[14])+","+i(t[15],1)+")"}setClearColor(t,e){var i,s="transparent";1<=e?(i=t.toString(16),s="#"+Array(6-i.length+1).join("0")+i):0<e&&(s="rgba("+((i=Math.floor(t))>>16&255)+","+(i>>8&255)+","+(255&i)+","+e+")"),this.domElement.style.backgroundColor=s}setSize(t,e){var i=(this._width=t)/2,s=(this._height=e)/2,a=(this.domElement.style.width=t+"px",this.domElement.style.height=e+"px",this.cameraElement.style);a.width=t+"px",a.height=e+"px",this._preserve3d||(a.WebkitTransform=t="translate3d("+i+"px,"+s+"px, 0px)",a.MozTransform=t,a.oTransform=t,a.transform=t,a.msTransform=t)}}var THREE={};try{!function(){for(var a=0,t=["ms","moz","webkit","o"],e=0;e<t.length&&!self.requestAnimationFrame;++e)self.requestAnimationFrame=self[t[e]+"RequestAnimationFrame"],self.cancelAnimationFrame=self[t[e]+"CancelAnimationFrame"]||self[t[e]+"CancelRequestAnimationFrame"];void 0===self.requestAnimationFrame&&void 0!==self.setTimeout&&(self.requestAnimationFrame=function(t){var e=Date.now(),i=Math.max(0,16-(e-a)),s=self.setTimeout(function(){t(e+i)},i);return a=e+i,s}),void 0===self.cancelAnimationFrame&&void 0!==self.clearTimeout&&(self.cancelAnimationFrame=function(t){self.clearTimeout(t)})}(),THREE.Quaternion=Quaternion,THREE.Vector2=Vector2d,THREE.Vector3=Vector3d,THREE.Vector4=Vector4d,THREE.Euler=Euler,THREE.Matrix3=Matrix3d,THREE.Matrix4=Matrix4d,THREE.Math=ClMath,THREE.EventDispatcher=EventDispatcher,THREE.Object3D=Object3D,THREE.Camera=Camera,THREE.PerspectiveCamera=PerspectiveCamera,THREE.ImageLoader=ImageLoader,THREE.Scene=Scene,THREE.CSS3DRenderer=Css3DRenderer,THREE.CSS3DObject=CSS3DObject}catch(t){T.reportExceptionError("three_declare_part1",t)}let D={},U=1e-6;function y(){var C=Math,g=Math.pow,v=Math.sqrt,c=Math.floor;function y(t,e,i,s,a,r){a=t*s+e*a+i*r-a*s-r*t-i*e;return-.001<a&&a<.001}var d=function(t,e,i,s){for(var a,r,n,o,h=0,l=[],c=[],d=bezierLengthPool.newElement(),u=i.length,p=0;p<50;p+=1){for(n=p/49,a=o=0;a<u;a+=1)r=g(1-n,3)*t[a]+3*g(1-n,2)*n*i[a]+3*(1-n)*g(n,2)*s[a]+g(n,3)*e[a],l[a]=r,null!==c[a]&&(o+=g(l[a]-c[a],2)),c[a]=l[a];o&&(h+=o=v(o)),d.percents[p]=n,d.lengths[p]=h}return d.addedLength=h,d};function x(t){this.segmentLength=0,this.points=new Array(t)}function w(t,e){this.partialLength=t,this.point=e}function t(t,e,i,s){var a=(t[0]+"_"+t[1]+"_"+e[0]+"_"+e[1]+"_"+i[0]+"_"+i[1]+"_"+s[0]+"_"+s[1]).replace(/\./g,"p");if(!_[a]){for(var r,n,o,h,l,c=50,d=0,u=null,p=new x(c=2===t.length&&(t[0]!==e[0]||t[1]!==e[1])&&y(t[0],t[1],e[0],e[1],t[0]+i[0],t[1]+i[1])&&y(t[0],t[1],e[0],e[1],e[0]+s[0],e[1]+s[1])?2:c),m=i.length,f=0;f<c;f+=1){for(l=b(m),o=f/(c-1),r=h=0;r<m;r+=1)n=g(1-o,3)*t[r]+3*g(1-o,2)*o*(t[r]+i[r])+3*(1-o)*g(o,2)*(e[r]+s[r])+g(o,3)*e[r],l[r]=n,null!==u&&(h+=g(l[r]-u[r],2));d+=h=v(h),p.points[f]=new w(h,l),u=l}p.segmentLength=d,_[a]=p}return _[a]}var _;_={};function S(t,e){var i=e.percents,s=e.lengths,a=i.length,r=c((a-1)*t),n=t*e.addedLength,o=0;if(r===a-1||0===r||n===s[r])return i[r];for(var h=s[r]>n?-1:1,l=!0;l;)if(s[r]<=n&&s[r+1]>n?(o=(n-s[r])/(s[r+1]-s[r]),l=!1):r+=h,r<0||a-1<=r){if(r===a-1)return i[r];l=!1}return i[r]+(i[r+1]-i[r])*o}var P=V("float32",8);return{getSegmentsLength:function(t){for(var e=segmentsLengthPool.newElement(),i=t.c,s=t.v,a=t.o,r=t.i,n=t._length,o=e.lengths,h=0,l=0;l<n-1;l+=1)o[l]=d(s[l],s[l+1],a[l],r[l+1]),h+=o[l].addedLength;return i&&n&&(o[l]=d(s[l],s[0],a[l],r[0]),h+=o[l].addedLength),e.totalLength=h,e},getNewSegment:function(t,e,i,s,a,r,n){a<0?a=0:1<a&&(a=1);for(var a=S(a,n),r=S(r=1<r?1:r,n),o=t.length,h=1-r,l=(n=1-a)*n*n,c=a*n*n*3,d=a*a*n*3,u=a*a*a,p=n*n*h,m=a*n*h+n*a*h+n*n*r,f=a*a*h+n*a*r+a*n*r,g=a*a*r,v=n*h*h,y=a*h*h+n*r*h+n*h*r,x=a*r*h+n*r*r+a*h*r,w=a*r*r,_=h*h*h,b=r*h*h+h*r*h+h*h*r,M=r*r*h+h*r*r+r*h*r,T=r*r*r,k=0;k<o;k+=1)P[4*k]=C.round(1e3*(l*t[k]+c*i[k]+d*s[k]+u*e[k]))/1e3,P[4*k+1]=C.round(1e3*(p*t[k]+m*i[k]+f*s[k]+g*e[k]))/1e3,P[4*k+2]=C.round(1e3*(v*t[k]+y*i[k]+x*s[k]+w*e[k]))/1e3,P[4*k+3]=C.round(1e3*(_*t[k]+b*i[k]+M*s[k]+T*e[k]))/1e3;return P},getPointInSegment:function(t,e,i,s,a,r){return a=S(a,r),r=1-a,[C.round(1e3*(r*r*r*t[0]+(a*r*r+r*a*r+r*r*a)*i[0]+(a*a*r+r*a*a+a*r*a)*s[0]+a*a*a*e[0]))/1e3,C.round(1e3*(r*r*r*t[1]+(a*r*r+r*a*r+r*r*a)*i[1]+(a*a*r+r*a*a+a*r*a)*s[1]+a*a*a*e[1]))/1e3]},buildBezierData:t,pointOnLine2D:y,pointOnLine3D:function(t,e,i,s,a,r,n,o,h){var l;return 0===i&&0===r&&0===h?y(t,e,s,a,n,o):(l=C.sqrt(C.pow(s-t,2)+C.pow(a-e,2)+C.pow(r-i,2)),t=C.sqrt(C.pow(n-t,2)+C.pow(o-e,2)+C.pow(h-i,2)),e=C.sqrt(C.pow(n-s,2)+C.pow(o-a,2)+C.pow(h-r,2)),-1e-4<(i=t<l?e<l?l-t-e:e-t-l:t<e?e-t-l:t-l-e)&&i<1e-4)}}}var V=function(){function i(t,e){var i,s=0,a=[];switch(t){case"int16":case"uint8c":i=1;break;default:i=1.1}for(s=0;s<e;s+=1)a.push(i);return a}return"function"==typeof Uint8ClampedArray&&"function"==typeof Float32Array?function(t,e){return"float32"===t?new Float32Array(e):"int16"===t?new Int16Array(e):"uint8c"===t?new Uint8ClampedArray(e):i(t,e)}:i}();function b(t){return Array.apply(null,{length:t})}var R=y(),e,s,i,a,r,n,o;D.BezierFactory=function(){var t={getBezierEasing:function(t,e,i,s,a){a=a||("bez_"+t+"_"+e+"_"+i+"_"+s).replace(/\./g,"p");if(r[a])return r[a];t=new n([t,e,i,s]);return r[a]=t}},r={};var M=11,T=1/(M-1),e="function"==typeof Float32Array;function s(t,e){return 1-3*e+3*t}function B(t,e){return 3*e-6*t}function k(t,e,i){return((s(e,i)*t+B(e,i))*t+3*e)*t}function C(t,e,i){return 3*s(e,i)*t*t+2*B(e,i)*t+3*e}function n(t){this._p=t,this._mSampleValues=new(e?Float32Array:Array)(M),this._precomputed=!1,this.get=this.get.bind(this)}return n.prototype={get:function(t){var e=this._p[0],i=this._p[1],s=this._p[2],a=this._p[3];return this._precomputed||this._precompute(),e===i&&s===a?t:0===t?0:1===t?1:k(this._getTForX(t),i,a)},_precompute:function(){var t=this._p[0],e=this._p[1],i=this._p[2],s=this._p[3];this._precomputed=!0,t===e&&i===s||this._calcSampleValues()},_calcSampleValues:function(){for(var t=this._p[0],e=this._p[2],i=0;i<M;++i)this._mSampleValues[i]=k(i*T,t,e)},_getTForX:function(t){for(var e=this._p[0],i=this._p[2],s=this._mSampleValues,a=0,r=1,n=M-1;r!==n&&s[r]<=t;++r)a+=T;var o=a+(t-s[--r])/(s[r+1]-s[r])*T,h=C(o,e,i);if(.001<=h){for(var l=t,c=o,d=e,u=i,p=0;p<4;++p){var m=C(c,d,u);if(0===m)return c;c-=(k(c,d,u)-l)/m}return c}if(0===h)return o;for(var f,g,v=t,y=a,x=a+T,w=e,_=i,b=0;0<(f=k(g=y+(x-y)/2,w,_)-v)?x=g:y=g,1e-7<Math.abs(f)&&++b<10;);return g}},t}(),D.PropertyFactory=function(){var l=-999999;function c(t,e){for(var i,s,a,r,n=this.offsetTime,o=("multidimensional"===this.propType&&(i=V("float32",this.pv.length)),e.lastIndex),h=o,l=this.keyframes.length-1,c=!0;c;){if(s=this.keyframes[h],a=this.keyframes[h+1],h===l-1&&t>=a.t-n){s.h&&(s=Object.assign(Object.assign({},s),{s:s.e})),o=0;break}if(a.t-n>t){o=h;break}h<l-1?h+=1:(o=0,c=!1)}var d,u,p,m,f,g=a.t-n,v=s.t-n;if(s.to){s.bezierData||(s.bezierData=R.buildBezierData(s.s,a.s||s.e,s.to,s.ti));var y=s.bezierData;if(g<=t||t<v)for(var x=g<=t?y.points.length-1:0,w=y.points[x].point.length,_=0;_<w;_+=1)i[_]=y.points[x].point[_];else{s.__fnct?r=s.__fnct:(r=D.BezierFactory.getBezierEasing(s.o.x,s.o.y,s.i.x,s.i.y,s.n).get,s.__fnct=r);for(var b,M=r((t-v)/(g-v)),T=y.segmentLength*M,k=e.lastTime<t&&e._lastKeyframeIndex===h?e._lastAddedLength:0,C=e.lastTime<t&&e._lastKeyframeIndex===h?e._lastPoint:0,c=!0,S=y.points.length;c;){if(k+=y.points[C].partialLength,0==T||0===M||C===y.points.length-1){for(w=y.points[C].point.length,_=0;_<w;_+=1)i[_]=y.points[C].point[_];break}if(k<=T&&T<k+y.points[C+1].partialLength){for(b=(T-k)/y.points[C+1].partialLength,w=y.points[C].point.length,_=0;_<w;_+=1)i[_]=y.points[C].point[_]+(y.points[C+1].point[_]-y.points[C].point[_])*b;break}C<S-1?C+=1:c=!1}e._lastPoint=C,e._lastAddedLength=k-y.points[C].partialLength,e._lastKeyframeIndex=h}}else{var P,E,z,I,O,A,L,l=s.s.length,F=a.s||s.e;if(this.sh&&1!==s.h)g<=t?(i[0]=F[0],i[1]=F[1],i[2]=F[2]):t<=v?(i[0]=s.s[0],i[1]=s.s[1],i[2]=s.s[2]):(A=j(s.s),L=j(F),d=i,A=function(t,e,i){var s,a,r,n=[],o=t[0],h=t[1],l=t[2],t=t[3],c=e[0],d=e[1],u=e[2],e=e[3];(r=o*c+h*d+l*u+t*e)<0&&(r=-r,c=-c,d=-d,u=-u,e=-e);r=1e-6<1-r?(r=Math.acos(r),s=Math.sin(r),a=Math.sin((1-i)*r)/s,Math.sin(i*r)/s):(a=1-i,i);return n[0]=a*o+r*c,n[1]=a*h+r*d,n[2]=a*l+r*u,n[3]=a*t+r*e,n}(A,L,(t-v)/(g-v)),L=A[0],u=A[1],p=A[2],A=A[3],m=Math.atan2(2*u*A-2*L*p,1-2*u*u-2*p*p),f=Math.asin(2*L*u+2*p*A),A=Math.atan2(2*L*A-2*u*p,1-2*L*L-2*p*p),d[0]=m/degToRads,d[1]=f/degToRads,d[2]=A/degToRads);else for(h=0;h<l;h+=1)1!==s.h&&(M=g<=t?1:t<v?0:(s.o.x.constructor===Array?(s.__fnct||(s.__fnct=[]),s.__fnct[h]?r=s.__fnct[h]:(P=void 0===s.o.x[h]?s.o.x[0]:s.o.x[h],E=void 0===s.o.y[h]?s.o.y[0]:s.o.y[h],z=void 0===s.i.x[h]?s.i.x[0]:s.i.x[h],I=void 0===s.i.y[h]?s.i.y[0]:s.i.y[h],r=D.BezierFactory.getBezierEasing(P,E,z,I).get,s.__fnct[h]=r)):s.__fnct?r=s.__fnct:(P=s.o.x,E=s.o.y,z=s.i.x,I=s.i.y,r=D.BezierFactory.getBezierEasing(P,E,z,I).get,s.__fnct=r),r((t-v)/(g-v)))),F=a.s||s.e,O=1===s.h?s.s[h]:s.s[h]+(F[h]+U-s.s[h])*M,"multidimensional"===this.propType?i[h]=O:i=O}return e.lastIndex=o,i}function j(t){var e=t[0]*degToRads,i=t[1]*degToRads,t=t[2]*degToRads,s=Math.cos(e/2),a=Math.cos(i/2),r=Math.cos(t/2),e=Math.sin(e/2),i=Math.sin(i/2),t=Math.sin(t/2);return[e*i*r+s*a*t,e*a*r+s*i*t,s*i*r-e*a*t,s*a*r-e*i*t]}function d(t){var t=t-this.offsetTime,e=this.keyframes[0].t-this.offsetTime,i=this.keyframes[this.keyframes.length-1].t-this.offsetTime;if(!(t===this._caching.lastTime||this._caching.lastTime!==l&&(this._caching.lastTime>=i&&i<=t||this._caching.lastTime<e&&t<e))&&(this._caching.lastTime>=t&&(this._caching._lastKeyframeIndex=-1,this._caching.lastIndex=0),1===this.keyframes.length?"multidimensional"===this.propType?this.pv=this.keyframes[0].s:this.pv=this.keyframes[0].s[0]:this.pv=this.interpolateValue(t,this._caching),this.mult)&&1!=this.mult)if("unidimensional"==this.propType)this.pv*=this.mult;else for(var s=0;s<this.pv.length;s++)this.pv[s]*=this.mult;return this._caching.lastTime=t,this.pv}function e(t){var e=t.mult;this.propType="unidimensional",this.keyframes=t.k,this.offsetTime=0,this.frameId=-1,this._caching={lastTime:l,lastIndex:0,value:0,_lastKeyframeIndex:-1},this.k=!0,this.kf=!0,this.data=t,this.mult=e||1,this.v=l,this.pv=l,this._isFirstFrame=!0,this.interpolateValue=c,this.getValueAtTime=d.bind(this)}function i(t){for(var e,i,s,a,r=t.mult,n=(this.propType="multidimensional",t.k.length),o=0;o<n-1;o+=1)t.k[o].to&&!t.k[o].ti&&(t.k[o].ti=[0,0,0]),!t.k[o].to&&t.k[o].ti&&(t.k[o].to=[0,0,0]),null!=(e=t.k[o].to)&&e.every(t=>0===t)&&null!=(e=t.k[o].ti)&&e.every(t=>0===t)&&(t.k[o].to=null,t.k[o].ti=null),t.k[o].to&&t.k[o].s&&t.k[o+1]&&t.k[o+1].s&&(e=t.k[o].s,i=t.k[o+1].s,s=t.k[o].to,a=t.k[o].ti,(2===e.length&&(e[0]!==i[0]||e[1]!==i[1])&&R.pointOnLine2D(e[0],e[1],i[0],i[1],e[0]+s[0],e[1]+s[1])&&R.pointOnLine2D(e[0],e[1],i[0],i[1],i[0]+a[0],i[1]+a[1])||3===e.length&&(e[0]!==i[0]||e[1]!==i[1]||e[2]!==i[2])&&R.pointOnLine3D(e[0],e[1],e[2],i[0],i[1],i[2],e[0]+s[0],e[1]+s[1],e[2]+s[2])&&R.pointOnLine3D(e[0],e[1],e[2],i[0],i[1],i[2],i[0]+a[0],i[1]+a[1],i[2]+a[2]))&&(t.k[o].to=null,t.k[o].ti=null),e[0]===i[0])&&e[1]===i[1]&&0===s[0]&&0===s[1]&&0===a[0]&&0===a[1]&&(2===e.length||e[2]===i[2]&&0===s[2]&&0===a[2])&&(t.k[o].to=null,t.k[o].ti=null);this.getValueAtTime=d.bind(this),this.data=t,this.keyframes=t.k,this.offsetTime=0,this.k=!0,this.kf=!0,this._isFirstFrame=!0,this.mult=r||1,this.interpolateValue=c,this.frameId=-1;var h=t.k[0].s.length;for(this.v=V("float32",h),this.pv=V("float32",h),o=0;o<h;o+=1)this.v[o]=l,this.pv[o]=l;this._caching={lastTime:l,lastIndex:0,value:V("float32",h)}}return{getProp:function(t){return t=new(1==t.k[0].s.length?e:i)(t)}}}(),D.ShapePropertyFactory=function(){var a=-999999;function e(t,e,i){var s,a,r,n,o,h,l,c=i.lastIndex,d=this.keyframes;if(t<d[0].t-this.offsetTime)s=d[0].s[0],a=!0,c=0;else if(t>=d[d.length-1].t-this.offsetTime)s=(d[d.length-1].s?d[d.length-1].s:d[d.length-2].e)[0],a=!0;else{for(var u,p,m,f,g,v=c,y=d.length-1,x=!0;x&&(u=d[v],!((p=d[v+1]).t-this.offsetTime>t));)v<y-1?v+=1:x=!1;c=v,(a=1===u.h)||(f=t>=p.t-this.offsetTime?1:t<u.t-this.offsetTime?0:(u.__fnct?m=u.__fnct:(m=D.BezierFactory.getBezierEasing(u.o.x,u.o.y,u.i.x,u.i.y).get,u.__fnct=m),m((t-(u.t-this.offsetTime))/(p.t-this.offsetTime-(u.t-this.offsetTime)))),g=(p.s||u.e)[0]),s=u.s[0]}for(o=e._length,h=s.i[0].length,i.lastIndex=c,r=0;r<o;r+=1)for(n=0;n<h;n+=1)l=a?s.i[r][n]:s.i[r][n]+(g.i[r][n]-s.i[r][n])*f,e.i[r][n]=l,l=a?s.o[r][n]:s.o[r][n]+(g.o[r][n]-s.o[r][n])*f,e.o[r][n]=l,l=a?s.v[r][n]:s.v[r][n]+(g.v[r][n]-s.v[r][n])*f,e.v[r][n]=l;e.v.splice(o),e.i.splice(o),e.o.splice(o)}var t=function(t,e,i){var s=0,a=t,r=b(a);return{newElement:function(){var t;t=s?r[--s]:e();return t},release:function(t){s===a&&(r=pooling.double(r),a*=2);i&&i(t);r[s]=t,s+=1}}},n=t(8,function(){return V("float32",2)});function h(){this.c=!1,this._length=0,this._maxLength=8,this.v=b(this._maxLength),this.o=b(this._maxLength),this.i=b(this._maxLength)}h.prototype.setPathData=function(t,e){this.c=t,this.setLength(e);for(var i=0;i<e;)this.v[i]=n.newElement(),this.o[i]=n.newElement(),this.i[i]=n.newElement(),i+=1},h.prototype.setLength=function(t){for(;this._maxLength<t;)this.doubleArrayLength();this._length=t},h.prototype.doubleArrayLength=function(){this.v=this.v.concat(b(this._maxLength)),this.i=this.i.concat(b(this._maxLength)),this.o=this.o.concat(b(this._maxLength)),this._maxLength*=2},h.prototype.setXYAt=function(t,e,i,s,a){var r;switch(this._length=Math.max(this._length,s+1),this._length>=this._maxLength&&this.doubleArrayLength(),i){case"v":r=this.v;break;case"i":r=this.i;break;case"o":r=this.o;break;default:r=[]}r[s]&&(!r[s]||a)||(r[s]=n.newElement()),r[s][0]=t,r[s][1]=e},h.prototype.setTripleAt=function(t,e,i,s,a,r,n,o){this.setXYAt(t,e,"v",n,o),this.setXYAt(i,s,"o",n,o),this.setXYAt(a,r,"i",n,o)},h.prototype.reverse=function(){for(var t=new h,e=(t.setPathData(this.c,this._length),this.v),i=this.o,s=this.i,a=0,r=(this.c&&(t.setTripleAt(e[0][0],e[0][1],s[0][0],s[0][1],i[0][0],i[0][1],0,!1),a=1),this._length-1),n=this._length,o=a;o<n;o+=1)t.setTripleAt(e[r][0],e[r][1],s[r][0],s[r][1],i[r][0],i[r][1],o,!1),--r;return t};(r=t(4,function(){return new h},function(t){for(var e=t._length,i=0;i<e;i+=1)n.release(t.v[i]),n.release(t.i[i]),n.release(t.o[i]),t.v[i]=null,t.i[i]=null,t.o[i]=null;t._length=0,t.c=!1})).clone=function(t){var e,i=r.newElement(),s=void 0===t._length?t.v.length:t._length;for(i.setLength(s),i.c=t.c,e=0;e<s;e+=1)i.setTripleAt(t.v[e][0],t.v[e][1],t.o[e][0],t.o[e][1],t.i[e][0],t.i[e][1],e);return i};var r,i=r;function s(t){this.propType="shape",this.keyframes=t.k,this.c=t.c,this.k=!0,this.kf=!0;t=this.keyframes[0].s[0].i.length;this.offsetTime=0,this.v=i.newElement(),this.v.setPathData(this.c,t),this.pv=i.clone(this.v),this.lastTime=a,this._caching={lastTime:a,lastIndex:0},this.interpolateShape=e,this.getValueAtTime=function(t){var t=t-this.offsetTime,e=this.keyframes[0].t-this.offsetTime,i=this.keyframes[this.keyframes.length-1].t-this.offsetTime,s=this._caching.lastTime;return s!==a&&(s<e&&t<e||i<s&&i<t)||(this._caching.lastIndex=s<t?this._caching.lastIndex:0,this.interpolateShape(t,this.pv,this._caching)),this._caching.lastTime=t,this.pv}.bind(this)}s.prototype.interpolateShape=e;t={getShapeProp:function(t){return new s(t)}};return t}();let u={Rectangle:"rectangle",Ellipse:"ellipse",Polystar:"polystar",Path:"path",TrimPath:"trimpath",MergePath:"mergepath"},w={Solid:0,LinearGradient:1,RadialGradient:2},x={Percent:1,Index:2},p={Char:1,CharWithoutSpace:2,Word:3,Line:4},m={Top:0,Center:1,Bottom:2};function _(){this.children=[],this.stbyMesh=null,this.start=this.s,this.end=this.e,this.isTranformApplied=!1,this.displayStat=0,this.eff||(this.eff=[]),this.tr&&(this.tr.p||void 0!==this.tr.px&&void 0!==this.tr.py||(this.tr.p=[0,0,0]),this.tr.s=this.tr.s||[1,1,1],this.tr.o=this.tr.o||[0,0,0],this.tr.an=this.tr.an||[0,0,0],this.tr.rx=this.tr.rx||0,this.tr.ry=this.tr.ry||0,this.tr.rz=this.tr.rz||0,this.tr.a=this.tr.a||1),this.error="",this.isInScene=!1,this.mesh=null,this.obj3D=null,this.addToScene=function(){["HTMLWidget","Widget"].includes(this.ty)&&this.obj3D.parent||(null!=this.parent?this.parent.mesh:this.comp.cameraObj.isDefaultCam||this.is3d?this.comp.scene:this.comp.camera.screenObj).add(this.obj3D)},this.removeFromScene=function(){for(var t=0;t<this.children.length;t++)this.children[t].removeFromScene();null!=this.obj3D&&null!=this.obj3D.parent&&this.obj3D.parent.remove(this.obj3D),void 0!==this.element&&null!==this.element.parentNode&&this.element.parentNode.remove()},this.hideLayer=function(t){this.element&&(this.element.style.display="none")},this.showLayer=function(t){this.element&&(this.element.style.display="block")},this.getEaliestStart=function(){for(var t=this.start,e=0;e<this.children.length;e++){var i=this.children[e].getEaliestStart();i<t&&(t=i)}return t},this.getLatestEnd=function(){for(var t=this.end,e=0;e<this.children.length;e++){var i=this.children[e].getLatestEnd();t<i&&(t=i)}return t},this.update=function(t,e){t>=this.sceneStart&&t<=this.sceneEnd?this.isInScene=!0:this.isInScene=!1,t>=this.start&&t<=this.end?this.displayStat=1:this.displayStat=0,this.sceneStart<this.start&&t>=this.sceneStart&&t<this.start&&this.comp.lastTime<this.sceneStart?(this.hideLayer(t),this.addToScene(t),this.isInScene=!0,this.shouldInit=!0):t>=this.start&&t<=this.end&&this.comp.lastTime<this.start?(this.showLayer(t),null!=this.obj3D.parent&&!["HTMLWidget","Widget"].includes(this.ty)||(this.addToScene(t),this.shouldInit=!0),"Video"!==this.ty&&"Audio"!==this.ty||e||this.play(t)):this.sceneEnd>this.end&&t>this.end&&this.comp.lastTime<=this.end&&t<=this.sceneEnd?(this.displayStat=1,this.hideLayer(),"Video"!==this.ty&&"Audio"!==this.ty||this.pause(t)):this.sceneEnd===this.end&&t>this.end&&this.comp.lastTime<=this.end?(this.displayStat=2,this.removeFromScene(),"Video"!==this.ty&&"Audio"!==this.ty||this.pause(t),this.isInScene=!1):this.sceneEnd>this.end&&t>this.sceneEnd&&this.comp.lastTime<=this.sceneEnd&&(this.removeFromScene(),this.showLayer()),this.isInScene&&(this.updateProperties&&this.updateProperties(t/1e3),!this.tr.isPropertiesUpdated()&&this.isTranformApplied||(this.isTranformApplied=!0,this.applyLayerTransform()));for(var i=0;i<this.children.length;i++)this.children[i].update(t,this.shouldInit);this.shouldInit=!1},this.init=function(){this.shouldInit=!0},this.applyLayerTransform=function(){var t,e,i,s=this.tr;s.p?([t,e,i]=s.p,this.obj3D.position.set(t,-e,-i)):this.obj3D.position.set(s.px,-s.py,-s.pz||0),this.obj3D.rotation.set(s.o[0],-s.o[1],-s.o[2]),0!==s.rx&&this.obj3D.rotateX(s.rx),0!==s.ry&&this.obj3D.rotateY(-s.ry),0!==s.rz&&this.obj3D.rotateZ(-s.rz),this.mesh.position.x=-s.an[0],this.mesh.position.y=s.an[1],this.mesh.position.z=s.an[2],this.obj3D.scale.set(s.s[0],s.s[1],s.s[2])},this.stop=function(t){"Video"!==this.ty&&"Audio"!==this.ty||this.pause(t),this.removeFromScene(),this.displayStat=0,this.isInScene=!1,this.drawTime=-1,this.showLayer()}}let h={Mask:"mask",Shadow:"shadow",Fill:"fill",BoxBlur:"boxBlur",ColorOverlay:"colOver",TrkMatte:"trkmatte"},H={HorizontalAndVertical:1,Horizontal:2,Vertical:3};function l(t,e){this.inCan=t,this.outCan=e,this.inCtx=null==(t=this.inCan)?void 0:t.getContext("2d"),this.outCtx=null==(e=this.outCan)?void 0:e.getContext("2d"),this.csm=window.devicePixelRatio,this.initEffectCanvas=function(){this.inCan&&(this.outCan.width=this.inCan.width,this.outCan.height=this.inCan.height,this.outCan.style.cssText=this.inCan.style.cssText,this.outCtx.resetTransform(),this.outCtx.translate(this.outCan.width/2,this.outCan.height/2),this.outCtx.scale(this.csm,this.csm),this.outCtx.save())},this.initEffectCanvas(),this.isUpdated=function(){return!!this.isSpecificPropertyUpdated_||!!this.isPropertiesUpdated&&this.isPropertiesUpdated()},this.effectPointWorldToLocal=function(t,e){t=new THREE.Vector3(t,e,0),e=this.parent,t=e.mesh.worldToLocal(t);return e.x&&(t.x-=e.x),e.y&&(t.y-=e.y),t.y=-t.y,t},this.getExtraOffsets=function(){return{wx:0,hx:0}},this.effectDrawInCantoOutCan=function(){var t=this;t.outCtx.save(),t.outCtx.scale(1/t.parent.csm,1/t.parent.csm),t.outCtx.clearRect(-t.outCan.width/2,-t.outCan.height/2,t.outCan.width,t.outCan.height),t.outCtx.drawImage(t.inCan,-t.outCan.width/2,-t.outCan.height/2,t.outCan.width,t.outCan.height),t.outCtx.restore()}}let M=["","butt","round","square"],k=["","miter","round","bevel"];function C(t,e){t.beginPath(),t.moveTo(e.v[0][0],e.v[0][1]);for(var i=0,s=1;s<e.v.length&&e.v[s];s++){i=s;try{t.bezierCurveTo(e.v[s-1][0]+e.o[s-1][0],e.v[s-1][1]+e.o[s-1][1],e.v[s][0]+e.i[s][0],e.v[s][1]+e.i[s][1],e.v[s][0],e.v[s][1])}catch(t){}}e.c&&(s=i,t.bezierCurveTo(e.v[s][0]+e.o[s][0],e.v[s][1]+e.o[s][1],e.v[0][0]+e.i[0][0],e.v[0][1]+e.i[0][1],e.v[0][0],e.v[0][1]),t.closePath())}function S(t,e){e.fillStyle=E(t,e),e.globalAlpha=e.globalAlpha*t.a}function P(t,e){e.lineWidth=t.w,t.dashes&&(e.setLineDash(t.dashes.pattern.map(t=>t.value)),e.lineDashOffset=t.dashes.offset),e.lineCap=M[t.lc||1],e.lineJoin=k[t.lj||1],e.strokeStyle=E(t,e),e.globalAlpha=e.globalAlpha*t.a}function E(t,e){let{c:i,cs:s,e:[a,r]=[],s:[n,o]=[],hl:h=[],ha:l=[]}=t.o;t=t.t;switch(t){case w.Solid:return z(i);case w.LinearGradient:var c=e.createLinearGradient(n,o,a,r);for(let{s:t,c:e,a:i}of s)c.addColorStop(t,O(e,i));return c;case w.RadialGradient:var d=Math.atan2(r-o,a-n),u=Math.sqrt(Math.pow(a-n,2)+Math.pow(r-o,2)),p=n+u*h*Math.cos(d+l),d=o+u*h*Math.sin(d+l),m=e.createRadialGradient(p,d,0,n,o,u);for(let{s:t,c:e,a:i}of s)m.addColorStop(t,O(e,i));return m}}function z(t,e){e=e?255:1;return 3==t.length?"rgb("+parseInt(t[0]*e)+","+parseInt(t[1]*e)+","+parseInt(t[2]*e)+")":"rgba("+parseInt(t[0]*e)+","+parseInt(t[1]*e)+","+parseInt(t[2]*e)+","+t[3]+")"}function I(t){var e=document.createElement("canvas"),e=(e.width=t.canvas.width,e.height=t.canvas.height,e.getContext("2d"));return e.setTransform(t.getTransform()),e}function O(t,e){var i;return e<1?-1!=t.indexOf("#")?(i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),"rgba("+parseInt(i[1],16)+","+parseInt(i[2],16)+","+parseInt(i[3],16)+","+e+")"):t.replace(/[\d\.]+\)$/g,e+")"):t}function A(t,e){l.call(this,t,e),this.outCan=e,this.isUpdated=function(){return this.masks.some(t=>t.isPropertiesUpdated())},this.drawOnCanvas=function(){this.effectDrawInCantoOutCan(),L(this.masks,this.outCan,this.outCtx,this.parent)}}function L(t,e,i,s){var a=1/s.csm,r=document.createElement("canvas"),n=(r.width=e.width*a,r.height=e.height*a,r.getContext("2d")),o=r.width/2-s.x,h=r.height/2+s.y;n.translate(o,h);for(var l=0;l<t.length;l++){n.save();var c=t[l],d=(n.globalAlpha=c.a,0===l&&2===c.c&&n.fillRect(-o,-h,r.width,r.height),(c.fy[0]+c.fy[1])/2);switch(0==d||(n.translate(-4*r.width,0),n.shadowColor="#000",n.shadowOffsetX=4*r.width,n.shadowBlur=d),C(n,c.path),n.fillStyle="#000",c.c){case 2:n.globalCompositeOperation="destination-out";break;case 3:n.globalCompositeOperation="destination-in";break;case 4:n.globalCompositeOperation="lighter"}n.fill(),n.restore()}i.save(),i.globalCompositeOperation="destination-in",i.drawImage(r,-r.width/2,-r.height/2,r.width,r.height),i.restore()}function F(t,e){l.call(this,t,e),this.a=this.a||1,this.d=this.d||0,this.n=this.n||0,this.b=this.b||0,this.updateSpecific=function(){var{d:t,n:e,b:i}=this,s=-Math.cos(e)*t,e=Math.sin(e)*t,{x:t,y:a}=this.effectPointWorldToLocal(s,e),{x:r,y:n}=this.effectPointWorldToLocal(0,0),t=t-r,r=n-a,n=Math.sqrt(Math.pow(t,2)+Math.pow(r,2))/Math.sqrt(Math.pow(s,2)+Math.pow(e,2))||1;this.isSpecificPropertyUpdated_=t!==this.offsetX||r!==this.offsetY||i*n!==this.blur,this.offsetX=t,this.offsetY=r,this.blur=i*n},this.getExtraOffsets=function(){return{wx:Math.abs(this.offsetX)+this.blur,hx:Math.abs(this.offsetY)+this.blur}},this.drawOnCanvas=function(){var{outCan:t,outCtx:e,parent:{csm:i},blur:s,a,c:r,offsetX:n,offsetY:o}=this;e.save(),e.scale(1/i,1/i),e.clearRect(-t.width/2,-t.height/2,t.width,t.height),e.restore(),e.shadowColor=`rgba(${[r.slice(0,3),a].join(",")})`,e.shadowOffsetX=n*i,e.shadowOffsetY=o*i,e.shadowBlur=s*i,this.effectDrawInCantoOutCan(),e.restore()},this.drawOnHtml=function(t){var{b:e,a:i,c:s,d:a,n:r}=this,r=[(-Math.cos(r)*a).toFixed(1)+"px",(Math.sin(r)*a).toFixed(1)+"px",e.toFixed(1)+"px "+`rgba(${[s.slice(0,3),i].join(",")})`].join(" ");t.style.filter="drop-shadow("+r+")",t.style.overflow="visible",t.style.filter||(t.style.textShadow=r)}}function j(t,o){l.call(this,t,o),this.drawOnCanvas=function(){var{inCan:t,outCan:e,outCtx:i,parent:{csm:s},a,c:r,inv:n}=this;i.save(),i.scale(1/s,1/s),i.clearRect(-e.width/2,-e.height/2,e.width,e.height),i.drawImage(t,-e.width/2,-e.height/2,e.width,e.height),i.fillStyle=`rgb(${r.slice(0,3).join(",")})`,i.globalAlpha=a,i.globalCompositeOperation=n?"source-out":"source-in",i.fillRect(-o.width/2,-o.height/2,o.width,o.height),i.restore()}}function N(t,n){l.call(this,t,n),this.drawOnCanvas=function(){var{inCan:t,outCan:e,outCtx:i,parent:{csm:s},a,c:r}=this;i.save(),i.scale(1/s,1/s),i.clearRect(-e.width/2,-e.height/2,e.width,e.height),i.drawImage(t,-e.width/2,-e.height/2,e.width,e.height),i.fillStyle=`rgb(${r.slice(0,3).join(",")})`,i.globalAlpha=a,i.globalCompositeOperation="source-in",i.fillRect(-n.width/2,-n.height/2,n.width,n.height),a<1&&(i.globalCompositeOperation="lighter",i.globalAlpha=1-a,i.drawImage(t,-e.width/2,-e.height/2,e.width,e.height)),i.restore()}}function W(t,e){l.call(this,t,e),this.getExtraOffsets=function(){var{r:t,dim:e,it:i=1}=this;return{wx:(4-e&H.Horizontal?Math.round(t):0)*i,hx:(4-e&H.Vertical?Math.round(t):0)*i}},this.drawOnCanvas=function(){let{r:t,dim:e,it:i=1,parent:{csm:s},outCtx:a}=this;t=Array.isArray(t)?t[0]:t;var n=4-e&H.Horizontal?Math.round(t):0,o=4-e&H.Vertical?Math.round(t):0;if(isNaN(t)||t<1)this.effectDrawInCantoOutCan();else{var r=document.createElement("canvas"),h=(r.width=this.inCan.width/s,r.height=this.inCan.height/s,r.getContext("2d")),l=r.width,c=r.height,d=2*n+1,u=2*o+1;h.drawImage(this.inCan,0,0,l,c),isNaN(i)&&(i=1),(i=3<(i|=0)?3:i)<1&&(i=1),i=3;for(let t=0;t<i;t++){let a=h.getImageData(0,0,l,c)["data"];var p=h.createImageData(l,c);let r=t=>[255/t,255/t,255/t,0];function m(t,e,i=a){var s;return t<0||e<0||l<=t||c<=e?r(1):([t,e,i,s]=i.slice(i=4*(t*l+e),4+i),[t,e,i,s])}var f=[];for(let i=0;i<l;i++){f[i]=[];for(let e=0;e<c;e++)if(0===e){var g=[0,0,0,0];for(let t=-n;t<=n;t++){var[v,y,x,w]=m(i,e-t);g[0]+=v,g[1]+=y,g[2]+=x,g[3]+=w}f[i][e]=[g[0]/d,g[1]/d,g[2]/d,g[3]/d]}else{var[_,b,M,T]=f[i][e-1],[k,C,S,P]=m(i,e-n-1),[E,z,I,O]=m(i,e+n);f[i][e]=[_+(E-k)/d,b+(z-C)/d,M+(I-S)/d,T+(O-P)/d]}}for(let i=0;i<c;i++)for(let e=0;e<l;e++){var A=4*(e*l+i),L=(e,[0,0,0,0]);for(let t=-o;t<=o;t++)try{var[F,j,D,V]=e+t<0||e+t>=l?r(d):f[e+t][i];L[0]+=F,L[1]+=j,L[2]+=D,L[3]+=V}catch(t){}p.data[A]=L[0]/u,p.data[1+A]=L[1]/u,p.data[2+A]=L[2]/u,p.data[3+A]=L[3]/u}h.putImageData(p,0,0)}a.clearRect(-l/2,-c/2,l,c),a.drawImage(r,-l/2,-c/2,l,c)}}}let c=["source-over","source-in","source-out","source-atop","destination-over","destination-in","destination-out","destination-atop","lighter","darker","copy","xor"];function q(t,e){l.call(this,t,e),this.mat=new THREE.Matrix4,this.c={x:0,y:0,rz:0,sx:1,sy:1,alphaUpdated:1,a:this.tm.tr.a};let n=this,i=this.isUpdated.bind(this),s=!1;this.isUpdated=function(){var t=s;return s=n.tm.contentNeedRedraw(),i()||t},this.updateSpecific=function(){var t=n,e=new THREE.Matrix4,e=(e.getInverse(t.parent.mesh.matrixWorld),t.mat.multiplyMatrices(e,t.tm.mesh.matrixWorld),new THREE.Vector3),i=new THREE.Quaternion,s=new THREE.Vector3,i=(t.mat.decompose(e,i,s),i.normalize(),this.tm.mesh.matrixWorld),i=Math.atan2(i.get(1,0),i.get(0,0)),e={x:e.x,y:e.y,rz:i,sx:s.x,sy:s.y,a:t.tm.tr.a};this.isSpecificPropertyUpdated_=!T.deepEqual(e,this.c),this.c=e},this.drawOnCanvas=function(){var t=n,e=(t.tm.calculateLayerSizeAndShiftAndUpdateLayer(),t.outCtx),i=t.outCan;if(e.save(),e.scale(1/t.parent.csm,1/t.parent.csm),e.clearRect(-i.width/2,-i.height/2,i.width,i.height),e.drawImage(t.inCan,-i.width/2,-i.height/2,i.width,i.height),e.restore(),e.save(),e.transform(1,0,0,1,-t.parent.x,t.parent.y),e.transform(1,0,0,1,t.c.x,-t.c.y),e.rotate(t.c.rz),e.scale(t.c.sx,t.c.sy),e.translate(t.tm.x,-t.tm.y),5==t.tmt||6==t.tmt)e.globalCompositeOperation=c[t.tmt];else{for(var i=t.tm.outCan.getContext("2d"),s=i.getImageData(0,0,t.tm.outCan.width,t.tm.outCan.height),a=s.data,r=0;r<a.length;r+=4)a[r+3]=(a[r]+a[r+1]+a[r+2])/3;i.putImageData(s,0,0),8==t.tmt?e.globalCompositeOperation=c[5]:9==t.tmt&&(e.globalCompositeOperation=c[6])}e.globalAlpha=t.c.a,e.scale(1/t.parent.csm,1/t.parent.csm),e.drawImage(t.tm.outCan,-t.tm.outCan.width/2,-t.tm.outCan.height/2,t.tm.outCan.width,t.tm.outCan.height),e.restore()}}let X=["Null","Audio","Camera"],Y=["shadow"],$=["Image","Video","Text","Html"];function d(){let e=this;_.call(this),this.eff=this.eff||[],this.masks=this.masks||[],this.isHtml=Z(this),this.calculateLayerSizeAndShiftAndUpdateLayer=function(){var t,e,i,s,a=this,{x:r,y:n,w:o,h,wx:l,hx:c}=a;a.w=0,a.h=0,a.x=0,a.y=0,a.wx=0,a.hx=0;for(e of a.eff)e.getExtraOffsets&&({wx:i,hx:s}=e.getExtraOffsets(),a.wx+=Math.abs(2*i)||0,a.hx+=Math.abs(2*s)||0);null!=(t=a.updateLayerBoundaries)&&t.call(a),a.x===r&&a.y===n&&a.w===o&&a.h===h&&a.hx===c&&a.wx===l||this.initContentCanvasSizeAndCtxAndLayerCSS()},this.initContentCanvasSizeAndCtxAndLayerCSS=function(){var t,e,i;this.isHtml||(this.canvas.width=(this.w+this.wx)*this.csm,this.canvas.height=(this.h+this.hx)*this.csm,t=this.canvas.width/this.csm,e=this.canvas.height/this.csm,this.canvas.style.cssText="position:absolute;width:"+t+"px;height:"+e+"px;",this.ctx=this.canvas.getContext("2d"),this.ctx.translate(this.canvas.width/2,this.canvas.height/2),this.ctx.scale(this.csm,this.csm),this.ctx.save()),this.element.style.width=(this.isHtml?this.w:t)+"px",this.element.style.height=(this.isHtml?this.h:e)+"px",this.subElm.style.cssText="position:absolute;width:"+(this.isHtml?this.w:t)+"px;height:"+(this.isHtml?this.h:e)+"px;left:"+this.x+"px;top:"+-this.y+"px;pointer-events:auto;touch-action:auto",adParams.drawDebugBoxes&&(this.subElm.style.outline="2px solid #8eff00",this.subElm.style.outlineOffset="outline-offset:-1px",this.subElm.style.backgroundColor="#8eff0030",this.debugElm||(this.debugElm=document.createElement("div"),this.debugElm.style.cssText="display:block;position:absolute;padding: 2px;font-size: 14px;font-family:sans-serif",this.anchorPoint=document.createElement("div"),this.anchorPoint.style.cssText="display:block;position:absolute;width:6px;height:6px;border-radius:50%;background-color:#44aa00;transform:translate(-50%,-50%)",this.debugElm.innerText="Layer "+this.i,this.debugElm.appendChild(this.anchorPoint),this.element.appendChild(this.debugElm)),this.debugElm.style.left=this.x+"px",this.debugElm.style.top=-this.y+"px",this.anchorPoint.style.top=this.tr.an[0],this.anchorPoint.style.left=this.tr.an[1]);for(i of this.eff)i.initEffectCanvas&&i.initEffectCanvas()},this.isHtml||(this.csm=window.devicePixelRatio,this.canvas=document.createElement("canvas"),this.outCan=this.canvas),this.shouldInit=!1;var t,i,s=this;if(this.element=document.createElement("div"),this.subElm=document.createElement("div"),this.element.appendChild(this.subElm),this.calculateLayerSizeAndShiftAndUpdateLayer(),this.isHtml||void 0===this.is_tm&&this.subElm.appendChild(this.outCan),this.mesh=new THREE.CSS3DObject(this.element),this.mesh.is3d=this.is3d,this.element.attributes["data-zo"]=this.i,this.element.style.pointerEvents="none",this.element.style.touchAction="none",this.subElm.style.pointerEvents="auto",this.subElm.style.touchAction="auto",this.clk&&(this.subElm.style.cursor="pointer",this.subElm.onclick=function(t){if(s.clk)return T.click(s.clk,s.clkType,t),!1}),this.selected=!1,this.selected&&(this.subElm.style.border="1px solid yellow",this.subElm.style.backgroundColor="rgba(255,248,111,1)",t='<div class="position-point" style="z-index:999999999;position:absolute;width:2px;height:2px;background:green;left:'+this.w/2+"px;top:"+this.h/2+'px"></div>',t=t,i=document.createElement("template"),t=t.trim(),i.innerHTML=t,t=i.content.firstChild,this.element.appendChild(t)),this.obj3D=new THREE.Object3D,this.obj3D.add(this.mesh),this.drawTime=-1,0<this.masks.length&&(i={ty:"mask",masks:this.masks},this.eff.push(i)),void 0!==this.has_tm)for(let t=0;t<this.comp.l.length;t++)if(this.comp.l[t].i==this.has_tm){var a={ty:"trkmatte",tm:this.comp.l[t],tmt:this.tmt,t:1};this.eff.unshift(a),this.comp.l[t].tml=this;break}for(let t=0;t<this.eff.length;t++){(this.eff[t].parent=this).isHtml||(r=0===t?this.canvas:this.eff[t-1].outCan,this.outCan=document.createElement("canvas"),void 0===this.is_tm&&(this.subElm.removeChild(r),this.subElm.appendChild(this.outCan)));var r,n={[h.Mask]:A,[h.Shadow]:F,[h.Fill]:j,[h.ColorOverlay]:N,[h.BoxBlur]:W,[h.TrkMatte]:q}[this.eff[t].ty];n?n.call(this.eff[t],r,this.outCan):(delete this.eff[t],t--)}this.draw=function(e,t){if(X.indexOf(this.ty)<0)if(this.isHtml){if(1===this.displayStat){var i,s=!1;this.contentNeedRedraw(e)&&(this.drawTime=e,this.calculateLayerSizeAndShiftAndUpdateLayer(),this.drawContent(e),-1!=this.drawTime&&(s=!0),this.clk)&&T.isShowClickAreas()&&showClickableAreasNativeHtml&&showClickableAreasNativeHtml(this),this.mesh.element.style.opacity=this.tr.a;for(i of this.eff)i.updateSpecific&&i.updateSpecific(),(s||i.isUpdated(e))&&i.drawOnHtml(this.subElm)}}else{if(!this.isInScene)return;if(1===this.displayStat){var a=this.tr,r=(void 0===this.is_tm&&(this.mesh.element.style.opacity=a.a),-1);for(let t=0;t<this.eff.length;t++)this.eff[t].updateSpecific&&this.eff[t].updateSpecific();if(this.contentNeedRedraw(e))r=0;else for(let t=0;t<this.eff.length;t++)if(this.eff[t].isUpdated()){r=t+1;break}if(0<=r&&0<this.tr.a){if(void 0!==this.is_tm)for(let t=0;t<this.tml.eff.length;t++)"trkmatte"===this.tml.eff[t].ty&&(this.tml.eff[t].c.alphaUpdated*=-1);this.drawTime=e;for(let t=0;t<=this.eff.length;t++)0===t?(this.ctx.save(),this.ctx.resetTransform(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.restore(),this.calculateLayerSizeAndShiftAndUpdateLayer(),this.drawContent(e),this.clk&&T.isShowClickAreas()&&showClickableAreas&&showClickableAreas(this)):this.eff[t-1].drawOnCanvas()}}void 0!==this.tml&&this.tml.drawTime!==e&&this.tml.draw(e,!1)}if(void 0===t||!0===t)for(let t=0;t<this.children.length;t++)this.children[t].draw(e)},this.mute=function(t){"Video"===e.ty&&this.isVidPlayable()&&(this.vid.muted=t)},this.dispose=function(){},this.isVidPlayable=function(){return null!=this.vid&&this.vid.readyState>=HTMLMediaElement.HAVE_FUTURE_DATA}}function Z(t){if(["Precomp","HTMLWidget","Widget"].includes(t.ty))return!0;for(var e=0;e<t.eff.length;e++)if(Y.indexOf(t.eff[e].ty)<0)return!1;if(t.masks&&0<t.masks.length)return!1;if($.indexOf(t.ty)<0)return!1;if("Text"===t.ty)for(var i of t.text.txtObj.lines)for(var s of i.parts)if(0<s.strokeWidth)return!1;return!(t.is_tm||t.has_tm)}function J(t,e){d.call(this);var i=this;this.loaded=!1,this.loadFailed=!1,this.lastUpdateTime=-.5,this.extVol=1,this.vol=Math.pow(10,this.v/10),this.aud=document.createElement("audio"),this.aud.setAttribute("preload","auto"),this.aud.muted=!0,this.aud.preload="auto",this.aud.crossOrigin=T.crossOrigin,1===this.l&&(this.aud.loop=!0),this.aud.addEventListener("canplaythrough",function(){var t;!0!==i.loaded&&(this.pause(),.1<(t=(t=i.ls-i.ps)<=0?0:t)&&(this.currentTime=t),i.loaded=!0)},!1),this.aud.addEventListener("error",function(t){T.reportError("audio_layer_onerror"),i.loaded=!0,i.loadFailed=!0}),this.aud.src=this.url,this.aud.load(),T.isIos()&&this.aud.play(),this.update=function(t,e){e||(t>=this.start&&t<this.end?(this.isInScene=!0,this.displayStat=1):(this.isInScene=!1,this.displayStat=0),t>=this.start&&t<this.end&&this.lastUpdateTime<this.start?(this.shouldInit=!0,this.play(t)):t>=this.end&&this.lastUpdateTime<this.end&&this.pause(t),1===this.displayStat&&(this.vol=Math.pow(10,this.v/10),this.isAudPlayable())&&(e=this.vol*this.extVol,this.aud.volume!==(e=1<e?1:e))&&this.aud.volume,this.lastUpdateTime=t)},this.play=function(t){var e;this.isAudPlayable()&&(t<this.start?(this.aud.pause(),e=this.start/1e3-this.ps,this.aud.currentTime=(e=e<0?0:e)%this.aud.duration):((e=t/1e3-this.ps)<0&&(e=0),.2<Math.abs(this.aud.currentTime-e)&&(this.aud.currentTime=e%this.aud.duration),void 0!==(t=this.aud.play())&&t.then(function(){}).catch(function(t){})))},this.pause=function(t,e){this.isAudPlayable()&&this.aud.pause();var i=this.ls-this.ps;i<=0&&(i=0),(t>this.end||e)&&null!=this.aud&&.2<Math.abs(this.aud.currentTime-i)&&(this.aud.currentTime=i)},this.mute=function(t){this.isAudPlayable()&&(this.aud.muted=t)},this.vol=function(t){this.extVol=t;t=this.vol*this.extVol;1<t&&(t=1),this.isAudPlayable()&&(this.aud.volume=t)},this.draw=function(t){},this.stop=function(){this.displayStat=0,this.isInScene=!1},this.isLoaded=function(){return this.loaded},this.setRate=function(t){this.isAudPlayable()&&(this.aud.playbackRate=t)},this.isAudPlayable=function(){return null!=this.aud&&this.aud.readyState>=HTMLMediaElement.HAVE_FUTURE_DATA}}function Q(){d.call(this);var t,e,i=this;this.loaded=!1,this.isPosterLoaded=!1,this.loadFailed=!1,cp_.options&&cp_.options.optionalVideoSlot&&(this.vid=cp_.options.optionalVideoSlot,this.videoCanAutoplay=!!cp_.options.videoCanAutoplay),this.vid=this.vid||document.createElement("video"),this.volumeMultiplier=1;let{video:s,vid:a,start:r,subElm:n}=this;s.x=s.x||0,s.y=s.y||0,a.muted=cp_.isMute(),this.vidElmIsProxy=void 0===this.vid.removeAttribute,this.loadFootage=function(){var t,e;!i.vidElmIsProxy&&s.url&&((t=document.createElement("source")).src=s.url,t.type="video/mp4",(e=document.createElement("source")).src=s.url.replace(".mp4",".webm"),e.type="video/webm",a.appendChild(t),a.appendChild(e),a.load())},a.addEventListener("canplaythrough",function t(){i.loaded=!0,i.pause();var e=Math.max(0,r-s.ls)/1e3;.1<e&&(i.currentTime=e),a.removeEventListener("canplaythrough",t,!1)},!1),a.addEventListener("error",function(){T.reportError("video_layer_onerror"),i.loaded=!0,i.loadFailed=!0}),this.vidElmIsProxy?s.url?(this.vid.src=s.url,this.vid.load()):i.loaded=!0:(a.setAttribute("webkit-playsinline","webkit-playsinline"),a.setAttribute("playsinline","playsinline"),a.setAttribute("preload","auto"),a.preload="auto",a.crossOrigin=T.crossOrigin,a.loop=1===s.loop,!T.isVpaid()&&this.isHtml&&(a.style.width="100%",a.style.height="100%",n.appendChild(a)),s.url?(t=s.url.replace(/\.mp4$/,"_00001.jpg"),(e=new Image).onload=function(){i.isPosterLoaded=!0},e.src=t,a.poster=t,T.isIos()&&a.play()):i.loaded=!0,T.isVpaid()&&(a.style.opacity=0)),this.footageValidAndLoaded=function(){return!!s.url&&i.loaded&&!i.loadFailed&&null!=a};let o=this.addToScene.bind(this),h=(this.addToScene=function(){T.isVpaid()?this.vidElmIsProxy||(a.style.opacity=1):o()},this.removeFromScene.bind(this));this.removeFromScene=function(){T.isVpaid()?this.vidElmIsProxy||(a.style.opacity=0):h()},this.play=function(t){this.footageValidAndLoaded()&&(t<this.start?(this.vid.pause(),this.updateVideoTime(this.start)):(this.updateVideoTime(t),this.vid.play()))},this.pause=function(t,e){this.footageValidAndLoaded()&&(this.vid.pause(),t>this.end||e||null!=this.vid)&&this.updateVideoTime(t)},this.mute=function(t){this.footageValidAndLoaded()&&i.aEn&&(a.muted=t)},this.vol=function(t){this.footageValidAndLoaded()&&(i.volumeMultiplier=t)},this.updateVideoTime=function(t){t=Math.max(0,(t-s.ls)/1e3);.2<Math.abs(a.currentTime-t)&&(this.vidElmIsProxy?a.setAttribute("currentTime",t+.2):a.currentTime=t)},this.drawContent=function(t){var e;this.updateVideoTime(t),this.isHtml||i.ctx.drawImage(a,-.5*s.w,-.5*s.h,s.w,s.h),i.aEn&&s.al&&(t=(s.al[0]+s.al[1])/2,t=Math.pow(10,t/10),e=Math.min(1,t*i.volumeMultiplier),Math.abs(a.volume-e)/a.volume<.02||(a.volume=Math.min(1,t*i.volumeMultiplier)))},this.stop=function(){this.removeFromScene(),this.displayStat=0,this.isInScene=!1},this.isLoaded=function(t){return t?this.isPosterLoaded:this.loaded},this.setRate=function(t){this.footageValidAndLoaded()&&(this.vid.playbackRate=t)},this.contentNeedRedraw=function(){return!0},this.updateLayerBoundaries=function(){var t=this;t.w=t.video.w,t.h=t.video.h,t.x=t.w/2+t.video.x,t.y=-t.h/2-t.video.y,t.ctx_x_from_center=-t.x,t.ctx_y_from_center=t.y}}function K(){d.call(this);var t=!1;this.drawContent=function(){t=!0,this.subElm.innerHTML||FB.insertAndExecute(this.subElm,this.html)},this.isLoaded=function(){return!0},this.contentNeedRedraw=function(){return!t};let e=this.addToScene.bind(this);this.removeFromScene=function(){this.subElm.style.display="none"},this.addToScene=function(){e(),this.subElm.style.display="block"},this.updateLayerBoundaries=function(){let e=this;var{w:t,h:i}=window.movie.comps.find(({id:t})=>t===e.precomp.compId);e.w=t,e.h=i,e.x=t/2,e.y=-i/2}}function G(){var t,s=this,e=(d.call(this),this.image);function a(){return s.footage&&s.footage.url_&&s.footage.isLoaded&&!s.footage.loadFailed}e.ro=e.ro||5,e.bc=e.bc||"0a0a0a0",e.x=e.x||0,e.y=e.y||0,this.loadFootage=function(){e.url_&&(comp.footage[e.url_]||(comp.footage[e.url_]=new tt(e.url_)),this.footage=comp.footage[e.url_],this.img=this.footage.img)},e.url&&(this.footage={loaded:!1},3===e.ro||4===e.ro||5===e.ro&&T.isExtImg(e.url)||e.url.endsWith(".png")?(t=3,4===e.ro?t=1:3===e.ro&&(t=2),e.url_=T.getDynImgUrl(e.url,e.w,e.h,t,e.bc)):e.url_=e.url),this.isLoaded=function(){return!s.footage||s.footage.isLoaded},this.contentNeedRedraw=function(){return-1===this.drawTime},this.drawContent=function(){var t,e,i;s.isHtml?(i=(e=s).subElm,a()?0===i.innerHTML.length&&((t=new THREE.ImageLoader).crossOrigin=T.crossOrigin,(t=t.load(e.footage.url_,function(t){0===i.innerHTML.length&&i.appendChild(t)},null,null)).style.width=e.w+"px",t.style.height=e.h+"px",t.style.display="block",e.image.alt&&(t.alt=e.image.alt),e.image.w<e.w||e.image.h<e.h)&&(i.style.transform="translate("+(e.w-e.image.w)/2+"px,"+(e.h-e.image.h)/2+"px)"):e.drawTime=-1):(e=(t=s).ctx,0!==t.tr.a&&a()?e.drawImage(t.img,-.5*t.image.w,-.5*t.image.h,t.image.w,t.image.h):t.drawTime=-1)},this.updateLayerBoundaries=function(){var t=this;t.w=t.image.w,t.h=t.image.h,t.x=t.w/2+t.image.x,t.y=-t.h/2-t.image.y,t.ctx_x_from_center=-t.x,t.ctx_y_from_center=t.y}}function tt(t){this.url_=t,this.isLoaded=!1,this.loadFailed=!1;var e=this,t=new THREE.ImageLoader;t.crossOrigin=T.crossOrigin,this.img=t.load(this.url_,function(){e.isLoaded=!0},null,function(){e.loadFailed=!0,e.isLoaded=!0;T.reportError("footage_load_error")})}function et(){_.call(this),this.shouldInit=!1,this.mesh=new THREE.Object3D,this.obj3D=new THREE.Object3D,this.obj3D.add(this.mesh),this.isLoaded=function(){return!0},this.draw=function(t){if(this.isInScene)for(var e=0;e<this.children.length;e++)this.children[e].draw(t)}}function it(t){d.call(this),this.precomp.comp=Object.assign(Object.assign({},JSON.parse(JSON.stringify(movie.comps.find(({id:t})=>this.precomp.compId===t)))),{isPrecomp:!0}),t.call(this.precomp.comp);t=this.precomp.comp.renderer.domElement;this.subElm.appendChild(t),this.subElm.setAttribute("compId",this.precomp.compId),this.precomp.comp.renderer.setSize(this.precomp.comp.w,this.precomp.comp.h),this.drawContent=function(t){t=void 0===this.precomp.timeRemap?t-this.s:1e3*this.precomp.timeRemap;this.precomp.comp.drawFrame(t)},this.isLoaded=function(){return!this.precomp.comp.getFootageStatus().pending.length},this.contentNeedRedraw=function(){return!0},this.loadFootage=function(){this.precomp.comp.loadInitialFootages(),this.precomp.comp.loadAllFootages()},this.updateLayerBoundaries=function(){var{w:t,h:e}=this.precomp.comp||{};this.w=t,this.h=e,this.x=t/2,this.y=-e/2};let e=this.stop.bind(this);this.stop=function(t){e(t),this.precomp.comp.stop()}}function st(){var g=this;d.call(this);for(var t=0;t<this.shape.shapes.length;t++){var e=this.shape.shapes[t],i=this.shape.shapes[t].tr;i&&(i.p=i.p||[0,0],i.s=i.s||[1,1],i.sk=i.sk||0,i.skx=i.skx||0,i.r=i.r||0,i.an=i.an||[0,0],i.a=i.a||1),e.fill=e.fill||null,e.stroke=e.stroke||null}function l(t){t=s(t);return v.fromPath(t).reduce((t,e)=>t+e.getLength(),0)}function c(r,n,o,h){var l=s(r);if(o<.01&&.99<h)return g.createShapePath(n,r);if(!(o<.01&&h<.01||.99<o)){r=[l];var c=n;l=o;n=h;let t=r.map(v.fromPath),e=t.flat().reduce((t,e)=>t+e.getLength(),0),i=e*l,s=e*n,a=0;for(var d of t){c.beginPath(),c.moveTo(d[0].p0[0],d[0].p0[1]);for(var u of d){var p=u.getLength();if(a+p<=i)c.moveTo(u.p3[0],u.p3[1]);else if(a<i&&a+p>i){var m=(i-a)/p,f=Math.max(1,(s-a)/p),m=u.getValueAtLengthPercent(m),f=1===f?1:u.getValueAtLengthPercent(f);let t=u.getSubBezier(m,!0);f<1&&(f=m*t.getLength()/u.getLength(),t=u.getSubBezier(f));var{x:f,y:m}=u.getPointAtTime(m);c.moveTo(f,m),t.draw(c)}else{if(!(a+p<=s))return void(f=(s-a)/p,m=u.getValueAtLengthPercent(f),u.getSubBezier(m).draw(c));u.draw(c)}a+=p}}}}function s(m){switch(m.ty){case u.Ellipse:return v=(e=m).p[0],t=e.p[1],i=e.s[0],e=e.s[1],{i:[[-(i/=2)*(s=.55284),0],[0,-(e/=2)*s],[i*s,0],[0,e*s],[-i*s,0]],v:[[v,t-e],[v+i,t],[v,t+e],[v-i,t],[v,t-e]],o:[[i*s,0],[0,e*s],[-i*s,0],[0,-e*s],[i*s,0]]};case u.Polystar:{v=m;let e=1===v.type?2*Math.ceil(v.pts):v.pts,t=v.r,i=v.oRad,[s,a]=v.p,r=1===v.type?v.iRad:v.oRad,n=2*Math.PI/e,o=t-Math.PI/2,h=[],l=[],c=[],d={i:l,v:h,o:c,c:1},u=s+Math.cos(o)*i,p=a+Math.sin(o)*i;h.push([u,p]);for(let t=0;t<e;t++){var f=t%2?r:i,g=s+Math.cos(o)*f,f=a+Math.sin(o)*f;c.push([0,0]),l.push([0,0]),h.push([g,f]),u=g,p=f,o+=n}return c.push([0,0]),l.unshift([0,0]),d;return}case u.Rectangle:var t=m,{p:[e,i],s:[s,a]}=t;return{i:[[-(s=s/2),0],[0,-(a=a/2)],[s,0],[0,a],[-s,0]],v:[[e+s,i-a],[e+s,i+a],[e-s,i+a],[e-s,i-a],[e+s+((null==(e=t.stroke)?void 0:e.w)||0)/2,i-a]],o:[[0,a],[-s,0],[0,-a],[s,0],[0,a]]};case u.Path:return m.path}var v,t}this.isLoaded=function(){return!0},this.contentNeedRedraw=function(t){return-1===g.drawTime||g.shape.isPropertiesUpdated()},this.createShapePath=function(o,h){switch(h.ty){case"rectangle":{var l=o;var c=h;let{p:[t,e],s:[i,s],r:a}=c,r=i/2,n=s/2;l.beginPath(),0<a?(c=Math.min(i,s),a>.5*c&&(a=.5*c),l.moveTo(t+r-a,e-n),l.arcTo(t+r,e-n,t+r,e-n+a,a),l.lineTo(t+r,e+n-a),l.arcTo(t+r,e+n,t+r-a,e+n,a),l.lineTo(t-r+a,e+n),l.arcTo(t-r,e+n,t-r,e+n-a,a),l.lineTo(t-r,e-n+a),l.arcTo(t-r,e-n,t-r+a,e-n,a)):(l.moveTo(t-r,e-n),l.lineTo(t+r,e-n),l.lineTo(t+r,e+n),l.lineTo(t-r,e+n));l.closePath()}break;case"ellipse":c=o,t=(l=h).p[0],e=l.p[1],i=l.s[0],l=l.s[1],i/=2,l/=2,s=.55284,c.beginPath(),c.moveTo(t-i,e),c.bezierCurveTo(t-i,e-l*s,t-i*s,e-l,t,e-l),c.bezierCurveTo(t+i*s,e-l,t+i,e-l*s,t+i,e),c.bezierCurveTo(t+i,e+l*s,t+i*s,e+l,t,e+l),c.bezierCurveTo(t-i*s,e+l,t-i,e+l*s,t-i,e),c.closePath();break;case"polystar":s=h,(t=o).translate(s.p[0],s.p[1]),(1===s.type?function(t,e){var i,s,a=.35829,r=t.pts,n=t.r,o=t.oRad,h=t.oRo,l=t.iRad,c=t.iRo,d=(e.beginPath(),n),u=(d-=Math.PI/2,2*Math.PI/r),p=u/2,m=r-parseInt(r);0!=m&&(d+=p*(1-m));var f=0;0!=m?(i=(f=l+m*(o-l))*Math.cos(d),s=f*Math.sin(d),e.moveTo(i,s),d+=u*m/2):(i=o*Math.cos(d),s=o*Math.sin(d),e.moveTo(i,s),d+=p);for(var g=!1,v=parseInt(2*Math.ceil(r)),y=0;y<v;y++){var x,w,_,b,M,T=g?o:l,k=0!=f&&y==v-2?u*m/2:p,C=i,S=s;i=(T=0!=f&&y==v-1?f:T)*Math.cos(d),s=T*Math.sin(d),0==c&&0==h?e.lineTo(i,s):(T=Math.atan2(S,C)-Math.PI/2,w=Math.cos(T),T=Math.sin(T),x=Math.atan2(s,i)-Math.PI/2,b=Math.cos(x),x=Math.sin(x),w=(_=g?l:o)*(M=g?c:h)*a*w,_=_*M*a*T,b=(M=g?o:l)*(T=g?h:c)*a*b,M=M*T*a*x,0!=m&&(0==y?(w*=m,_*=m):y==v-1&&(b*=m,M*=m)),e.bezierCurveTo(C-w,S-_,i+b,s+M,i,s)),d+=k,g=!g}e.closePath()}:function(t,e){for(var i,s,a=t.pts,r=t.r,n=t.oRad,o=t.oRo,h=(e.beginPath(),r),l=(h-=Math.PI/2,2*Math.PI/a),c=(i=n*Math.cos(h),s=n*Math.sin(h),e.moveTo(i,s),h+=l,Math.ceil(a)),d=0;d<c;d++){var u,p,m,f,g=i,v=s;i=n*Math.cos(h),s=n*Math.sin(h),0!=o?(p=Math.atan2(v,g)-Math.PI/2,u=Math.cos(p),p=Math.sin(p),f=Math.atan2(s,i)-Math.PI/2,m=Math.cos(f),f=Math.sin(f),u=n*o*.3*u,p=n*o*.3*p,m=n*o*.3*m,f=n*o*.3*f,e.bezierCurveTo(g-u,v-p,i+m,s+f,i,s)):e.lineTo(i,s),h+=l}e.closePath()})(s,t);break;case"path":C(o,h.path)}var t,e,i,s},this.drawContent=function(){if(!g.clk){let t=g.ctx,e=null,i=0;for(var s=0;s<g.shape.shapes.length;s++){var a=g.shape.shapes[s];if(a.ty===u.TrimPath)2===(e=a).tpType&&(i=g.shape.shapes.slice(s+1).reduce((t,e)=>t+l(e),0));else if(0!==a.tr.a){t.save(),t.translate(this.ctx_x_from_center,this.ctx_y_from_center),h=o=n=r=void 0;var r=t,n=a;if(null!=(n=n.tr)&&(r.globalAlpha=n.a,o=Math.tan(n.sk),h=-o*Math.abs(Math.cos(n.skx)),o=o*Math.abs(Math.sin(n.skx)),r.translate(n.p[0],n.p[1]),r.rotate(n.r),r.transform(1,o,h,1,0,0),r.transform(n.s[0],0,0,n.s[1],0,0),r.translate(-n.an[0],-n.an[1])),e){if(1===e.tpType){if(e.s===e.e){t.restore();continue}c(a,t,e.s,e.e)}else if(2===e.tpType){var o=g.shape.shapes.slice(s+1).reduce((t,e)=>t+l(e),0),h=l(a),r=i*e.s,n=i*e.e,r=e.s<.01?0:Math.max(0,Math.min(1,(r-o)/h)),n=.99<e.e?1:Math.max(0,Math.min(1,(n-o)/h));if(r===n){t.restore();continue}c(a,t,r,n)}}else g.createShapePath(t,a);o=t.globalAlpha;null!=a.fill&&(S(a.fill,t),t.fill()),null!=a.stroke&&0<a.stroke.w&&(t.globalAlpha=o,P(a.stroke,t),a.stroke.align?1===a.stroke.align?(t.clip(),t.lineWidth=2*a.stroke.w,t.stroke()):2===a.stroke.align&&(h=I(t),g.createShapePath(h,a),P(a.stroke,h),h.lineWidth=2*a.stroke.w,h.stroke(),h.globalCompositeOperation="destination-out",h.fill(),r=t.getTransform(),t.resetTransform(),t.drawImage(h.canvas,0,0),t.setTransform(r)):t.stroke()),t.restore()}}}},this.getInitialEdgeVertices=function(t){let e,i=this.getShapeBoundaries(t);if(t.stroke&&!(t.stroke.w<=0)){var s=t.stroke.w;switch(null==(e=t.stroke)?void 0:e.align){case 1:break;case 2:a(s*Math.sqrt(2));break;default:a(s*Math.sqrt(2)/2)}}return i;function a(t){i.bottom+=t,i.top-=t,i.left-=t,i.right+=t}},this.getShapeBoundaries=function(e){var{p:[i,s]=[0,0],s:[a,r]=[0,0],ty:t}=e;switch(t){case u.Rectangle:case u.Ellipse:return{left:i-a/2,top:s-r/2,right:i+a/2,bottom:s+r/2};case u.Path:let{i:n,o,v:h,c:t}=e.path;var l=h.map(([t,e])=>({x:[t],y:[e]}));return t&&(c=[0,1].map(t=>{let i=h.length-1;var e=h[i],s=h[i].map((t,e)=>+t+ +o[i][e]),a=h[0].map((t,e)=>+t+ +n[0][e]),r=h[0];return new v(e,s,a,r).getBoundaries(t)}),l.push({x:c[0],y:c[1]})),l.push(...h.slice(1).map((t,r)=>{var e=[0,1].map(t=>{var e=h[r],i=h[r].map((t,e)=>+t+ +o[r][e]),s=h[r+1].map((t,e)=>+t+ +n[r][e]),a=h[r+1];return new v(e,i,s,a).getBoundaries(t)});return{x:e[0],y:e[1]}})),l.reduce(({left:t,right:e,top:i,bottom:s},{x:a,y:r})=>({left:Math.min(t,...a),right:Math.max(e,...a),top:Math.min(i,...r),bottom:Math.max(s,...r)}),{left:1/0,right:-1/0,top:1/0,bottom:-1/0});case u.Polystar:var{p:[c,l],oRad:d}=e;return{left:c-d,right:c+d,top:l-d,bottom:l+d};default:return{left:0,top:0,right:800,bottom:800}}},this.updateLayerBoundaries=function(){var t=this,e=t.shape.shapes.map(t=>{if("trimpath"===t.ty)return null;var{tr:{an:[e,i],p:[s,a]=[0,0],s:[r,n]=[0,0],r:o=0}}=t,{left:t,top:h,right:l,bottom:c}=this.getInitialEdgeVertices(t);let d=(new DOMMatrix).translateSelf(s,a).rotateSelf(0,0,o/Math.PI*180).skewXSelf(0).skewYSelf(0).scaleSelf(r,n).translateSelf(-e,-i);var[s,a,o,r]=[[h,t],[h,l],[c,t],[c,l]].map(([t,e])=>new DOMPoint(e,t).matrixTransform(d)),n=[s.x,a.x,o.x,r.x],e=[s.y,a.y,o.y,r.y];return{left:Math.min(...n),right:Math.max(...n),top:Math.min(...e),bottom:Math.max(...e)}}).filter(t=>!!t),i=Math.min(...e.map(t=>t.left)),s=Math.max(...e.map(t=>t.right)),a=Math.min(...e.map(t=>t.top)),e=Math.max(...e.map(t=>t.bottom));t.w=Math.ceil(s-i+20),t.h=Math.ceil(e-a+20),t.x=Math.floor(i+t.w/2-10),t.y=Math.floor(-a-t.h/2+10),t.ctx_x_from_center=-t.x,t.ctx_y_from_center=t.y}}class v{constructor(t,e,i,s){this.accuracy=100,this.lengthsArr=null,this.length=null,this.p0=t,this.p1=e,this.p2=i,this.p3=s}getValueAtTime(t,e){return Math.pow(1-t,3)*this.p0[e]+Math.pow(1-t,2)*t*3*this.p1[e]+(1-t)*Math.pow(t,2)*3*this.p2[e]+Math.pow(t,3)*this.p3[e]}getPointAtTime(t){return{x:this.getValueAtTime(t,0),y:this.getValueAtTime(t,1)}}getLength(){if(!this.length){this.lengthsArr||(this.lengthsArr=[]);let e=this.getPointAtTime(0);this.length=0;for(let t=1;t<=this.accuracy;t++){var i=t/this.accuracy,i=this.getPointAtTime(i),s=Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2));this.length+=s,this.lengthsArr.push(s),e=i}}return this.length}getValueAtLengthPercent(t){this.length&&this.lengthsArr||this.getLength();var i=this.length*t;let s=0;for(let e=0;e<this.accuracy;e++){var a=this.lengthsArr[e];if((s+=a)>=i){let t=(s-i)/a;return(e+t)/this.accuracy}}return 1}getCriticalPointsByDimension(t){var e=-3*this.p0[t]+9*this.p1[t]-9*this.p2[t]+3*this.p3[t],i=6*this.p0[t]-12*this.p1[t]+6*this.p2[t],s=-3*this.p0[t]+3*this.p1[t],a=(-i+Math.sqrt(Math.pow(i,2)-4*e*s))/2*e,i=(-i-Math.sqrt(Math.pow(i,2)-4*e*s))/2*e,s=[this.p0[t],this.p3[t]];return isNaN(a)||s.push(a),isNaN(a)||s.push(i),s}getCriticalPoints(){return{x:this.getCriticalPointsByDimension(0),y:this.getCriticalPointsByDimension(1)}}getSubBezierByDim(t,e,i){var s=(1-t)*this.p0[e]+t*this.p1[e],a=(1-t)*this.p1[e]+t*this.p2[e],r=(1-t)*this.p2[e]+t*this.p3[e],n=(1-t)*s+t*a,a=(1-t)*a+t*r,t=(1-t)*n+t*a;return i?[t,a,r,this.p3[e]]:[this.p0[e],s,n,t]}getSubBezier(t,e){var i=this.getSubBezierByDim(t,0,e),t=this.getSubBezierByDim(t,1,e);return new v([i[0],t[0]],[i[1],t[1]],[i[2],t[2]],[i[3],t[3]])}draw(t){t.bezierCurveTo(this.p1[0],this.p1[1],this.p2[0],this.p2[1],this.p3[0],this.p3[1])}getBoundaries(t){var e=-3*this.p0[t]+9*this.p1[t]+-9*this.p2[t]+3*this.p3[t],i=6*this.p0[t]-12*this.p1[t]+6*this.p2[t],s=-3*this.p0[t]+3*this.p1[t],a=(-i+Math.sqrt(Math.pow(i,2)-4*e*s))/(2*e),i=(-i-Math.sqrt(Math.pow(i,2)-4*e*s))/(2*e),s=this.getValueAtTime(Math.min(1,Math.max(0,a)),t),e=this.getValueAtTime(Math.min(1,Math.max(0,i)),t),a=[];return isNaN(s)||a.push(s),isNaN(e)||a.push(e),a}static fromPath(s){var t,e=s.v.slice(1).map(([t,e],i)=>new v(s.v[i],[s.o[i][0]+s.v[i][0],s.o[i][1]+s.v[i][1]],[s.i[i+1][0]+t,s.i[i+1][1]+e],[t,e]));return s.c&&(t=s.v.length-1,e.push(new v([s.v[t][0],s.v[t][1]],[s.v[t][0]+s.o[t][0],s.v[t][1]+s.o[t][1]],[s.v[0][0]+s.i[0][0],s.v[0][1]+s.i[0][1]],[s.v[0][0],s.v[0][1]]))),e}}let at=["alphabetic","top","hanging","middle","ideographic","bottom"];function rt(){var b=this,e=(d.call(this),cp_.containerDiv.ownerDocument);let M=/[\u4E00-\u9FFF]/;b.isHtml||(e=document);var y=!1;function u(t){var e,i;for(e of t.parts.map(t=>t.text).join(""))if(/\p{L}/u.test(e))return i=e,/^[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF]$/.test(i);return!1}function o(e,i){for(let t=0;t<e.parts.length;t++){var s=e.parts[t];s.w_*=i,s.size_use*=i,s.font_=T.getCtxFont(s.style,s.weight,s.size_use,s.family),s.x_*=i,s.y_*=i}e.h_*=i,e.w_*=i}T.loadFonts(b.text.txtObj.fonts),b.text.aeSrcTxt.isBoxText=null!=b.text.aeSrcTxt.boxTxtS,this.isLoaded=function(){if(e.fonts&&e.fonts.load){for(var t of b.text.txtObj.fonts){t=T.getCtxFont(t.italic,t.weight,10,t.family);if(!e.fonts.check(t))return e.fonts.load(t),!1}return y=!0}return!1},this.contentNeedRedraw=function(){return-1===b.drawTime||!!b.text.isPropertiesUpdated&&b.text.isPropertiesUpdated()},this.drawContent=function(){var t=b,e=t.subElm;e.style.webkitFontSmoothing="antialiased",t.isHtml||(t.ctx.save(),t.ctx.translate(t.ctx_x_from_center,t.ctx_y_from_center));try{var i,s=t,a=t.ctx,r=e,n=s.text["linesToDraw"],o=Math.max(...n.map(t=>t.h_));s.isHtml?i="":a.textBaseline=at[0],adParams.drawDebugBoxes&&(a?(a.rect(0,0,b.text.textBox.w,b.text.textBox.h),a.lineWidth=2,a.strokeStyle="#fab400",a.setLineDash([6,14]),a.stroke(),a.setLineDash([])):i+='<div style="position: absolute;width:'+b.text.textBox.w+"px;height:"+b.text.textBox.h+'px;outline: 2px dashed #fab400;outline-offset:-2px;"></div>');for(let t=0;t<n.length;t++){var h=n[t];for(let t=0;t<h.parts.length;t++){var l,c,d,u,p,m,style,f,g=h.parts[t],v=(+g.letterSpacing||0)*g.size_use/1e3;a?(v&&(a.canvas.style.letterSpacing=v+"px",l=a.getTransform(),(a=a.canvas.getContext("2d")).setTransform(l)),a.font=g.font_,a.fillStyle=g.color,g.strokeWidth&&(a.strokeStyle=g.strokeColor,a.lineWidth=g.strokeWidth),0<g.strokeWidth&&!g.strokeOverFill&&a.strokeText(g.text,g.drawX,g.drawY),a.fillText(g.text,g.drawX,g.drawY),0<g.strokeWidth&&g.strokeOverFill&&a.strokeText(g.text,g.drawX,g.drawY),g.strikeThrough&&a.fillRect(g.drawX,g.drawY-(.5*g.size_use+g.strikeThrough)/2,g.w_,g.strikeThrough)):(l=parseInt(o),c=g.drawY-o,d=g.drawX,u=parseInt(g.size_use),p=g.text,m=g.weight,style=g.style,f=g.strikeThrough?"text-decoration: line-through;"+`text-decoration-thickness: ${g.strikeThrough}px;`:"",i+='<div data-w="'+g.w_+'" style="position: absolute;width:100%;height:'+l+"px;top:"+c+"px;left:"+d+'px"><div style="height:'+l+"px;font-size: "+u+"px;letter-spacing:"+v+"px;line-height: "+u+"px;overflow: visible;white-space: nowrap;text-overflow: visible;color:"+g.color+";font-weight:"+m+";font-style:"+style+";"+f+"font-family:'"+g.family+"';\">"+T.htmlEncode(p)+'<div style="height: '+l+'px;display: inline-block;"></div></div></div>')}}s.isHtml&&(r.innerHTML=i,r.style.overflow="visible")}catch(t){T.reportExceptionError("text_layer_draw",t)}t.isHtml||t.ctx.restore(),y||(b.drawTime=-1)},this.calcPartsAndLinesWidthAndHeight=function(t){for(var e=0;e<t.length;e++){var i=t[e];i.w_=0;for(var s=i.h_=0;s<i.parts.length;s++){var a=i.parts[s],r=a.text;u(i)&&(r="‫"+r+"‬"),a.text=r,a.size_use=parseInt(a.size),a.font_=T.getCtxFont(a.style,a.weight,a.size_use,a.family),a.w_=T.measureText(a.text,a.family,a.size_use,a.weight,a.style,a.letterSpacing||0,s<i.parts.length-1),a.x_=a.x_shift,a.y_=a.y_shift,i.w_+=a.w_,a.size_use>i.h_&&(i.h_=a.size_use)}}},this.calcPartsDrawPositions=function(i,s){if(0!==i.length){let e=function(t,e,i=m.Top){var s;var a=b.getActualDrawingHeight(e),r=t-a,n=b.text.aeSrcTxt.isBoxText?.7*(null==(t=e[0])?void 0:t.h_):.7*b.text.aeSrcTxt.size;switch(i){case m.Top:return n;case m.Center:return Math.abs(r/2)+.7*(null==(s=e[0])?void 0:s.h_);case m.Bottom:return r+.7*(null==(s=e[0])?void 0:s.h_)}}(b.text.textBox.h,i,b.text.txtObj.verticalAlign);for(var a=0;a<i.length;a++){var r=i[a],n={l:"left",r:"right",c:"center",o:s.justif.toLowerCase()}[r.align];let t=0;for(var o=1,h=("center"===n?t=b.text.textBox.w/2-r.w_/2:"right"===n&&(t=b.text.textBox.w,o=-1),u(r)),l=!h&&"right"===n||h&&"right"!==n,c=0;c<r.parts.length;c++){var d=l?r.parts.length-1-c:c,d=r.parts[d];d.drawX="right"===n?t-d.w_+d.x_:t+d.x_,d.drawY=e+d.y_,t+=o*d.w_}a<i.length-1&&(h=i[a+1],e+=r.h_*r.lead*.3+h.h_*h.lead*.7)}}},this.resizeOverflowingLines=function(t){for(var e of t){var i,s;e.w_>b.text.textBox.w&&(i=b.getMinAllowedScale([e]),s=b.text.textBox.w/e.w_,s=Math.max(s,i),o(e,s))}},this.globalResizeForOverflow=function(t){var e=b.getMinAllowedScale(t),i=Math.max(e,Math.min(...t.map(t=>b.text.textBox.w/t.w_)));if(i<1)for(var s of t)o(s,i)},this.resizeOverflowingHeight=function(t){var{aeSrcTxt:e,textBox:i}=b.text,s=b.getActualDrawingHeight(t),a=b.getMinAllowedScale(t);let r;if(r=e.isBoxText?i.h/s:(i.h-.7*e.size)/(s-.7*(null==(i=t[0])?void 0:i.h_)),(r=Math.max(r,a))<1)for(var n of t)o(n,r)},this.applyAnimators=function(t,e){if(null!=e&&e.length)for(var{fillColor:i,opacity:s,position:a,rangeSelectors:r}of e)for(var{start:n,end:o,units:h,offset:l,basedOn:c,smoothness:d}of r){var u=function(t,e){switch(e){case p.Char:return t.reduce((t,e)=>t+e.parts.flatMap(t=>t.text.split("")).length,0);case p.CharWithoutSpace:return t.reduce((t,e)=>t+e.parts.flatMap(t=>t.text.match(/\s*[^\s]\s*/g)).length,0);case p.Word:return t.reduce((t,e)=>t+e.parts.flatMap(t=>t.text.match(/\s*[^\s]+\s*/g)).length,0);case p.Line:return t.length}}(t,c);u=u,h=h,l=l,n=n,o=o,d=d/100,h===x.Percent&&(n=u*n/100,o=u*o/100,l=u*l/100),n+=l,o+=l,h=[],1<=Math.floor(n)&&h.push({offset:Math.floor(n),effect:0}),0<d&&1-d<n%1&&(u=1-(n%1-(1-d))/d,h.push({offset:Math.max(0,Math.floor(n)+1),effect:u})),Math.floor(o)>Math.floor(n)&&h.push({offset:Math.max(0,Math.floor(o)),effect:1}),0<d&&1-d<o%1&&(l=(o%1-(1-d))/d,h.push({offset:Math.max(0,Math.floor(o)+1),effect:l})),!function(t,s,a,r){t.forEach(({part:e,effect:i})=>{if(e.text){e.color||(e.color="#000000");let t=e.color.startsWith("rgba")?e.color.replace(/rgba\((.+)\)/,"$1").split(",").map(t=>+t):nt(e.color);(t=s?t.map((t,e)=>Math.round(t+(s[e]-t)*i)):t).push(1),void 0!==a&&(t[3]*=1-(1-a/100)*i),e.color=z(t),r&&(e.x_shift+=r[0]*i,e.y_shift+=r[1]*i)}})}(function(o,h,t){let l=0,c=0,d=[];function e(e){for(var i of o)for(let t=0;t<i.parts.length;t++){var s=i.parts[t],a=h[c];if(!a)break;var r=s.text.match(e),n=(null==r?void 0:r.length)||0;l+n<=a.offset?(a.effect&&d.push({part:s,effect:a.effect}),l+n===a.offset&&c++,l+=n):(i.parts.splice(t+1,0,Object.assign(Object.assign({},s),{text:r.slice(a.offset-l).join("")})),s.text=r.slice(0,a.offset-l).join(""),a.effect&&d.push({part:s,effect:a.effect}),l+=a.offset-l,c++)}}switch(t){case p.Char:e(/./gs);break;case p.CharWithoutSpace:e(/\s*[^\s]\s*/gs);break;case p.Word:e(/\s*[^\s]+\s*/gs);break;case p.Line:l=1;for(let t=0;t<o.length;t++){let e=h[c];var i=o[t];if(!e)break;e.effect&&d.push(...i.parts.map(t=>({part:t,effect:e.effect}))),l===e.offset&&c++,l++}}return d}(t,h,c),i,s,a)}},this.removeTrailingSpaces=function(t){for(var e of t){var i=e.parts.length;0<i&&((e=e.parts[i-1]).text=e.text.replace(/\s+$/,""))}},this.getMinAllowedScale=function(t){var e=b.text["txtObj"];return(e.minFontSize||5)/t.reduce((t,{parts:e})=>e.reduce((t,{size:e})=>Math.min(t,e),t),1/0)},this.wrapLinesToDrawAndScaleDownFontSizeToFitBox=function(t,a,h){if(!t.text||!a)return[];let r=t["text"];var n=r["aeSrcTxt"];let u=1,p=[];for(var m=b.getMinAllowedScale(a);u>=m;){let e=0;var f,g=function(t){let n=[];for(let e of t){let a=t.findIndex(t=>t===e),r=(n[a]=Object.assign(Object.assign({},e),{parts:[]}),[]);for(let s of e.parts){let i=s.text.split(/\s/g);i.forEach((t,e)=>{e<i.length-1?(r.push(Object.assign(Object.assign({},s),{text:i[e]+" "})),n[a].parts.push(r),r=[]):i[e]&&(r.push(Object.assign(Object.assign({},s),{text:i[e]})),M.test(i[e]))&&(n[a].parts.push(r),r=[])})}r.length&&n[a].parts.push(r)}return n}(a);let i=0,s=!(p=[]),d=t.text.textBox.w;for(h.HScaleUse98&&(d*=.98);f=g.shift();){let o=0,t=0;for(let c=0;c<f.parts.length;c++){let r=0,l=0,n=0;for(let{size:t,text:e,weight:i,style,letterSpacing:s=0,family:a}of f.parts[c]){var v=t*u,y=(o=Math.max(v,o),l+=T.measureText(e,a,v,i,style,s),h.HScaleUse98?e:e.replace(/\s+$/,""));r+=T.measureText(y,a,v,i,style,s),n=s*t/1e3}if(t+r>d){if(0===t){if(u<=m||M.test(f.parts[c][0].text)){var x=f.parts[c];let o=0,h=!1;for(let n=x.length-1;0<=n;n--){let{text:e,size:i,family:s,style,weight:a,letterSpacing:r}=x[n];for(let t=e.length-1;0<t;t--){var w=T.measureText(e.substring(t),s,i*u,a,style,r);if(l-o-w<=d){p.push(Object.assign(Object.assign({},f),{parts:[...f.parts[c].slice(0,n),Object.assign(Object.assign({},f.parts[c][n]),{text:e.substring(0,t)})]})),g.unshift(Object.assign(Object.assign({},f),{parts:[[Object.assign(Object.assign({},f.parts[c][n]),{text:e.substring(t)}),...f.parts[c].slice(n+1)],...f.parts.slice(c+1)]})),h=!0;break}}if(h)break;o+=T.measureText(e,s,i*u,a,style,r)}break}s=!0;break}var _=f.parts[c-1],_=_[_.length-1];_.text=_.text.replace(/\s+/g,""),p.push(Object.assign(Object.assign({},f),{parts:f.parts.slice(0,c).flat()})),g.unshift(Object.assign(Object.assign({},f),{parts:f.parts.slice(c)}));break}t+=l+n,c>=f.parts.length-1&&p.push(Object.assign(Object.assign({},f),{parts:f.parts.flat()}))}if(s)break;e?e+=i*p[p.length-1].lead*.3+o*f.lead*.7:e+=.7*(n.isBoxText?o:n.size),i=o}if(!s&&(h.noVerticalScaleDownToFitHeight||e<=r.textBox.h))break;if(s=!1,u===m)break;u=Math.max(u-.05,m)}return this.combineSimilarParts(p),p.forEach(t=>t.parts.forEach(t=>{t.size*=u,t.x_shift*=u,t.y_shift*=u})),p},this.combineSimilarParts=function(t){var e,s=["color","size","style","weight","x_shift","y_shift","letterSpacing","strikeThrough","family"];for(e of t){var a=[];for(let i of e.parts){let e=a[a.length-1];e&&s.every(t=>i[t]===e[t])?e.text+=i.text:a.push(i)}e.parts=a}return t},this.getActualDrawingHeight=function(r){return r.reduce((t,{h_:e,lead:i},s)=>{var a;return 0===s?.7*(null==(a=r[0])?void 0:a.h_):t+e*i*.7+r[s-1].h_*r[s-1].lead*.3},0)},this.trimOverflowedHeight=function(a){if(a.length){var{aeSrcTxt:t,textBox:r}=b.text;if(r.w<=0||r.h<=0)a.length=0;else{var n=t.isBoxText?r.h:r.h-.7*t.size+.7*(null==(t=a[0])?void 0:t.h_);if(!(b.getActualDrawingHeight(a)-n<.1)){for(;a.pop(),b.getActualDrawingHeight(a)>n;);var o=a[a.length-1];let t=o.parts[o.parts.length-1],e=o.w_;var h="...";let i=T.measureText(h,t.family,t.size_use,t.weight,t.style,t.letterSpacing||0);for(;e-t.w_+i>r.w;)e-=t.w_,o.parts.pop(),t=o.parts[o.parts.length-1],i=T.measureText(h,t.family,t.size_use,t.weight,t.style,t.letterSpacing||0);let s;for(;(s=T.measureText(t.text+h,t.family,t.size_use,t.weight,t.style,t.letterSpacing||0))>r.w;)t.text=t.text.substring(0,t.text.length-1);t.text+=h,t.w_=s}}}},this.scaleDownFontSizeToFitBoxNoWrap=function(t,e){var i=b.text.txtObj["globalScale"];if(e.noVerticalScaleDownToFitHeight||b.resizeOverflowingHeight(t),i?b.globalResizeForOverflow(t):b.resizeOverflowingLines(t),e.legacyYCorrectionComplexTextBoxTxt&&0<t.length&&b.isHtml){let e=Math.max(...t.map(t=>t.h_))-t[0].h_;t.forEach(t=>{t.parts.forEach(t=>{t.y_+=e})})}},this.updateLinesToDraw=function(){var t=this,{aeSrcTxt:e,animators:i,txtObj:s}=t.text,{allCaps:a,wrapText:r,lines:n,features:o}=s;a&&n.forEach(t=>{t.parts.forEach(t=>{t.text=t.text.toUpperCase()})});let h;r?(h=t.wrapLinesToDrawAndScaleDownFontSizeToFitBox(t,n,o),t.removeTrailingSpaces(h),t.applyAnimators(h,i),this.combineSimilarParts(h),t.calcPartsAndLinesWidthAndHeight(h,e)):(h=JSON.parse(JSON.stringify(n)),t.removeTrailingSpaces(h),t.applyAnimators(h,i),this.combineSimilarParts(h),t.calcPartsAndLinesWidthAndHeight(h,e),t.scaleDownFontSizeToFitBoxNoWrap(h,o)),s.features.noTrimOverflowedHeight||t.trimOverflowedHeight(h),t.calcPartsDrawPositions(h,e),t.text.linesToDraw=h},this.updateLayerBoundaries=function(){var t,e=this,i=e.text["textBox"];e.updateLinesToDraw(),e.w=i.w,e.h=i.h,e.x=e.w/2+i.x,e.y=-e.h/2-i.y;let s=0,a=0,r=i.w,n=i.h;for(t of e.text.linesToDraw)for(var o of t.parts){var h=o.drawX,l=o.drawX+o.w_,c=o.drawY-+o.size_use,o=o.drawY+.5*o.size_use;h<s&&(s=h),l>r&&(r=l),c<a&&(a=c),o>n&&(n=o)}e.wx=2*Math.max(-s,r-e.w),e.hx=2*Math.max(-a,n-e.h),e.ctx_y_from_center=-e.h/2,e.ctx_x_from_center=-e.w/2}}function nt(t){t=t.match(/[\da-fA-F]{2}/g).map(t=>parseInt(t,16));return 3<t.length&&(t[3]/=255),t}function ot(){("Shape"===this.originalType?st:d).call(this),this.script=document.createElement("script"),this.script.setAttribute("data-args",JSON.stringify(this.widget.args)),this.script.src=this.widget.scriptUrl,this.loadFonts=function(){var t=Object.values(this.widget.args).filter(t=>"Font"===(null==t?void 0:t.type));T.loadFonts(t)},this.loadFonts();var t,e=!1;this.drawContent=function(){e=!0,this.subElm.style.webkitFontSmoothing="antialiased",this.subElm.innerHTML||this.subElm.appendChild(this.script)},this.isLoaded=function(){return!0},this.contentNeedRedraw=function(){return!e},this.removeFromScene=function(){this.subElm.style.display="none"};let i=this.addToScene.bind(this),s=(this.addToScene=function(){i(),this.subElm.style.display="block"},null==(t=this.updateLayerBoundaries)?void 0:t.bind(this));this.updateLayerBoundaries=function(){var t=this;switch(t.originalType){case"Text":var e=t.text["textBox"];t.w=e.w,t.h=e.h,t.x=t.w/2+e.x,t.y=-t.h/2-e.y;break;case"Image":t.w=t.image.w,t.h=t.image.h,t.x=t.w/2,t.y=-t.h/2;break;case"Video":t.w=t.video.w,t.h=t.video.h,t.x=t.w/2,t.y=-t.h/2;break;case"Shape":s(),t.w-=20,t.h-=20;break;case"Precomp":var{w:e,h:i}=this.precomp.comp||{};t.w=e,t.h=i,t.x=e/2,t.y=-i/2}}}function ht(t,i){lt.call(this);var s=this;this.applyCameraTransform=function(){var t=this.camera;t.position.set(this.cameraObj.p[0],-this.cameraObj.p[1],-this.cameraObj.p[2]),this.cameraObj.t?(t.lookAt(new THREE.Vector3(this.cameraObj.an[0],-this.cameraObj.an[1],-this.cameraObj.an[2])),this.cameraObj.o&&(0!==this.cameraObj.o[0]&&t.rotateX(this.ox),0!==this.cameraObj.o[1]&&t.rotateY(-this.oy),0!==this.cameraObj.o[2])&&t.rotateZ(-this.oz)):this.cameraObj.o&&t.rotation.set(this.cameraObj.o[0],-this.cameraObj.o[1],-this.cameraObj.o[2]),0!==this.cameraObj.rx&&t.rotateX(this.cameraObj.rx),0!==this.cameraObj.ry&&t.rotateY(-this.cameraObj.ry),0!==this.cameraObj.rz&&t.rotateZ(-this.cameraObj.rz)},this.update=function(t,e){for(var i=0;i<this.children.length;i++)this.children[i].update(t,e);this.cameraObj.isPropertiesUpdated()&&this.applyCameraTransform(),this.lastTime=t},this.draw=function(t,e){for(var i=0;i<this.children.length;i++)this.children[i].draw(t)},this.play=function(t){for(var e=0;e<this.l.length;e++)"Video"!==this.l[e].ty&&"Audio"!==this.l[e].ty||this.l[e].play(t)},this.setRate=function(t){for(var e=0;e<this.l.length;e++)"Video"!==this.l[e].ty&&"Audio"!==this.l[e].ty||this.l[e].setRate(t)},this.pause=function(t,e){for(var i=0;i<this.l.length;i++)"Video"!==this.l[i].ty&&"Audio"!==this.l[i].ty||this.l[i].pause(t,e)},this.stop=function(){for(var t=0;t<this.l.length;t++)this.l[t].stop();this.lastTime=-999999},this.goTo=function(t,e){if(s.stop(),s.drawFrame(t,e),e)for(var i=0;i<this.l.length;i++)"Video"!==this.l[i].ty&&"Audio"!==this.l[i].ty||this.l[i].pause(t)},this.mute=function(t){for(var e=0;e<this.l.length;e++)this.l[e].mute!==i&&this.l[e].mute(t)},this.vol=function(t){for(var e=0;e<this.l.length;e++)this.l[e].vol!==i&&this.l[e].vol(t)},this.loadAllFootages=function(){for(var t of s.l)t.loadFootage&&0<t.start&&t.loadFootage()},this.loadInitialFootages=function(){for(var t of s.l)t.loadFootage&&t.start<=0&&t.loadFootage()},this.getFootageStatus=function(t){try{for(var e=[],i=0;i<this.l.length;i++){var s=this.l[i];if(!(t&&0<s.start)&&!s.isLoaded(t))switch(s.ty){case"Image":e.push(s.image.url);break;case"Text":e.push("font: "+s.text.aeSrcTxt.fontFamily+" "+s.text.aeSrcTxt.weight);break;case"Precomp":e.push(...s.precomp.comp.getFootageStatus().pending);break;case"Video":e.push(s.video.url);break;case"Audio":e.push(s.audio.url)}}return{pending:e,failed:[]}}catch(t){return T.reportExceptionError("getFootageStatus",t),{pending:[],failed:[]}}},this.getCameraLayerAtTime=function(t){for(var e=0;e<this.l.length;e++)if("Camera"===this.l[e].ty&&this.l[e].s>=t&&this.l[e].s<=t)return this.l[e];return 0},this.footage={},comp.l=comp.l.filter(t=>{function s(t){return!t.en&&!t.is_tm}return s(t)&&(t.ty="Null"),!function t(e){return s(e)&&(i=e.i,comp.l.filter(t=>+t.pi===i).every(t));var i}(t)}).sort((t,e)=>t.is_tm?-1:e.is_tm?1:+e.i-t.i);for(var e=0;e<s.l.length;e++)switch((s.l[e].comp=s).l[e].ty){case"Null":et.call(s.l[e]);break;case"Image":G.call(s.l[e]);break;case"Text":rt.call(s.l[e]);break;case"Shape":st.call(s.l[e]);break;case"Precomp":it.call(s.l[e],ht);break;case"Video":Q.call(s.l[e]);break;case"Audio":J.call(s.l[e]);break;case"HTMLWidget":K.call(s.l[e]);break;case"Widget":ot.call(s.l[e])}this.children=[];for(var a=0;a<this.l.length;a++)if(this.l[a].pi===i)this.children.push(this.l[a]),this.l[a].parent=null;else for(e=0;e<this.l.length;e++)if(this.l[e].i==this.l[a].pi){this.l[a].parent=this.l[e],this.l[e].children.push(this.l[a]);break}for(e=0;e<this.l.length;e++)this.l[e].sceneStart=this.l[e].getEaliestStart(),this.l[e].sceneEnd=this.l[e].getLatestEnd();this.clickableLayers_=[];for(e=0;e<this.l.length;e++)this.l[e].clk&&this.clickableLayers_.push(this.l[e]);this.scene=new THREE.Scene,this.renderer=new THREE.CSS3DRenderer({w:this.w,h:this.h}),this.renderer.domElement.style.cssText="position:absolute;z-index:0;top:0px;left:0px;overflow:hidden;opacity:1;background-color:transparent";var r=((1<<24)+(parseInt(255*this.bgC[0])<<16)+(parseInt(255*this.bgC[1])<<8)+parseInt(255*this.bgC[2])).toString(16).slice(1),r=(this.bgA=this.bgA||1,this.isPrecomp||adParams.custom.isVpaid||this.renderer.setClearColor(r,this.bgA),this.cameraObj=this.getCameraLayerAtTime(0)||new ct(this),2*Math.atan(this.h/(2*this.cameraObj.zo))*(180/Math.PI)),n=this.w/this.h;this.camera=new THREE.PerspectiveCamera(r,n,1e4),this.camera.near=.1*this.cameraObj.zo,this.camera.far=4*this.cameraObj.zo,this.camera.updateProjectionMatrix(),this.screenObj=new THREE.Object3D,this.camera.add(this.screenObj),this.screenObj.position={x:.5*-this.w,y:.5*this.h,z:-this.cameraObj.zo},this.scene.add(this.camera),this.drawFrame=function(t,e){try{this.update(t,e),this.renderer.render(this.scene,this.camera),this.draw(t)}catch(t){T.reportExceptionError("drawFrame",{adParams:JSON.stringify(adParams),stage:"",exception:JSON.stringify(t)})}}.bind(this),this.parentPlayer=t,this.lastTime=-999999}function lt(){var t,n=[],o=[],e=!1;for(t in this)if(this[t]instanceof Array)for(var i=this[t],s=0;s<i.length;s++)"object"==typeof i[s]&&lt.call(i[s])&&o.push(i[s]);else if("object"==typeof this[t]){var a,r=this[t];if(null!=r)if(r.k&&r.k instanceof Array)e=!0,r="path"==t?D.ShapePropertyFactory.getShapeProp(r):D.PropertyFactory.getProp(r),n.push({key:t,data:r});else if(r.val&&r.val instanceof Array){if(r.mult&&1!=r.mult)for(s=0;s<r.val.length;s++)r.val[s]*=r.mult;1===r.val.length&&(r.val=r.val[0]),this[t]=r.val}else"path"==t&&r.val?(a=this[t].c,this[t]=r.val,this[t].c=a):lt.call(r)&&o.push(r)}if(this.isPropertyUpdated_=!1,this.isPropertiesUpdated=()=>!1,e||0<o.length){for(var h of n)this[h.key]=h.data.getValueAtTime(0);return this.isPropertiesUpdated=()=>this.isPropertyUpdated_||o.some(t=>t.isPropertiesUpdated()),this.updateProperties=function(t){let e=!1;for(var i=0;i<n.length;i++){var s=n[i].key,a=JSON.parse(JSON.stringify(this[s])),r=n[i].data.getValueAtTime(t);e=e||!T.deepEqual(a,r),this[s]=r}this.isPropertyUpdated_=e;for(i=0;i<o.length;i++)o[i].updateProperties(t)}.bind(this),!0}return!1}function ct(t){this.zo=1.38888*t.w,this.p=[t.w/2,t.h/2,-this.zo],this.an=[t.w/2,t.h/2,0],this.o=[0,0,0],this.rx=0,this.ry=0,this.rz=0,this.isDefaultCam=!0;var e=this.t=!1;this.isPropertiesUpdated=function(){return!e&&(e=!0)}}let B={COMP:ht},dt={default:"Default","items[0].clickUrl":"Item_1","items[1].clickUrl":"Item_2","items[2].clickUrl":"Item_3","items[3].clickUrl":"Item_4","items[4].clickUrl":"Item_5","items[5].clickUrl":"Item_6","items[6].clickUrl":"Item_7","items[7].clickUrl":"Item_8"};class ut extends PlayerBase{init(t,e,i,s){this.comp=t.comps[0],this.movie=t,window.comp=this.comp,this.B=B,this.mergeMapping(),this.refactorTextData(),super.init(this.comp,e,i,s),this.scheduleSubLoad()}scheduleSubLoad(){comp.loadInitialFootages(),!0!==this.isVpaid&&adParams.subLoadDelay?-1===adParams.subLoadDelay?FB.sendMsgToHost("getLoadStatus"):setTimeout(()=>{this.initSubLoad()},1e3*adParams.subLoadDelay):this.initSubLoad()}initSubLoad(){this.fire("sub_load_initiated"),comp.loadAllFootages()}mergeMapping(){var g;if("undefined"!=typeof mapping){this.isPlatformMapped="true"===adParams.custom.isPlatformMapped;let t=mapping.dynamicMapping;for(let{compId:m,layerId:f,dynamicDataObj:s}of t)try{let{conditions:e,colorOverlay:a,clickUrl:r,widget:n,alt:o,fillColor:h,isValid:t,resizeOption:l,strokeColor:c,txtData:d,url:u,html:p,mappingId:i}=s;if(t){let s,t=null==(g=this.movie.comps.find(({id:t})=>+t==+m))?void 0:g.l;if(s=this.isPlatformMapped?null===t||void 0===t?void 0:t.find(t=>t.mappingId===i):null===t||void 0===t?void 0:t.find(({i:t})=>+t==+f),s)if(this.isPassConditions(e)){s.i=+s.i;let{ty:t,eff:e}=s;switch(t){case"Shape":s.shape.shapes.forEach(t=>{h&&t.fill&&this.eval(h)&&(t.fill.o.c.val=this.hexToRgb(this.eval(h)),t.fill.t=w.Solid),c&&t.stroke&&this.eval(c)&&(t.stroke.o.c.val=this.hexToRgb(this.eval(c)),t.stroke.t=w.Solid)});break;case"Image":o&&(s.image.alt=this.eval(o)),u&&(s.image.url=this.eval(u)),l&&(s.image.ro=l);break;case"Video":u&&(s.video.url=this.eval(u));break;case"Text":d&&(s.text.txtData=Object.assign(Object.assign(Object.assign({},s.text.txtData),d),{parts:d.parts.map(t=>Object.assign(Object.assign({},t),{val:t.isStatic?t.val:this.evalText(t.val)}))})),h&&this.eval(h)&&(s.text.aeSrcTxt.fColArr=this.hexToRgb(this.eval(h)).map(t=>t/255)),c&&this.eval(c)&&(s.text.aeSrcTxt.sColArr=this.hexToRgb(this.eval(c)).map(t=>t/255));break;case"Precomp":p&&(s.html=this.eval(p),s.ty="HTMLWidget")}if(r&&(s.clk="default"!==r&&this.eval(r)||"default",this.isPlatformMapped?s.clkType=style[r.paramKey].includes("items")?"Item_"+(r.index+1):"Custom":s.clkType=dt[r]||"Custom"),n&&!s.tm&&!["Null","Audio"].includes(t)){let t=style[n.paramKey];for(var[v,{value:y,isDynamic:x}]of Object.entries(t.args))t.args[v]=x?eval(style[y])(n.index):y;s.widget=t,s.originalType=s.ty,s.ty="Widget"}let i=e.find(t=>"colOver"===t.ty);i&&a&&(i.c=this.hexToRgb(this.eval(a)))}else this.removeLayerWithChildren(+s.i,m)}}catch(t){FB.reportError(`Failed to map layer ${f}. (comp ${m})`,t)}}}hexToRgb(t){return t.substring(1).match(/.{2}/g).map(t=>parseInt(t,16))}rgbToHex(t){return"#"+t.map(t=>Math.round(255*+t).toString(16).padStart(2,"0")).join("")}removeLayerWithChildren(e,i){var t,s,a,r=movie.comps.find(t=>t.id===i);r.l=r.l.filter(t=>+t.i!=+e);for({i:t,pi:s,has_tm:a}of r.l)s!==e&&a!==e||this.removeLayerWithChildren(t,i)}eval(i){if(this.isPlatformMapped){let{paramKey:t,index:e}=i;return eval(style[t])(e)}return eval(i)}evalText(t){let i=t.index||0,s=this.eval(t)||"",e=t=>{s.startsWith("JSON3=")&&(t=JSON.parse(`"${t}"`));let e=eval(t.replace(/\u241E/g,""))(i);return s.startsWith("JSON3=")&&(e=JSON.stringify(e).replace(/(^")|("$)/g,"")),e};return s.replace(/\u241E.+?\u241E/gs,e)}isPassConditions(t){return null!=t&&t.length?this.isPlatformMapped?t.every(({index:t,value:e,paramKey:i})=>e?i?eval(style[i])()===e:eval(e)(t):!0):eval(t.join(" && ")):!0}getFontFamily(t){var e=t.replace(/^(.+)-.*$/,"$1");return["arial","times","times new roman"].includes(e.toLowerCase())?e.toLowerCase():t}refactorTextData(){var t,c=/\r\n|\n|\r|\u0003|\$€\$/;for(t of this.movie.comps)for(var e of t.l)if("Text"===e.ty||"Text"===e.originalType){let o=e.text.aeSrcTxt;var{parts:d,textVerticalAlign:u=o.verticalAlign||0,minFontSize:p=5,strikeWidth:i=0}=e.text.txtData||{};let h=(o.lead||1.2*o.size)/o.size;var m=[{url:"",family:o.fontFamily,weight:o.weight,italic:o.italic}];let l={color:this.rgbToHex(o.fColArr),size:o.size,sizeUnits:"px",style:o.italic?"italic":"normal",text:"",weight:o.weight,x_shift:0,y_shift:o.blShift,letterSpacing:o.trk||0,strikeThrough:i,strokeWidth:o.sColArr?o.sWidth:0,strokeColor:o.sColArr?this.rgbToHex(o.sColArr):null,strokeOverFill:o.sOverF,family:o.fontFamily};if(null!=d&&d.length)if(null!=(i=d[0].val)&&i.startsWith("JSON3=")){let a=JSON.parse(d[0].val.substring(6)),r=(void 0===(a=Array.isArray(a)?{allCaps:!1,wrapText:!1,globalScale:!1,verticalAlign:0,minFontSize:p,lines:a}:a).verticalAlign&&(a.verticalAlign=0),a.source="complexText",[]),n=null;a.lines.forEach(s=>{s.lead||(s.lead=1),n=Object.assign(Object.assign({},s),{parts:[]}),s.parts.forEach(e=>{"original"===e.weight&&(e.weight=o.weight),"original"===e.style&&(e.style=!0===o.italic?"italic":"normal"),"rel_px"===e.sizeUnits&&(e.size=o.size+e.size),void 0===e.letterSpacing&&(e.letterSpacing=a.letterSpacing||0),e.family||(e.family=o.fontFamily);var[t,...i]=e.text.split("\n");n.parts.push(Object.assign(Object.assign({},e),{text:t})),i.forEach(t=>{r.push(n),n=Object.assign(Object.assign({},s),{parts:[Object.assign(Object.assign({},e),{text:t})]})})}),r.push(n)}),a.fonts||(a.fonts=m),e.text.txtObj=Object.assign(Object.assign({},a),{lines:r})}else{let i=d.some(({blShift:t})=>0!==t),s=o.justif.toLowerCase()[0],a=t=>{var e;return Object.assign(Object.assign({},l),{size:null!=(e=t.size)?e:o.size,text:t.val,y_shift:i?-t.blShift:o.blShift})},r=[],n={align:s,lead:h,parts:[]};for(let e of d){var[f,...g]=e.val.split(c);n.parts.push(a(Object.assign(Object.assign({},e),{val:f}))),g.forEach(t=>{r.push(n),(n={align:s,lead:h,parts:[]}).parts.push(a(Object.assign(Object.assign({},e),{val:t})))})}r.push(n),e.text.txtObj={allCaps:12<=adParams.format.ver&&o.allCaps,wrapText:!0,globalScale:!0,verticalAlign:u,minFontSize:p,lines:r,fonts:m}}else o.txtObj?e.text.txtObj=o.txtObj:e.text.txtObj={allCaps:12<=adParams.format.ver&&o.allCaps,wrapText:!0,globalScale:!0,verticalAlign:u,minFontSize:p,fonts:m,lines:o.txt.split(c).map(t=>({align:o.justif.toLowerCase()[0],lead:h,parts:[Object.assign(Object.assign({},l),{text:t})]}))};e.text.txtObj.fonts||(e.text.txtObj.fonts=m),e.text.txtObj.fonts.forEach(t=>t.family=this.getFontFamily(t.family)),e.text.txtObj.lines.forEach(t=>t.parts.forEach(t=>t.family=this.getFontFamily(t.family))),e.text.txtObj.ver||(e.text.txtObj.ver=0);i={};if(0===e.text.txtObj.ver&&adParams.format.ver<14&&("complexText"===e.text.txtObj.source&&(i.noVerticalScaleDownToFitHeight=!0,o.boxTxtS)&&(i.legacyYCorrectionComplexTextBoxTxt=!0),i.noTrimOverflowedHeight=!0,i.HScaleUse98=!0),e.text.txtObj.features=i,o.boxTxtS)e.text.textBox={x:o.boxTxtP.x,y:o.boxTxtP.y,w:o.boxTxtS.w,h:o.boxTxtS.h};else{var s={x:0,y:.7*-o.size,w:e.text.pointTextWidth,h:.7*o.size+(o.txt.split(c).length-1)*(h*o.size)};switch(o.justif.toLowerCase()){case"left":s.x=0;break;case"right":s.x=-s.w;break;default:s.x=-s.w/2}e.text.textBox=s}}}}function f(t,e,i,s){if("a"===i&&!s)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t===e&&s:e.has(t))return"m"===i?s:"a"===i?s.call(t):s?s.value:e.get(t);throw new TypeError("Cannot read private member from an object whose class did not declare it")}function g(t,e,i,s,a){if("m"===s)throw new TypeError("Private method is not writable");if("a"===s&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t===e&&a:e.has(t))return"a"===s?a.call(t,i):a?a.value=i:e.set(t,i),i;throw new TypeError("Cannot write private member to an object whose class did not declare it")}window.clinchPlayer=ut,window.ClinchViewability=function(){this._id=null,this._options={rootMargin:"0px",threshold:[.5]},this._observer,this._undetermined=!1,this._previousIntersectionRatio=null,this._isInView=null,this._inViewDefinition=.5,this._events={},this._viewableImpression={startTime:void 0,timeoutHandler:void 0,fired:!1,minDuration:void 0},this._unsubscribeHandlers=[];function i(){this._viewableImpression.startTime=(new Date).getTime(),this._viewableImpression.timeoutHandler=setTimeout(function(){this._viewableImpression.fired=!0,a.call(this,s["viewable.impression"],{})}.bind(this),this._viewableImpression.minDuration)}this.init=function(t,e){this._id=t,this._viewableImpression.minDuration=e;try{this._observer=new IntersectionObserver(function(t,e){this._previousIntersectionRatio?this._previousIntersectionRatio>t[0].intersectionRatio?(this._viewableImpression.startTime=void 0,clearTimeout(this._viewableImpression.timeoutHandler),this._viewableImpression.timeoutHandler=void 0,a.call(this,s["container.hidden"],{ratio:t[0].intersectionRatio})):(this._viewableImpression.fired||i.call(this),a.call(this,s["container.shown"],{ratio:t[0].intersectionRatio})):(this._isInView=t[0].intersectionRatio>=this._inViewDefinition,this._isInView&&!this._viewableImpression.fired&&(i.call(this),a.call(this,s["container.shown"],{ratio:t[0].intersectionRatio}))),this._previousIntersectionRatio=t[0].intersectionRatio}.bind(this),this._options)}catch(t){return void(this._undetermined=!0)}this._observer.observe(cp_.containerDiv.ownerDocument.querySelector("#"+this._id))},this.listen=function(t,e){var i;this._undetermined||(this._events[t]||(this._events[t]=[]),this._events[t].push(e),i=function(){this._events[t]=this._events[t].filter(function(t){return e!==t})}.bind(this),this._unsubscribeHandlers.push(i))},this.unsubscribeAll=function(){for(var t=0;t<this._unsubscribeHandlers.length;t++)this._unsubscribeHandlers[t]()},this.stopObserving=function(){this._observer.unobserve(document.querySelector("#"+this._id))};var s={"container.shown":"container.shown","container.hidden":"container.hidden","viewable.impression":"viewable.impression"},a=function(t,e){t=this._events[t];t&&t.forEach(function(t){t.call(null,e)})}},window.clinchSdk={multiLineSeperatorsStrs:["$€$","\r","\n","<br>","<br />","<br/>"],multiLineReplaces:["$€$","\r\n","\n\r","\r","\n","<br/>","<br />"],getAdStatus:function(){return cp_.getStatus()},pause:function(){cp_.Pause()},play:function(){cp_.Play()},mute:function(){cp_.Mute(!0)},unmute:function(){cp_.Mute(!1)},setVolume:function(t){cp_.Volume(t)},addEventListener:function(t,e){cp_.addListener(t,e)},removeEventListener:function(t,e){cp_.removeListener(t,e)},click:function(params){var t=params.type||"",e=params.tags||"",i=params.clickPixels||[];let s=null;adParams.InAdclk&&(a=adParams.InAdclk.trkPerLabel[t||"main"])&&a.lp&&(s=a.lp);var a=params.url||s||adParams.clickUrl||adParams.fbClickUrl,params={x:params.x||0,y:params.y||0},a=T.genClkChain(a);T.reportClick(a,t,e,i,params),T.isMraid()?T.sendMsgToHost("open,"+a):window.open(a,"_blank")},engage:function(params){var t={x:params.x||0,y:params.y||0};T.reportEngage(params.type,params.tags,params.clickPixels,t)},getAdContainer:function(){var t;return null==(t=null==(t=null===cp_||void 0===cp_?void 0:cp_.comp)?void 0:t.renderer)?void 0:t.domElement},getExtAdContainer:function(){return cp_.containerDiv},getAdFonts:function(){return[]},getDynImgUrl:function(t,e,i,s,a){return T.getDynImgUrl(t,e,i,s,a)},resizeFontToFitWidth:function(t){try{var e=document.getElementsByClassName(t);if(0!==e.length){var i=document.createElement("canvas").getContext("2d");i.save();for(let t=0;t<e.length;t++){var s=e[t],a=s.children;if(0<a.length){let e=0;for(let t=0;t<a.length;t++){var r,n,o,h,l,c=a[t].innerText;c&&(r=window.getComputedStyle(a[t]))&&(l=r.getPropertyValue("font-size")||"20px",n=r.getPropertyValue("font-weight")||400,o=r.getPropertyValue("font-style")||"normal",h=r.getPropertyValue("font-family")||"",l=parseInt(l),i.font=T.getCtxFont(o,n,l,h),e+=i.measureText(c).width)}if(e){var d=window.getComputedStyle(s).getPropertyValue("width")||"",d=parseInt(d);if(e>.95*d)for(let t=0;t<a.length;t++){var u,p,m=window.getComputedStyle(a[t]),f=function(style){try{var t,e,i=style.transform||style.webkitTransform||style.mozTransform;return"none"===i?{x:0,y:0,z:0}:(t=i.includes("3d")?"3d":"2d",e=i.match(/matrix.*\((.+)\)/)[1].split(", "),"2d"==t?{x:e[4],y:e[5],z:0}:"3d"==t?{x:e[12],y:e[13],z:e[14]}:void 0)}catch(t){return{x:0,y:0,z:0}}}(m)||{x:0,y:0,z:0};m&&(u=.95*d/e,p=m.getPropertyValue("font-size")||"20px",p=parseInt(p),a[t].style.fontSize=p*u+"px",(f.x||f.y||f.z)&&(a[t].style.transform=""),f.x&&(a[t].style.transform+=" translateX("+f.x*u+"px)"),f.y)&&(a[t].style.transform+=" translateY("+f.y*u+"px)")}}}else{var g,v,y,x,w,_,b,M=s.innerText;M&&(g=window.getComputedStyle(s))&&(v=g.getPropertyValue("font-weight")||400,y=g.getPropertyValue("font-style")||"normal",x=g.getPropertyValue("font-size")||"20px",w=g.getPropertyValue("font-family")||"",_=g.getPropertyValue("width")||"")&&(_=parseInt(_),x=parseInt(x),i.font=T.getCtxFont(y,v,x,w),.95*_<(b=i.measureText(M).width))&&(s.style.fontSize=parseInt(x*(.95*_)/b)+"px")}}}}catch(t){}},resizeFontToFitWidthForMultiLine:function(t){try{var e=document.getElementsByClassName(t),o=document.createElement("canvas").getContext("2d");if(o.save(),0!==e.length)for(let t=0;t<e.length;t++){var h=e[t],i=window.getComputedStyle(h);if(i){let a,r,n;h.dataset.originTxt?(a=h.dataset.originTxt,r=parseInt(h.dataset.originFontSize),n=parseFloat(h.dataset.originLineHeight)):(a=h.innerHTML,r=i.getPropertyValue("font-size")||"20px",r=parseInt(r),n=i.getPropertyValue("line-height"),n=parseFloat(n)||r,h.dataset.originTxt=a,h.dataset.originFontSize=r,h.dataset.originLineHeight=n);var l=h.dataset.minFontSize||10,c=i.getPropertyValue("font-weight")||400,d=i.getPropertyValue("font-style")||"normal",u=i.getPropertyValue("font-family")||"",p=i.getPropertyValue("width")||"",m=h.dataset.maxHeight||i.getPropertyValue("height")||"";if(p&&m){p=parseInt(p),m=parseInt(m);let s=parseFloat(n/r),e=(s<1&&(s=1),!1);for(let t=0;t<clinchSdk.multiLineSeperatorsStrs.length;t++)if(-1<a.indexOf(clinchSdk.multiLineSeperatorsStrs[t])){e=!0;for(let t=0;t<clinchSdk.multiLineReplaces.length;t++)a=a.replace(new RegExp(clinchSdk.multiLineReplaces[t],"g"),"<br>");break}if(e){var f=a.split("<br>");if(f&&0<f.length){var g=f[0];let e=o.measureText(g).width;for(let t=1;t<f.length;t++){var v=f[t],y=o.measureText(v).width;y>e&&(e=y,0)}let t=1;e>.95*p&&(t=e/(.95*p));var x,w=n*f.length;.98*m<w&&(x=w/(.98*m))>t&&(t=x),h.innerHTML=f.join("<br>"),Math.floor(r/t)<l&&(t=r/l),h.style.fontSize=Math.floor(r/t)+"px",h.style.lineHeight=n/t+"px"}}else{let e={status:"ok",lines:[a]};var _=a;let i=r;r<=l&&T.log("ClinchSdk: resizeFontToFitWidthForMultiLine font size smaller than minimum font size."),m<r&&T.log("ClinchSdk: resizeFontToFitWidthForMultiLine div height is less then font size.");for(let t=r;t>=l;t--){var b=Math.floor(m/(t*s)),M=(i=t)===l;if(o.font=T.getCtxFont(d,c,t,u),"ok"===(e=clinchSdk.wrapText(o,_,p,b,!0,M)).status)break}h.innerHTML=e.lines.join("<br>"),h.style.fontSize=i+"px",h.style.lineHeight=n*(i/r)+"px"}}}}}catch(t){}}};class pt{constructor(){e.add(this),s.set(this,[]),i.set(this,null),a.set(this,null),r.set(this,null),n.set(this,!1),this.fireMouseEnter=this.fireMouseEnter.bind(this),this.fireMouseLeave=this.fireMouseLeave.bind(this),this.handleVisibilityChange=this.handleVisibilityChange.bind(this)}init(){window.addEventListener("load",()=>{var t=clinchSdk.getAdContainer();if(!(!1 in window)&&t)try{t.addEventListener("mouseenter",this.fireMouseEnter),t.addEventListener("mouseleave",this.fireMouseLeave),document.addEventListener("visibilitychange",this.handleVisibilityChange),g(this,r,new IntersectionObserver(t=>{var t=t[0]["intersectionRatio"],e=!!f(this,a,"f"),t=.5<=t;e&&!t&&this.fireOutOfView(),!e&&t&&this.fireInView()},{threshold:[.5]}),"f"),f(this,r,"f").observe(t),window.addEventListener("beforeunload",()=>{this.fireSummery()}),setTimeout(()=>this.fireSummery(),6e5)}catch(t){f(this,e,"m",o).call(this,{stype:"error",message:t.message})}})}fireInView(){g(this,a,(new Date).getTime(),"f"),f(this,e,"m",o).call(this,{stype:"in_view"})}fireOutOfView(){var t;f(this,a,"f")&&(t=((new Date).getTime()-f(this,a,"f"))/1e3,g(this,a,null,"f"),f(this,e,"m",o).call(this,{stype:"out_of_view",duration:t}))}fireMouseEnter(){g(this,i,(new Date).getTime(),"f"),f(this,e,"m",o).call(this,{stype:"hover_in"})}fireMouseLeave(){var t;f(this,i,"f")&&(t=((new Date).getTime()-f(this,i,"f"))/1e3,g(this,i,null,"f"),f(this,e,"m",o).call(this,{stype:"hover_out",duration:t}))}handleVisibilityChange(){document.hidden&&this.fireSummery()}fireSummery(){try{var t;f(this,n,"f")||(g(this,n,!0,"f"),(t=clinchSdk.getAdContainer()).removeEventListener("mouseenter",this.fireMouseEnter),t.removeEventListener("mouseleave",this.fireMouseLeave),document.removeEventListener("visibilitychange",this.handleVisibilityChange),f(this,r,"f").disconnect(),f(this,i,"f")&&this.fireMouseLeave(),f(this,a,"f")&&this.fireOutOfView(),f(this,e,"m",o).call(this,{stype:"aggregate",allevents:JSON.stringify(f(this,s,"f"))}))}catch(t){f(this,e,"m",o).call(this,{stype:"error",message:t.message})}}}s=new WeakMap,i=new WeakMap,a=new WeakMap,r=new WeakMap,n=new WeakMap,e=new WeakSet,o=function(t){var e,i,params=new URLSearchParams(FB.pxlDims);f(this,s,"f").push(t);for([e,i]of Object.entries(t))params.set(e,i);(new Image).src=FB.trkHost+"/att?"+params.toString()};let mt=new pt;"toJSON"in Error.prototype||Object.defineProperty(Error.prototype,"toJSON",{value:function(){let e={};return Object.getOwnPropertyNames(this).forEach(function(t){e[t]=this[t]},this),e},configurable:!0,writable:!0}),window.addEventListener("message",T.receiveMsg);try{Element.prototype.hasClass=function(t){return new RegExp(" "+t+" ").test(" "+this.className+" ")},Element.prototype.addClass=function(t){this.hasClass(t)||(this.className+=" "+t)},Element.prototype.removeClass=function(t){let e=" "+this.className.replace(/[\t\r\n]/g," ")+" ";if(this.hasClass(t)){for(;0<=e.indexOf(" "+t+" ");)e=e.replace(" "+t+" "," ");this.className=e.replace(/^\s+|\s+$/g,"")}},Element.prototype.remove=function(){null!=this.parentNode&&this.parentNode.removeChild(this)},Element.prototype.offset=function(){var t,e=this&&this.ownerDocument,i={top:0,left:0};if(e)return t=e.documentElement,null==this.parentNode?i:(i=this.getBoundingClientRect(),e=9===e.nodeType&&e.defaultView,{top:i.top+e.pageYOffset-t.clientTop,left:i.left+e.pageXOffset-t.clientLeft})}}catch(t){T.reportExceptionError("elements_proto_declare",t)}"true"===adParams.custom.attentionEvents&&mt.init();
